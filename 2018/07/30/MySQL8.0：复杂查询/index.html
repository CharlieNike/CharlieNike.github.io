<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">

  <!-- PACE Progress Bar START -->
  
    <script src="../../../../js/pace.min.js"></script>
    <link rel="stylesheet" href="https://github.com/HubSpot/pace/raw/master/themes/orange/pace-theme-flash.css">
  
  

  <!-- PACE Progress Bar START -->

  
  <title>mysql8.0：复杂查询 | 早行人</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="MySQL数据库" />
  
  
  
  
  <meta name="description" content="整理：房玉辉">
<meta name="keywords" content="MySQL数据库">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL8.0：复杂查询">
<meta property="og:url" content="http://yoursite.com/2018/07/30/MySQL8.0：复杂查询/index.html">
<meta property="og:site_name" content="早行人">
<meta property="og:description" content="整理：房玉辉">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://p83c9zj44.bkt.clouddn.com/mysql%E5%A4%9A%E8%A1%A8%E8%81%94%E6%9F%A5.jpeg">
<meta property="og:image" content="http://p83c9zj44.bkt.clouddn.com/mysqlMySQL%E5%B7%A6%E5%A4%96%E8%87%AA%E7%84%B6.jpeg">
<meta property="og:image" content="http://p83c9zj44.bkt.clouddn.com/mysqlmysql%E5%8F%B3%E5%A4%96%E8%BF%9E%E6%8E%A5.jpeg">
<meta property="og:image" content="http://p83c9zj44.bkt.clouddn.com/mysqlMySQL%E5%8F%B3%E5%A4%96%E8%87%AA%E7%84%B6.jpeg">
<meta property="og:updated_time" content="2018-09-17T03:02:07.304Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MySQL8.0：复杂查询">
<meta name="twitter:description" content="整理：房玉辉">
<meta name="twitter:image" content="http://p83c9zj44.bkt.clouddn.com/mysql%E5%A4%9A%E8%A1%A8%E8%81%94%E6%9F%A5.jpeg">
  
    <link rel="alternate" href="/atom.xml" title="早行人" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="../../../../css/style.css">

  <script src="../../../../js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >
  <link rel="stylesheet" href="/css/hiero.css" >
  <link rel="stylesheet" href="/css/glyphs.css" >
  
    <link rel="stylesheet" href="/css/vdonate.css" >
  

  <!-- Custom CSS -->
  <link rel="stylesheet" href="../../../../css/my.css">
  <!-- Google Adsense -->
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
      (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-0123456789ABCDEF",
          enable_page_level_ads: true
      });
  </script>
</head>

<script>
var themeMenus = {};

  themeMenus["../../../../index.html"] = "首页"; 

  themeMenus["../../../../archives"] = "所有文章"; 

  themeMenus["../../../../categories"] = "分类"; 

  themeMenus["../../../../tags"] = "标签"; 

  themeMenus["../../../../about"] = "关于我"; 

</script>


  <body data-spy="scroll" data-target="#toc" data-offset="50">


  <header id="allheader" class="site-header" role="banner">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" rel="home" >
                <img style="margin-bottom: 10px;"  width="400px" height="400px" alt="Hike News" src="http://p83c9zj44.bkt.clouddn.com/mylogo.png">
              </a>
            
          </h1>

          
            <div class="site-description">拥抱这个时代，疯狂这个青春，用青春点亮未来，为时代树立丰碑！</div>
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>
            <div class="clearfix sf-menu">

              <ul id="main-nav" class="nmenu sf-js-enabled">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="../../../../index.html">首页</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="../../../../archives">所有文章</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="../../../../categories">分类</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="../../../../tags">标签</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="../../../../about">关于我</a> </li>
                    
              </ul>
            </div>
          </nav>


      </div>
  </div>
</header>


  <div id="originBgDiv" style="background: #fff; width: 100%;">

      <div style="max-height:600px; overflow: hidden;  display: flex; display: -webkit-flex; align-items: center;">
        <img id="originBg" width="100%" alt="" src="">
      </div>

  </div>

  <script>
  function setAboutIMG(){
      var imgUrls = "css/images/pose.jpg,https://source.unsplash.com/collection/954550/1920x1080".split(",");
      var random = Math.floor((Math.random() * imgUrls.length ));
      if (imgUrls[random].startsWith('http') || imgUrls[random].indexOf('://') >= 0) {
        document.getElementById("originBg").src=imgUrls[random];
      } else {
        document.getElementById("originBg").src='/' + imgUrls[random];
      }
  }
  bgDiv=document.getElementById("originBgDiv");
  if(location.pathname.match('about')){
    setAboutIMG();
    bgDiv.style.display='block';
  }else{
    bgDiv.style.display='none';
  }
  </script>



  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-MySQL8.0：复杂查询" style="width: 66%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      MySQL8.0：复杂查询
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="" class="article-date">
	  <time datetime="2018-07-30T11:10:00.000Z" itemprop="datePublished">七月 30, 2018</time>
	</a>

      
	<span id="busuanzi_container_page_pv">
	  本文总阅读量<span id="busuanzi_value_page_pv"></span>次
	</span>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a>
<h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><h2 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h2><p>MySQL聚合函数也叫分组函数或多行函数，接收多个输入，返回一个输出，包括</p>
<p>求和：<code>sum()</code><br>求最大值：<code>max()</code><br>求最小值：<code>min()</code><br>求平均值：<code>avg()</code><br>统计：<code>count()</code></p>
<p>聚合函数经常搭配<code>group by</code>或<code>having</code>一起使用，接下来一一学习一下他们的用法</p>
<p>求和：<code>sum(列名)</code>    用来对不是null的值进行求和<br>演示：<code>select sum(sal) from emp;</code>      表示求所有员工的月薪之和<br>演示：<code>select sum(comm) from emp;</code>     表示求所有员工的奖金之和</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> sum(sal) from emp;</span><br><span class="line">+----------+</span><br><span class="line">| sum(sal) |</span><br><span class="line">+----------+</span><br><span class="line">| <span class="number">29025.00</span> |</span><br><span class="line">+----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> sum(comm) from emp;</span><br><span class="line">+-----------+</span><br><span class="line">| sum(comm) |</span><br><span class="line">+-----------+</span><br><span class="line">|   <span class="number">2200.00</span> |</span><br><span class="line">+-----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>求最大值：<code>max(列名)</code>      用来计算不是null的值得最大值<br>演示：<code>select max(sal) from emp;</code>      查询最高月薪<br>演示：<code>select max(comm) as 最高奖金 from emp;</code>     查询最高奖金</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> max(sal) from emp;</span><br><span class="line">+----------+</span><br><span class="line">| max(sal) |</span><br><span class="line">+----------+</span><br><span class="line">|  <span class="number">5000.00</span> |</span><br><span class="line">+----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> max(comm) as 最高奖金 from emp;</span><br><span class="line">+--------------+</span><br><span class="line">| 最高奖金     |</span><br><span class="line">+--------------+</span><br><span class="line">|      <span class="number">1400.00</span> |</span><br><span class="line">+--------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>求平均值：<code>avg(列名)</code>  用来计算不是null的值的平均值<br>演示：<code>select avg(sal) as 平均工资 from emp;</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> avg(sal) as 平均工资 from emp;</span><br><span class="line">+--------------+</span><br><span class="line">| 平均工资     |</span><br><span class="line">+--------------+</span><br><span class="line">|  <span class="number">2073.214286</span> |</span><br><span class="line">+--------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>统计函数：<code>count(列名)</code>    统计某列总共有多少条记录<br>演示：<code>select count(*) from emp;</code>      统计总共有多少条记录<br>演示：<code>select count(comm) from emp;</code>   统计有奖金的人数</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> count(*) from emp;</span><br><span class="line">+----------+</span><br><span class="line">| count(*) |</span><br><span class="line">+----------+</span><br><span class="line">|       <span class="number">14</span> |</span><br><span class="line">+----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> count(comm) from emp;</span><br><span class="line">+-------------+</span><br><span class="line">| count(comm) |</span><br><span class="line">+-------------+</span><br><span class="line">|           <span class="number">4</span> |</span><br><span class="line">+-------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<h2 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h2><p>group by 列名，按照指定的列进行分组，值相同的在一起，但是，group by 单独使用的意义不大，例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select deptno from emp group by deptno;</span><br><span class="line">+<span class="comment">--------+</span></span><br><span class="line">| deptno |</span><br><span class="line">+<span class="comment">--------+</span></span><br><span class="line">|     20 |</span><br><span class="line">|     30 |</span><br><span class="line">|     10 |</span><br><span class="line">+<span class="comment">--------+</span></span><br><span class="line">3 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> deptno,sal <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno,sal;</span><br><span class="line">+<span class="comment">--------+---------+</span></span><br><span class="line">| deptno | sal     |</span><br><span class="line">+<span class="comment">--------+---------+</span></span><br><span class="line">|     20 |  800.00 |</span><br><span class="line">|     30 | 1600.00 |</span><br><span class="line">|     30 | 1250.00 |</span><br><span class="line">|     20 | 2975.00 |</span><br><span class="line">|     30 | 2850.00 |</span><br><span class="line">|     10 | 2450.00 |</span><br><span class="line">|     20 | 3000.00 |</span><br><span class="line">|     10 | 5000.00 |</span><br><span class="line">|     30 | 1500.00 |</span><br><span class="line">|     20 | 1100.00 |</span><br><span class="line">|     30 |  950.00 |</span><br><span class="line">|     10 | 1300.00 |</span><br><span class="line">+<span class="comment">--------+---------+</span></span><br><span class="line">12 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>因此group by 的主要用法是配合聚合函数来使用，比如下面这样</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),avg(sal),min(sal),sum(sal),count(sal) from emp group by deptno;</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line">| deptno | max(sal) | avg(sal)    | min(sal) | sum(sal) | count(sal) |</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">3000.00</span> | <span class="number">2175.000000</span> |   <span class="number">800.00</span> | <span class="number">10875.00</span> |          <span class="number">5</span> |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> | <span class="number">1566.666667</span> |   <span class="number">950.00</span> |  <span class="number">9400.00</span> |          <span class="number">6</span> |</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">5000.00</span> | <span class="number">2916.666667</span> |  <span class="number">1300.00</span> |  <span class="number">8750.00</span> |          <span class="number">3</span> |</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line"><span class="number">3</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>也可以在分组之后，再加上排序，下面是用部门编号进行排序</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),avg(sal),min(sal),sum(sal),count(sal) from emp group by deptno order by deptno;</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line">| deptno | max(sal) | avg(sal)    | min(sal) | sum(sal) | count(sal) |</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">5000.00</span> | <span class="number">2916.666667</span> |  <span class="number">1300.00</span> |  <span class="number">8750.00</span> |          <span class="number">3</span> |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">3000.00</span> | <span class="number">2175.000000</span> |   <span class="number">800.00</span> | <span class="number">10875.00</span> |          <span class="number">5</span> |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> | <span class="number">1566.666667</span> |   <span class="number">950.00</span> |  <span class="number">9400.00</span> |          <span class="number">6</span> |</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line"><span class="number">3</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>按部门平均工资进行排序</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),avg(sal),min(sal),sum(sal),count(sal) from emp group by deptno order by avg(sal);</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line">| deptno | max(sal) | avg(sal)    | min(sal) | sum(sal) | count(sal) |</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> | <span class="number">1566.666667</span> |   <span class="number">950.00</span> |  <span class="number">9400.00</span> |          <span class="number">6</span> |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">3000.00</span> | <span class="number">2175.000000</span> |   <span class="number">800.00</span> | <span class="number">10875.00</span> |          <span class="number">5</span> |</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">5000.00</span> | <span class="number">2916.666667</span> |  <span class="number">1300.00</span> |  <span class="number">8750.00</span> |          <span class="number">3</span> |</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line"><span class="number">3</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>上面的几个例子是以部门为单位进行分组，再统计各个部门的最高工资，平均工资，最低工资，工资之和，以及各个部门的员工人数。之后再按部门编号或者平均工资进行排序。</p>
<hr>
<p>还可以先使用where对原始数据进行筛选，之后再通过group by进行分组，再使用聚合函数统计个部门工资情况，例如下面这个例子：<br>首先排除每个部门月薪低于1000元的人员，之后再统计各部门的最高工资，平均工资，工资之和，对统计结果以部门编号进行排序</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),avg(sal),sum(sal) from emp where sal &gt;= <span class="number">1000</span> group by deptno order by deptno;</span><br><span class="line">+--------+----------+-------------+----------+</span><br><span class="line">| deptno | max(sal) | avg(sal)    | sum(sal) |</span><br><span class="line">+--------+----------+-------------+----------+</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">5000.00</span> | <span class="number">2916.666667</span> |  <span class="number">8750.00</span> |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">3000.00</span> | <span class="number">2518.750000</span> | <span class="number">10075.00</span> |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> | <span class="number">1690.000000</span> |  <span class="number">8450.00</span> |</span><br><span class="line">+--------+----------+-------------+----------+</span><br><span class="line"><span class="number">3</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<h4 id="分组后限定查询"><a href="#分组后限定查询" class="headerlink" title="分组后限定查询"></a>分组后限定查询</h4><p>having子句：在分组后再对数据进行筛选，需要使用having子句来完成</p>
<p>语法：<code>select 列名 from 表名 group by 列名 having 条件;</code><br>演示：<code>select mgr from emp group by mgr having mgr is not null;</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select mgr from emp group by mgr;</span><br><span class="line">+<span class="comment">------+</span></span><br><span class="line">| mgr  |</span><br><span class="line">+<span class="comment">------+</span></span><br><span class="line">| 7902 |</span><br><span class="line">| 7698 |</span><br><span class="line">| 7839 |</span><br><span class="line">| 7566 |</span><br><span class="line">| NULL |</span><br><span class="line">| 7788 |</span><br><span class="line">| 7782 |</span><br><span class="line">+<span class="comment">------+</span></span><br><span class="line">7 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> mgr <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> mgr <span class="keyword">having</span> mgr <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>;</span><br><span class="line">+<span class="comment">------+</span></span><br><span class="line">| mgr  |</span><br><span class="line">+<span class="comment">------+</span></span><br><span class="line">| 7902 |</span><br><span class="line">| 7698 |</span><br><span class="line">| 7839 |</span><br><span class="line">| 7566 |</span><br><span class="line">| 7788 |</span><br><span class="line">| 7782 |</span><br><span class="line">+<span class="comment">------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<hr>
<p>更复杂一些的查询，按部门统计各部门的最高工资，以及部门工资之和，并挑选出工资之和小于1万元的，再按部门编号进行排序<br>按部门统计各部门的最高工资，各部门工资之和，并挑选出部门编号大于10的，再按部门编号进行排序</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),sum(sal) from emp group by deptno having sum(sal) &lt; <span class="number">10000</span>;</span><br><span class="line">+--------+----------+----------+</span><br><span class="line">| deptno | max(sal) | sum(sal) |</span><br><span class="line">+--------+----------+----------+</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> |  <span class="number">9400.00</span> |</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">5000.00</span> |  <span class="number">8750.00</span> |</span><br><span class="line">+--------+----------+----------+</span><br><span class="line"><span class="number">2</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),sum(sal) from emp group by deptno having sum(sal) &lt; <span class="number">10000</span> order by deptno;</span><br><span class="line">+--------+----------+----------+</span><br><span class="line">| deptno | max(sal) | sum(sal) |</span><br><span class="line">+--------+----------+----------+</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">5000.00</span> |  <span class="number">8750.00</span> |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> |  <span class="number">9400.00</span> |</span><br><span class="line">+--------+----------+----------+</span><br><span class="line"><span class="number">2</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),sum(sal) from emp group by deptno having deptno &gt; <span class="number">10</span> order by deptno; </span><br><span class="line">+--------+----------+----------+</span><br><span class="line">| deptno | max(sal) | sum(sal) |</span><br><span class="line">+--------+----------+----------+</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">3000.00</span> | <span class="number">10875.00</span> |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> |  <span class="number">9400.00</span> |</span><br><span class="line">+--------+----------+----------+</span><br><span class="line"><span class="number">2</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>还可以在where之后，再跟着使用group by和having，例如：<br>首先排除每个部门工资低于1000元的员工，再按部门统计各部门的最高工资，平均工资，工资之和，再挑选出部门编号大于10的部门，筛选结果以部门编号进行排序</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),avg(sal),sum(sal) from emp where sal &gt;= <span class="number">1000</span> group by deptno having deptno &gt; <span class="number">10</span> order by deptno ;</span><br><span class="line">+--------+----------+-------------+----------+</span><br><span class="line">| deptno | max(sal) | avg(sal)    | sum(sal) |</span><br><span class="line">+--------+----------+-------------+----------+</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">3000.00</span> | <span class="number">2518.750000</span> | <span class="number">10075.00</span> |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> | <span class="number">1690.000000</span> |  <span class="number">8450.00</span> |</span><br><span class="line">+--------+----------+-------------+----------+</span><br><span class="line"><span class="number">2</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>having子句的作用是对group by分组后的结果，进行再次筛选，其与where语句的区别如下：</p>
<ol>
<li>where和having后面都是跟条件</li>
<li>where是对表中的数据进行原始筛选</li>
<li>having是对group by的结果的二次筛选</li>
<li>having必须配合group by使用，一般也配合聚合函数使用</li>
<li>可以先有where，后面跟着group by和having</li>
<li>where是先过滤再分组，having是先分组再过滤</li>
<li>如果有order by 排序的，order by一般放在最后。</li>
</ol>
<h2 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h2><p>limit子句：用于限定查询结果的起始行，以及总行数</p>
<p>语法：<code>select 列名 from 表名 limit start，count;</code><br>这里的start表示查询结果的起始行，表示从start➕1行开始，count表示总行数。<br>演示：<code>select * from emp limit 0,3;</code>   表示从第1行开始，查询3行。<br>演示：<code>select * from emp limit 13,3;</code>  表示从第14行开始，查询3行。<br>演示：<code>select * from emp limit 14,3;</code>  表示从第15行开始，查询3行。由于没有第15行，所以查询结果为空。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp limit <span class="number">0</span>,<span class="number">3</span>;</span><br><span class="line">+-------+-------+----------+------+---------------------+---------+--------+--------+</span><br><span class="line">| empno | ename | job      | mgr  | hiredate            | sal     | comm   | deptno |</span><br><span class="line">+-------+-------+----------+------+---------------------+---------+--------+--------+</span><br><span class="line">|  <span class="number">7369</span> | SMITH | CLERK    | <span class="number">7902</span> | <span class="number">1980</span><span class="number">-12</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">800.00</span> |   NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1600.00</span> | <span class="number">300.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7521</span> | WARD  | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-22</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> | <span class="number">500.00</span> |     <span class="number">30</span> |</span><br><span class="line">+-------+-------+----------+------+---------------------+---------+--------+--------+</span><br><span class="line"><span class="number">3</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from emp limit <span class="number">13</span>,<span class="number">3</span>;</span><br><span class="line">+-------+--------+-------+------+---------------------+---------+------+--------+</span><br><span class="line">| empno | ename  | job   | mgr  | hiredate            | sal     | comm | deptno |</span><br><span class="line">+-------+--------+-------+------+---------------------+---------+------+--------+</span><br><span class="line">|  <span class="number">7934</span> | MILLER | CLERK | <span class="number">7782</span> | <span class="number">1982</span><span class="number">-01</span><span class="number">-23</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1300.00</span> | NULL |     <span class="number">10</span> |</span><br><span class="line">+-------+--------+-------+------+---------------------+---------+------+--------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from emp limit <span class="number">14</span>,<span class="number">3</span>;</span><br><span class="line">Empty set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<h2 id="内置函数"><a href="#内置函数" class="headerlink" title="内置函数"></a>内置函数</h2><h4 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h4><p>查看字符的ASCII编码：<code>select ascii(&#39;a&#39;);</code>   字符串空串返回0<br>查看ASCII编码对应的字符：<code>select char(97);</code>   编码0返回空字符串<br>字符串拼接：<code>select concat(12,34,&#39;ab&#39;);</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> ascii(<span class="string">'');</span></span><br><span class="line"><span class="string">+-----------+</span></span><br><span class="line"><span class="string">| ascii('</span><span class="string">') |</span></span><br><span class="line"><span class="string">+-----------+</span></span><br><span class="line"><span class="string">|         0 |</span></span><br><span class="line"><span class="string">+-----------+</span></span><br><span class="line"><span class="string">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt; select char(0);</span></span><br><span class="line"><span class="string">+---------+</span></span><br><span class="line"><span class="string">| char(0) |</span></span><br><span class="line"><span class="string">+---------+</span></span><br><span class="line"><span class="string">|         |</span></span><br><span class="line"><span class="string">+---------+</span></span><br><span class="line"><span class="string">1 row in set (0.01 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt; select ascii('</span>a<span class="string">');</span></span><br><span class="line"><span class="string">+------------+</span></span><br><span class="line"><span class="string">| ascii('</span>a<span class="string">') |</span></span><br><span class="line"><span class="string">+------------+</span></span><br><span class="line"><span class="string">|         97 |</span></span><br><span class="line"><span class="string">+------------+</span></span><br><span class="line"><span class="string">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt; select char(97);</span></span><br><span class="line"><span class="string">+----------+</span></span><br><span class="line"><span class="string">| char(97) |</span></span><br><span class="line"><span class="string">+----------+</span></span><br><span class="line"><span class="string">| a        |</span></span><br><span class="line"><span class="string">+----------+</span></span><br><span class="line"><span class="string">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt; select concat(12,34,'</span>ab<span class="string">');</span></span><br><span class="line"><span class="string">+--------------------+</span></span><br><span class="line"><span class="string">| concat(12,34,'</span>ab<span class="string">') |</span></span><br><span class="line"><span class="string">+--------------------+</span></span><br><span class="line"><span class="string">| 1234ab             |</span></span><br><span class="line"><span class="string">+--------------------+</span></span><br><span class="line"><span class="string">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt;</span></span><br></pre></td></tr></table></figure>
<p>包含字符个数length(str)   str包含几个字符<br>截取字符串left(str,count)    返回str左端count个字符<br>截取字符串right(str,count)   返回str右端count个字符</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> length(name) from students;</span><br><span class="line">+--------------+</span><br><span class="line">| length(name) |</span><br><span class="line">+--------------+</span><br><span class="line">|            <span class="number">4</span> |</span><br><span class="line">|            <span class="number">9</span> |</span><br><span class="line">|            <span class="number">9</span> |</span><br><span class="line">|            <span class="number">6</span> |</span><br><span class="line">|            <span class="number">9</span> |</span><br><span class="line">|            <span class="number">9</span> |</span><br><span class="line">+--------------+</span><br><span class="line"><span class="number">6</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> left(name,<span class="number">2</span>) from students;</span><br><span class="line">+--------------+</span><br><span class="line">| left(name,<span class="number">2</span>) |</span><br><span class="line">+--------------+</span><br><span class="line">| Li           |</span><br><span class="line">| 梅长         |</span><br><span class="line">| 穆霓         |</span><br><span class="line">| 飞流         |</span><br><span class="line">| 萧景         |</span><br><span class="line">| 萧景         |</span><br><span class="line">+--------------+</span><br><span class="line"><span class="number">6</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> right(name,<span class="number">2</span>) from students;</span><br><span class="line">+---------------+</span><br><span class="line">| right(name,<span class="number">2</span>) |</span><br><span class="line">+---------------+</span><br><span class="line">| ly            |</span><br><span class="line">| 长苏          |</span><br><span class="line">| 霓凰          |</span><br><span class="line">| 飞流          |</span><br><span class="line">| 景琰          |</span><br><span class="line">| 景琰          |</span><br><span class="line">+---------------+</span><br><span class="line"><span class="number">6</span> rows in set (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>除此之外，substring()，ltrim()，rtrim()，trim()，space()，replace()，lower()，upper()等函数，用法都很简单，就不一一列举了。</p>
<p>另外MySQL还提供了数学函数，时间日期函数，这里也不在列举。下面重点学习多表查询。</p>
<h2 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h2><p>一张表的数据不够，需要其他表的数据来补充，需要同时对多张表进行查询，例如：<br>查询部门不在accounting和sales中的员工信息</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp e,dept d where e.deptno=d.deptno and dname!= <span class="string">"accounting"</span> and  dname != <span class="string">"sales"</span>;</span><br><span class="line">+-------+-------+---------+------+---------------------+---------+------+--------+--------+----------+--------+</span><br><span class="line">| empno | ename | job     | mgr  | hiredate            | sal     | comm | deptno | deptno | dname    | loc    |</span><br><span class="line">+-------+-------+---------+------+---------------------+---------+------+--------+--------+----------+--------+</span><br><span class="line">|  <span class="number">7369</span> | SMITH | CLERK   | <span class="number">7902</span> | <span class="number">1980</span><span class="number">-12</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">800.00</span> | NULL |     <span class="number">20</span> |     <span class="number">20</span> | RESEARCH | DALLAS |</span><br><span class="line">|  <span class="number">7566</span> | JONES | MANAGER | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-04</span><span class="number">-02</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2975.00</span> | NULL |     <span class="number">20</span> |     <span class="number">20</span> | RESEARCH | DALLAS |</span><br><span class="line">|  <span class="number">7788</span> | SCOTT | ANALYST | <span class="number">7566</span> | <span class="number">1982</span><span class="number">-12</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> | NULL |     <span class="number">20</span> |     <span class="number">20</span> | RESEARCH | DALLAS |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS | CLERK   | <span class="number">7788</span> | <span class="number">1983</span><span class="number">-01</span><span class="number">-12</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1100.00</span> | NULL |     <span class="number">20</span> |     <span class="number">20</span> | RESEARCH | DALLAS |</span><br><span class="line">|  <span class="number">7902</span> | FORD  | ANALYST | <span class="number">7566</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> | NULL |     <span class="number">20</span> |     <span class="number">20</span> | RESEARCH | DALLAS |</span><br><span class="line">+-------+-------+---------+------+---------------------+---------+------+--------+--------+----------+--------+</span><br><span class="line"><span class="number">5</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p><img src="http://p83c9zj44.bkt.clouddn.com/mysql%E5%A4%9A%E8%A1%A8%E8%81%94%E6%9F%A5.jpeg" alt=""><br>除上面这样对多张表进行连接查询外，还有左外连接、右外连接以及自然连接等查询方法，需要使用join关键字，进行连接</p>
<h4 id="左外连接"><a href="#左外连接" class="headerlink" title="左外连接"></a>左外连接</h4><p>左表记录无论是否满足条件都会查询出来，而右表只有满足条件才能查询出来，左表中不满足条件的记录，右表部分都为null</p>
<p>语法：<code>select * from 表1 别名1 left outer join 表2 别名2 on 别名1.xx=别名2.xx</code><br>演示：<code>select empno,ename,job,sal,comm,d.deptno,d.dname from emp as e left outer join dept as d on e.deptno=d.deptno;</code><br>这里的两个as都可以省略</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> empno,ename,job,sal,comm,d.deptno,d.dname from emp as e left outer join dept as d on e.deptno=d.deptno;</span><br><span class="line">+-------+--------+-----------+---------+---------+--------+------------+</span><br><span class="line">| empno | ename  | job       | sal     | comm    | deptno | dname      |</span><br><span class="line">+-------+--------+-----------+---------+---------+--------+------------+</span><br><span class="line">|  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">2450.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING |</span><br><span class="line">|  <span class="number">7839</span> | KING   | PRESIDENT | <span class="number">5000.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING |</span><br><span class="line">|  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">1300.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING |</span><br><span class="line">|  <span class="number">7369</span> | SMITH  | CLERK     |  <span class="number">800.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   |</span><br><span class="line">|  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">2975.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   |</span><br><span class="line">|  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">1100.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   |</span><br><span class="line">|  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">1600.00</span> |  <span class="number">300.00</span> |     <span class="number">30</span> | SALES      |</span><br><span class="line">|  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">1250.00</span> |  <span class="number">500.00</span> |     <span class="number">30</span> | SALES      |</span><br><span class="line">|  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">1250.00</span> | <span class="number">1400.00</span> |     <span class="number">30</span> | SALES      |</span><br><span class="line">|  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">2850.00</span> |    NULL |     <span class="number">30</span> | SALES      |</span><br><span class="line">|  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">1500.00</span> |    <span class="number">0.00</span> |     <span class="number">30</span> | SALES      |</span><br><span class="line">|  <span class="number">7900</span> | JAMES  | CLERK     |  <span class="number">950.00</span> |    NULL |     <span class="number">30</span> | SALES      |</span><br><span class="line">+-------+--------+-----------+---------+---------+--------+------------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<h6 id="左外自然"><a href="#左外自然" class="headerlink" title="左外自然"></a>左外自然</h6><p>以emp表和dept表为例：查询所有员工的工号、姓名、工作、月薪、奖金、部门编号，以及部门名称、所在城市。<br>显然，这些信息一部分在emp表中，一部分在dept表中，所以必须对两张表进行连接查询，才能得到所有信息。</p>
<p>语法：<code>select * from 表1 别名1 natural left outer join 表2 别名2;</code><br>演示：<code>select * from emp e natural left outer join dept d;</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp e natural left outer join dept d;</span><br><span class="line">+--------+-------+--------+-----------+------+---------------------+---------+---------+------------+----------+</span><br><span class="line">| deptno | empno | ename  | job       | mgr  | hiredate            | sal     | comm    | dname      | loc      |</span><br><span class="line">+--------+-------+--------+-----------+------+---------------------+---------+---------+------------+----------+</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-06</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2450.00</span> |    NULL | ACCOUNTING | NEW YORK |</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">1981</span><span class="number">-11</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">5000.00</span> |    NULL | ACCOUNTING | NEW YORK |</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1982</span><span class="number">-01</span><span class="number">-23</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1300.00</span> |    NULL | ACCOUNTING | NEW YORK |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> | <span class="number">1980</span><span class="number">-12</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">800.00</span> |    NULL | RESEARCH   | DALLAS   |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-04</span><span class="number">-02</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2975.00</span> |    NULL | RESEARCH   | DALLAS   |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">1982</span><span class="number">-12</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> |    NULL | RESEARCH   | DALLAS   |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1983</span><span class="number">-01</span><span class="number">-12</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1100.00</span> |    NULL | RESEARCH   | DALLAS   |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> |    NULL | RESEARCH   | DALLAS   |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1600.00</span> |  <span class="number">300.00</span> | SALES      | CHICAGO  |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-22</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> |  <span class="number">500.00</span> | SALES      | CHICAGO  |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-28</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> | <span class="number">1400.00</span> | SALES      | CHICAGO  |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-05</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2850.00</span> |    NULL | SALES      | CHICAGO  |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-08</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1500.00</span> |    <span class="number">0.00</span> | SALES      | CHICAGO  |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">950.00</span> |    NULL | SALES      | CHICAGO  |</span><br><span class="line">+--------+-------+--------+-----------+------+---------------------+---------+---------+------------+----------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>可见，左外自然连接查询，两张表的重复字段会被放到查询结果的第一列，其余的不变。<br><img src="http://p83c9zj44.bkt.clouddn.com/mysqlMySQL%E5%B7%A6%E5%A4%96%E8%87%AA%E7%84%B6.jpeg" alt=""></p>
<h4 id="右外连接"><a href="#右外连接" class="headerlink" title="右外连接"></a>右外连接</h4><p>右表记录无论是否满足条件都会查询出来，而左表只有满足条件才能查询出来。右表中不满足条件的记录，左表部分都为null。</p>
<p>语法：<code>select * from 表1 别名1 right outer join 表2 别名2 on 别名1.xx=别名2.xx;</code><br>演示：<code>select empno,ename,job,mgr,sal,comm,e.deptno,dname,loc from emp e right outer join dept d on e.deptno=d.deptno;</code><br>或者：<code>select empno,ename,job,mgr,sal,comm,d.deptno,dname,loc from emp e right outer join dept d on e.deptno=d.deptno;</code><br>或者：<code>select empno,ename,job,mgr,sal,comm,emp.deptno,dname,loc from emp right outer join dept on emp.deptno=dept.deptno;</code><br>或者：<code>select empno,ename,job,mgr,sal,comm,d.deptno,d.dname,d.loc from emp e right outer join dept d on e.deptno=d.deptno;</code><br>两张表中都有的字段，必须要写成<code>表名.字段名</code>或者<code>别名.字段名</code>，否则会报错。比如deptno字段，两张表中都有，所以必须要写成<code>d.deptno</code>或者<code>e.deptno</code>。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> empno,ename,job,mgr,sal,comm,e.deptno,dname,loc from emp e right outer join dept d on e.deptno=d.deptno;</span><br><span class="line">+-------+--------+-----------+------+---------+---------+--------+------------+----------+</span><br><span class="line">| empno | ename  | job       | mgr  | sal     | comm    | deptno | dname      | loc      |</span><br><span class="line">+-------+--------+-----------+------+---------+---------+--------+------------+----------+</span><br><span class="line">|  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> |  <span class="number">800.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1600.00</span> |  <span class="number">300.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |  <span class="number">500.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">2975.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> | <span class="number">1400.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |    NULL |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">2450.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">5000.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1500.00</span> |    <span class="number">0.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1100.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> |  <span class="number">950.00</span> |    NULL |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1300.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  NULL | NULL   | NULL      | NULL |    NULL |    NULL |   NULL | OPERATIONS | BOSTON   |</span><br><span class="line">+-------+--------+-----------+------+---------+---------+--------+------------+----------+</span><br><span class="line"><span class="number">15</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p><img src="http://p83c9zj44.bkt.clouddn.com/mysqlmysql%E5%8F%B3%E5%A4%96%E8%BF%9E%E6%8E%A5.jpeg" alt=""></p>
<h6 id="右外自然"><a href="#右外自然" class="headerlink" title="右外自然"></a>右外自然</h6><p>语法：<code>select * from 表1 别名1 natural right outer join 表2 别名2;</code><br>演示：<code>select * from emp natural right outer join dept;</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp natural right outer join dept;</span><br><span class="line">+--------+------------+----------+-------+--------+-----------+------+---------------------+---------+---------+</span><br><span class="line">| deptno | dname      | loc      | empno | ename  | job       | mgr  | hiredate            | sal     | comm    |</span><br><span class="line">+--------+------------+----------+-------+--------+-----------+------+---------------------+---------+---------+</span><br><span class="line">|     <span class="number">20</span> | RESEARCH   | DALLAS   |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> | <span class="number">1980</span><span class="number">-12</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">800.00</span> |    NULL |</span><br><span class="line">|     <span class="number">30</span> | SALES      | CHICAGO  |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1600.00</span> |  <span class="number">300.00</span> |</span><br><span class="line">|     <span class="number">30</span> | SALES      | CHICAGO  |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-22</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> |  <span class="number">500.00</span> |</span><br><span class="line">|     <span class="number">20</span> | RESEARCH   | DALLAS   |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-04</span><span class="number">-02</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2975.00</span> |    NULL |</span><br><span class="line">|     <span class="number">30</span> | SALES      | CHICAGO  |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-28</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> | <span class="number">1400.00</span> |</span><br><span class="line">|     <span class="number">30</span> | SALES      | CHICAGO  |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-05</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2850.00</span> |    NULL |</span><br><span class="line">|     <span class="number">10</span> | ACCOUNTING | NEW YORK |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-06</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2450.00</span> |    NULL |</span><br><span class="line">|     <span class="number">20</span> | RESEARCH   | DALLAS   |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">1982</span><span class="number">-12</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> |    NULL |</span><br><span class="line">|     <span class="number">10</span> | ACCOUNTING | NEW YORK |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">1981</span><span class="number">-11</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">5000.00</span> |    NULL |</span><br><span class="line">|     <span class="number">30</span> | SALES      | CHICAGO  |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-08</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1500.00</span> |    <span class="number">0.00</span> |</span><br><span class="line">|     <span class="number">20</span> | RESEARCH   | DALLAS   |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1983</span><span class="number">-01</span><span class="number">-12</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1100.00</span> |    NULL |</span><br><span class="line">|     <span class="number">30</span> | SALES      | CHICAGO  |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">950.00</span> |    NULL |</span><br><span class="line">|     <span class="number">20</span> | RESEARCH   | DALLAS   |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> |    NULL |</span><br><span class="line">|     <span class="number">10</span> | ACCOUNTING | NEW YORK |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1982</span><span class="number">-01</span><span class="number">-23</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1300.00</span> |    NULL |</span><br><span class="line">|     <span class="number">40</span> | OPERATIONS | BOSTON   |  NULL | NULL   | NULL      | NULL | NULL                |    NULL |    NULL |</span><br><span class="line">+--------+------------+----------+-------+--------+-----------+------+---------------------+---------+---------+</span><br><span class="line"><span class="number">15</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p><img src="http://p83c9zj44.bkt.clouddn.com/mysqlMySQL%E5%8F%B3%E5%A4%96%E8%87%AA%E7%84%B6.jpeg" alt=""></p>
<p>演示：<code>select empno,ename,job,sal,comm,e.deptno,dname,loc from emp e natural right outer join dept d;</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> empno,ename,job,sal,comm,e.deptno,dname,loc from emp e natural right outer join dept d;</span><br><span class="line">+-------+--------+-----------+---------+---------+--------+------------+----------+</span><br><span class="line">| empno | ename  | job       | sal     | comm    | deptno | dname      | loc      |</span><br><span class="line">+-------+--------+-----------+---------+---------+--------+------------+----------+</span><br><span class="line">|  <span class="number">7369</span> | SMITH  | CLERK     |  <span class="number">800.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">1600.00</span> |  <span class="number">300.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">1250.00</span> |  <span class="number">500.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">2975.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">1250.00</span> | <span class="number">1400.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">2850.00</span> |    NULL |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">2450.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7839</span> | KING   | PRESIDENT | <span class="number">5000.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">1500.00</span> |    <span class="number">0.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">1100.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7900</span> | JAMES  | CLERK     |  <span class="number">950.00</span> |    NULL |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">1300.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  NULL | NULL   | NULL      |    NULL |    NULL |   NULL | OPERATIONS | BOSTON   |</span><br><span class="line">+-------+--------+-----------+---------+---------+--------+------------+----------+</span><br><span class="line"><span class="number">15</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<h4 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h4><p>自连接就是一张表连接自己</p>
<p>语法：<code>select 别名1.字段1,别名1.字段2,别名1.字段3,别名2.字段a,别名2.字段b from 表名 as 别名1 left outer join 表名 as 别名2 on 别名1.某字段=别名2.某字段;</code></p>
<p>从emp表中查询所有员工的编号，姓名，上级领导，及其上级领导的编号和姓名<br>演示：<code>select e.empno,e.ename,e.mgr,m.empno,m.ename from emp as e left outer join emp as m on e.mgr=m.empno;</code><br>这里的两个as都可以省略</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> e.empno,e.ename,e.mgr,m.empno,m.ename from emp as e left outer join emp as m on e.mgr=m.empno;</span><br><span class="line">+-------+--------+------+-------+-------+</span><br><span class="line">| empno | ename  | mgr  | empno | ename |</span><br><span class="line">+-------+--------+------+-------+-------+</span><br><span class="line">|  <span class="number">7788</span> | SCOTT  | <span class="number">7566</span> |  <span class="number">7566</span> | JONES |</span><br><span class="line">|  <span class="number">7902</span> | FORD   | <span class="number">7566</span> |  <span class="number">7566</span> | JONES |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | <span class="number">7698</span> |  <span class="number">7698</span> | BLAKE |</span><br><span class="line">|  <span class="number">7521</span> | WARD   | <span class="number">7698</span> |  <span class="number">7698</span> | BLAKE |</span><br><span class="line">|  <span class="number">7654</span> | MARTIN | <span class="number">7698</span> |  <span class="number">7698</span> | BLAKE |</span><br><span class="line">|  <span class="number">7844</span> | TURNER | <span class="number">7698</span> |  <span class="number">7698</span> | BLAKE |</span><br><span class="line">|  <span class="number">7900</span> | JAMES  | <span class="number">7698</span> |  <span class="number">7698</span> | BLAKE |</span><br><span class="line">|  <span class="number">7934</span> | MILLER | <span class="number">7782</span> |  <span class="number">7782</span> | CLARK |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS  | <span class="number">7788</span> |  <span class="number">7788</span> | SCOTT |</span><br><span class="line">|  <span class="number">7566</span> | JONES  | <span class="number">7839</span> |  <span class="number">7839</span> | KING  |</span><br><span class="line">|  <span class="number">7698</span> | BLAKE  | <span class="number">7839</span> |  <span class="number">7839</span> | KING  |</span><br><span class="line">|  <span class="number">7782</span> | CLARK  | <span class="number">7839</span> |  <span class="number">7839</span> | KING  |</span><br><span class="line">|  <span class="number">7369</span> | SMITH  | <span class="number">7902</span> |  <span class="number">7902</span> | FORD  |</span><br><span class="line">|  <span class="number">7839</span> | KING   | NULL |  NULL | NULL  |</span><br><span class="line">+-------+--------+------+-------+-------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><p>子查询是指sql语句中包含另一个select语句</p>
<blockquote>
<p>一条sql语句中，包含多个select关键字<br>外查询，内查询</p>
</blockquote>
<p>子查询可以出现的位置：<br>from后面，作为表<br>where后面，作为条件</p>
<p>注意事项：<br>1、子查询必须在()里；<br>2、在子查询中不能使用order by子句。<br>3、子查询可以再嵌套子查询，最多不超过255层。</p>
<p>子查询还分为：单行子查询，多行子查询，关联子查询。</p>
<p>例如：查询工资至少比20部门一个员工高的员工信息</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp  where sal &gt; any(<span class="keyword">select</span> sal from emp where deptno=<span class="number">20</span>);</span><br><span class="line">+-------+--------+-----------+------+---------------------+---------+---------+--------+</span><br><span class="line">| empno | ename  | job       | mgr  | hiredate            | sal     | comm    | deptno |</span><br><span class="line">+-------+--------+-----------+------+---------------------+---------+---------+--------+</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1600.00</span> |  <span class="number">300.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-22</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> |  <span class="number">500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-04</span><span class="number">-02</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2975.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-28</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> | <span class="number">1400.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-05</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2850.00</span> |    NULL |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-06</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2450.00</span> |    NULL |     <span class="number">10</span> |</span><br><span class="line">|  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">1982</span><span class="number">-12</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">1981</span><span class="number">-11</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">5000.00</span> |    NULL |     <span class="number">10</span> |</span><br><span class="line">|  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-08</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1500.00</span> |    <span class="number">0.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1983</span><span class="number">-01</span><span class="number">-12</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1100.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">950.00</span> |    NULL |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1982</span><span class="number">-01</span><span class="number">-23</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1300.00</span> |    NULL |     <span class="number">10</span> |</span><br><span class="line">+-------+--------+-----------+------+---------------------+---------+---------+--------+</span><br><span class="line"><span class="number">13</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>查询工资比20部门所有员工都高的员工信息</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp  where sal &gt; all(<span class="keyword">select</span> sal from emp where deptno=<span class="number">20</span>);</span><br><span class="line">+-------+-------+-----------+------+---------------------+---------+------+--------+</span><br><span class="line">| empno | ename | job       | mgr  | hiredate            | sal     | comm | deptno |</span><br><span class="line">+-------+-------+-----------+------+---------------------+---------+------+--------+</span><br><span class="line">|  <span class="number">7839</span> | KING  | PRESIDENT | NULL | <span class="number">1981</span><span class="number">-11</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">5000.00</span> | NULL |     <span class="number">10</span> |</span><br><span class="line">+-------+-------+-----------+------+---------------------+---------+------+--------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>查询不是领导的员工信息</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp where empno not in(<span class="keyword">select</span> ifnull(mgr,<span class="number">0</span>) from emp);</span><br><span class="line">+-------+--------+----------+------+---------------------+---------+---------+--------+</span><br><span class="line">| empno | ename  | job      | mgr  | hiredate            | sal     | comm    | deptno |</span><br><span class="line">+-------+--------+----------+------+---------------------+---------+---------+--------+</span><br><span class="line">|  <span class="number">7369</span> | SMITH  | CLERK    | <span class="number">7902</span> | <span class="number">1980</span><span class="number">-12</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">800.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1600.00</span> |  <span class="number">300.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7521</span> | WARD   | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-22</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> |  <span class="number">500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7654</span> | MARTIN | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-28</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> | <span class="number">1400.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7844</span> | TURNER | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-08</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1500.00</span> |    <span class="number">0.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS  | CLERK    | <span class="number">7788</span> | <span class="number">1983</span><span class="number">-01</span><span class="number">-12</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1100.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7900</span> | JAMES  | CLERK    | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">950.00</span> |    NULL |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7934</span> | MILLER | CLERK    | <span class="number">7782</span> | <span class="number">1982</span><span class="number">-01</span><span class="number">-23</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1300.00</span> |    NULL |     <span class="number">10</span> |</span><br><span class="line">+-------+--------+----------+------+---------------------+---------+---------+--------+</span><br><span class="line"><span class="number">8</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<h2 id="窗口函数"><a href="#窗口函数" class="headerlink" title="窗口函数"></a>窗口函数</h2><p>MySQL8.0新增了窗口函数，over()，row_number()，rank(),dense_rank()函数，以前都是Oracle特有的功能，这里分别看看怎么用</p>
<p>over()不能单独使用，要和rank()，dense_rank()，row_number()等函数一起使用</p>
<p>这几个函数都是用来排名和编号，区别在于，rank()的排名会跳号，比如有两个人成绩相同，并列第一名，那么两个第一名之后，紧接着是第三名，而没有第二名，而dense_rank()则是两个第一名之后，紧接着是第二名，这里来查询一下<br>演示：<code>select rank() over(partition by mgr order by sal desc) as sal_no,empno,ename,job,mgr,deptno from emp;</code><br>这里解释下over()函数，<code>over(partition by columnname1 order by columnname2)</code><br>含义：按字段columnname1进行分组，按字段column2进行排名，具体到本例的意思就是，以上级领导的编号进行分组，在每组内以工资进行排名。即把每个部门的员工按工资进行排名</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> rank() over(partition by mgr order by sal desc) as sal_no,empno,ename,job,mgr,sal,deptno from emp; </span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">| sal_no | empno | ename  | job       | mgr  | sal     | deptno |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">5000.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1600.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">5</span> |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> |  <span class="number">950.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1300.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1100.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">2975.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">2450.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> |  <span class="number">800.00</span> |     <span class="number">20</span> |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>用dense_rank()函数排名</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> dense_rank() over(partition by mgr order by sal desc) as sal_no,empno,ename,job,mgr,sal,deptno from emp;</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">| sal_no | empno | ename  | job       | mgr  | sal     | deptno |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">5000.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1600.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">4</span> |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> |  <span class="number">950.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1300.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1100.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">2975.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">2450.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> |  <span class="number">800.00</span> |     <span class="number">20</span> |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>对比两次查询结果发现，使用rank()函数的时候，第三组7698中六个员工的排名是1、2、3、3、5，而使用dense_rank()函数的时候，六个人排名变成了1、2、3、3、4</p>
<p>接下来再看看row_number()函数，其作用是为每一条记录编号，并且编号不重复，<br>演示：<code>select row_number() over(partition by mgr order by sal) as sal_no,empno,ename,job,mgr,deptno from emp;</code><br>这里的意思是，以上级领导进行分组，以工资进行排序，并按顺序编号，工资相同的，以其他字段排名。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> row_number() over(partition by mgr order by sal desc) as sal_no,empno,ename,job,mgr,sal,deptno from emp;</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">| sal_no | empno | ename  | job       | mgr  | sal     | deptno |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">5000.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1600.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">4</span> |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">5</span> |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> |  <span class="number">950.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1300.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1100.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">2975.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">2450.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> |  <span class="number">800.00</span> |     <span class="number">20</span> |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>以部门分组，并以工资高低排序</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> rank() over(partition by deptno order by sal) as sal_no,empno,ename,job,mgr,sal,deptno from emp;</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">| sal_no | empno | ename  | job       | mgr  | sal     | deptno |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1300.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">2450.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">5000.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> |  <span class="number">800.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1100.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">2975.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">4</span> |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">4</span> |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> |  <span class="number">950.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">4</span> |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">5</span> |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1600.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">6</span> |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |     <span class="number">30</span> |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>按部门分组，并以工资高低按顺序编号</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> row_number() over(partition by deptno order by sal desc) as dept_no,empno,ename,job,mgr,sal,deptno from emp;</span><br><span class="line">+---------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">| dept_no | empno | ename  | job       | mgr  | sal     | deptno |</span><br><span class="line">+---------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">5000.00</span> |     <span class="number">10</span> |</span><br><span class="line">|       <span class="number">2</span> |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">2450.00</span> |     <span class="number">10</span> |</span><br><span class="line">|       <span class="number">3</span> |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1300.00</span> |     <span class="number">10</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">2</span> |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">3</span> |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">2975.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">4</span> |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1100.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">5</span> |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> |  <span class="number">800.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">2</span> |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1600.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">3</span> |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">4</span> |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">5</span> |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">6</span> |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> |  <span class="number">950.00</span> |     <span class="number">30</span> |</span><br><span class="line">+---------+-------+--------+-----------+------+---------+--------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>找出每个部门工资最高的员工</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> dense_rank() over(partition by deptno order by sal desc) as dept_no,empno,ename,job,mgr,sal,deptno from emp;</span><br><span class="line">+---------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">| dept_no | empno | ename  | job       | mgr  | sal     | deptno |</span><br><span class="line">+---------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">5000.00</span> |     <span class="number">10</span> |</span><br><span class="line">|       <span class="number">2</span> |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">2450.00</span> |     <span class="number">10</span> |</span><br><span class="line">|       <span class="number">3</span> |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1300.00</span> |     <span class="number">10</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">2</span> |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">2975.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">3</span> |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1100.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">4</span> |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> |  <span class="number">800.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">2</span> |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1600.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">3</span> |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">4</span> |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">4</span> |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">5</span> |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> |  <span class="number">950.00</span> |     <span class="number">30</span> |</span><br><span class="line">+---------+-------+--------+-----------+------+---------+--------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from ( <span class="keyword">select</span> dense_rank() over(partition by deptno order by sal desc) as dept_no,empno,ename,job,mgr,sal,deptno from emp ) as t where dept_no=<span class="number">1</span>;</span><br><span class="line">+---------+-------+-------+-----------+------+---------+--------+</span><br><span class="line">| dept_no | empno | ename | job       | mgr  | sal     | deptno |</span><br><span class="line">+---------+-------+-------+-----------+------+---------+--------+</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7839</span> | KING  | PRESIDENT | NULL | <span class="number">5000.00</span> |     <span class="number">10</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7788</span> | SCOTT | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7902</span> | FORD  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7698</span> | BLAKE | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |     <span class="number">30</span> |</span><br><span class="line">+---------+-------+-------+-----------+------+---------+--------+</span><br><span class="line"><span class="number">4</span> rows in set (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<h6 id="综合运用"><a href="#综合运用" class="headerlink" title="综合运用"></a>综合运用</h6><p>窗口函数、嵌套查询、外连接的综合运用</p>
<p>将所有员工以其工资从高到底在部门内排序，查询所有员工的详细信息，包括部门编号、部门名称、和部门所在地<br>演示：<code>select * from (select rank() over(partition by deptno order by sal desc) as sal_no,empno,ename,job,mgr,comm,sal,deptno from emp ) as t left outer join dept d on t.deptno=d.deptno;</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from (select rank() over(partition by deptno order by sal desc) as sal_no,empno,ename,job,mgr,comm,sal,deptno from emp ) as t left outer join dept d on t.deptno=d.deptno;</span><br><span class="line">+<span class="comment">--------+-------+--------+-----------+------+---------+---------+--------+--------+------------+----------+</span></span><br><span class="line">| sal_no | empno | ename  | job       | mgr  | comm    | sal     | deptno | deptno | dname      | loc      |</span><br><span class="line">+<span class="comment">--------+-------+--------+-----------+------+---------+---------+--------+--------+------------+----------+</span></span><br><span class="line">|      1 |  7839 | KING   | PRESIDENT | NULL |    NULL | 5000.00 |     10 |     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|      2 |  7782 | CLARK  | MANAGER   | 7839 |    NULL | 2450.00 |     10 |     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|      3 |  7934 | MILLER | CLERK     | 7782 |    NULL | 1300.00 |     10 |     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|      1 |  7788 | SCOTT  | ANALYST   | 7566 |    NULL | 3000.00 |     20 |     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|      1 |  7902 | FORD   | ANALYST   | 7566 |    NULL | 3000.00 |     20 |     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|      3 |  7566 | JONES  | MANAGER   | 7839 |    NULL | 2975.00 |     20 |     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|      4 |  7876 | ADAMS  | CLERK     | 7788 |    NULL | 1100.00 |     20 |     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|      5 |  7369 | SMITH  | CLERK     | 7902 |    NULL |  800.00 |     20 |     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|      1 |  7698 | BLAKE  | MANAGER   | 7839 |    NULL | 2850.00 |     30 |     30 | SALES      | CHICAGO  |</span><br><span class="line">|      2 |  7499 | ALLEN  | SALESMAN  | 7698 |  300.00 | 1600.00 |     30 |     30 | SALES      | CHICAGO  |</span><br><span class="line">|      3 |  7844 | TURNER | SALESMAN  | 7698 |    0.00 | 1500.00 |     30 |     30 | SALES      | CHICAGO  |</span><br><span class="line">|      4 |  7521 | WARD   | SALESMAN  | 7698 |  500.00 | 1250.00 |     30 |     30 | SALES      | CHICAGO  |</span><br><span class="line">|      4 |  7654 | MARTIN | SALESMAN  | 7698 | 1400.00 | 1250.00 |     30 |     30 | SALES      | CHICAGO  |</span><br><span class="line">|      6 |  7900 | JAMES  | CLERK     | 7698 |    NULL |  950.00 |     30 |     30 | SALES      | CHICAGO  |</span><br><span class="line">+<span class="comment">--------+-------+--------+-----------+------+---------+---------+--------+--------+------------+----------+</span></span><br><span class="line">14 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>查询每个部门工资最高的员工的详细信息，包括其部门编号、部门名称和部门所在地<br>演示：<code>select * from (select rank() over(partition by deptno order by sal desc) as sal_no,empno,ename,job,mgr,comm,sal,deptno from emp ) as t natural left outer join dept d where sal_no=1;</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from (select rank() over(partition by deptno order by sal desc) as sal_no,empno,ename,job,mgr,comm,sal,deptno from emp ) as t natural left outer join dept d where sal_no=1;</span><br><span class="line">+<span class="comment">--------+--------+-------+-------+-----------+------+------+---------+------------+----------+</span></span><br><span class="line">| deptno | sal_no | empno | ename | job       | mgr  | comm | sal     | dname      | loc      |</span><br><span class="line">+<span class="comment">--------+--------+-------+-------+-----------+------+------+---------+------------+----------+</span></span><br><span class="line">|     10 |      1 |  7839 | KING  | PRESIDENT | NULL | NULL | 5000.00 | ACCOUNTING | NEW YORK |</span><br><span class="line">|     20 |      1 |  7788 | SCOTT | ANALYST   | 7566 | NULL | 3000.00 | RESEARCH   | DALLAS   |</span><br><span class="line">|     20 |      1 |  7902 | FORD  | ANALYST   | 7566 | NULL | 3000.00 | RESEARCH   | DALLAS   |</span><br><span class="line">|     30 |      1 |  7698 | BLAKE | MANAGER   | 7839 | NULL | 2850.00 | SALES      | CHICAGO  |</span><br><span class="line">+<span class="comment">--------+--------+-------+-------+-----------+------+------+---------+------------+----------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>本节就到这里，MySQL8.0还新增了很多功能，下一节继续学习。</p>
<font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>


      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="../../../../categories/数据库/">数据库</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/MySQL数据库/">MySQL数据库</a></li></ul>

      
        <div id="donation_div"></div>

<script src="../../../../js/vdonate.js"></script>
<script>
var a = new Donate({
  title: '攒点银子，买本狗粮!', // 可选参数，打赏标题
  btnText: '打赏支持', // 可选参数，打赏按钮文字
  el: document.getElementById('donation_div'),
  wechatImage: 'http://p83c9zj44.bkt.clouddn.com/WeCahtQR.jpg',
  alipayImage: 'http://p83c9zj44.bkt.clouddn.com/AlipayQR.jpg'
});
</script>
      
            
      
        
	<div id="comment">
		<!-- 来必力City版安装代码 -->
		<div id="lv-container" data-id="city" data-uid="MTAyMC8zNjI2NC8xMjc5OQ==">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
		</div>
		<!-- City版安装代码已完成 -->
	</div>


      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="../../31/MySQL8.0：Go连接MySQL/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          MySQL8.0：Go连接MySQL
        
      </div>
    </a>
  
  
    <a href="../../29/MySQL8.0 简单查询/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">MySQL8.0：查询数据--简单查询</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    
      <ol class="nav"><li class="nav-item nav-level-5"><a class="nav-link" href="#整理：房玉辉"><span class="nav-number">1.</span> <span class="nav-text">整理：房玉辉</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#博客：https-ElonJelinek-github-io"><span class="nav-number">2.</span> <span class="nav-text">博客：https://ElonJelinek.github.io</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#聚合函数"><span class="nav-number"></span> <span class="nav-text">聚合函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分组查询"><span class="nav-number"></span> <span class="nav-text">分组查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#分组后限定查询"><span class="nav-number"></span> <span class="nav-text">分组后限定查询</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分页查询"><span class="nav-number"></span> <span class="nav-text">分页查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#内置函数"><span class="nav-number"></span> <span class="nav-text">内置函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#字符串函数"><span class="nav-number"></span> <span class="nav-text">字符串函数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#多表查询"><span class="nav-number"></span> <span class="nav-text">多表查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#左外连接"><span class="nav-number"></span> <span class="nav-text">左外连接</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#左外自然"><span class="nav-number">0.1.</span> <span class="nav-text">左外自然</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#右外连接"><span class="nav-number"></span> <span class="nav-text">右外连接</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#右外自然"><span class="nav-number">0.1.</span> <span class="nav-text">右外自然</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#自连接"><span class="nav-number"></span> <span class="nav-text">自连接</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#子查询"><span class="nav-number"></span> <span class="nav-text">子查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#窗口函数"><span class="nav-number"></span> <span class="nav-text">窗口函数</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#综合运用"><span class="nav-number">0.1.</span> <span class="nav-text">综合运用</span></a></li></ol></li></ol>
    
    </div>
  </aside>
</section>
        
      </div>
      <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2018 早行人 All Rights Reserved.
          
            <span id="busuanzi_container_site_uv">
              访客数<span id="busuanzi_value_site_uv"></span>人次
              总访问量<span id="busuanzi_value_site_pv"></span>次
            </span>
          
      </div>
      <div style="display: inline;margin-left: 50px;">
        <a href="http://www.miitbeian.gov.cn/" target="_blank">粤ICP备18140657号-1</a>
      </div>
      <div class="site-credit" style="display: inline;">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hiero" target="_blank">hiero</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var contentdiv = document.getElementById("content");

    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
</script>

<!-- Custome JS -->
<script src="../../../../js/my.js"></script>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="../../../../index.html" class="mobile-nav-link">Home</a>
  
    <a href="../../../../archives" class="mobile-nav-link">Archives</a>
  
    <a href="../../../../categories" class="mobile-nav-link">Categories</a>
  
    <a href="../../../../tags" class="mobile-nav-link">Tags</a>
  
    <a href="../../../../about" class="mobile-nav-link">About</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="../../../../fancybox/jquery.fancybox.css">
  <script src="../../../../fancybox/jquery.fancybox.pack.js"></script>


<script src="../../../../js/scripts.js"></script>
<script src="../../../../js/bootstrap.js"></script>
<script src="../../../../js/main.js"></script>







  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
