<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>商山早行人</title>
  
  <subtitle>房玉辉区块链博客</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-09-26T10:24:50.215Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>房玉辉</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>MySQL慢查询</title>
    <link href="http://yoursite.com/2018/08/01/MySQL%E6%85%A2%E6%9F%A5%E8%AF%A2/"/>
    <id>http://yoursite.com/2018/08/01/MySQL慢查询/</id>
    <published>2018-08-01T11:19:10.000Z</published>
    <updated>2018-09-26T10:24:50.215Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><p>查看MySQL慢查询的时间上限：<code>show variables like &quot;long%&quot;;</code><br>查看慢查询是否开启：<code>show variables like &quot;slow%&quot;;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like <span class="string">"long%"</span>;</span><br><span class="line">+-----------------+-----------+</span><br><span class="line">| Variable_name   | Value     |</span><br><span class="line">+-----------------+-----------+</span><br><span class="line">| long_query_time | <span class="number">10.000000</span> |</span><br><span class="line">+-----------------+-----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.06</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show variables like <span class="string">"slow%"</span>;</span><br><span class="line">+---------------------+-------------------------------------------+</span><br><span class="line">| Variable_name       | Value                                     |</span><br><span class="line">+---------------------+-------------------------------------------+</span><br><span class="line">| slow_launch_time    | <span class="number">2</span>                                         |</span><br><span class="line">| slow_query_log      | OFF                                       |</span><br><span class="line">| slow_query_log_file | /usr/local/<span class="keyword">var</span>/mysql/ElonJelinek-slow.log |</span><br><span class="line">+---------------------+-------------------------------------------+</span><br><span class="line"><span class="number">3</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p><code>long_query_time</code>的默认值为10秒，表示超过10秒的查询就写入慢查询日志，这个时间可以修改，如果设置为0，表示记录所有的查询。<br><code>slow_query_log</code>的值有两个，OFF和ON，OFF表示关闭日志记录，ON表示开启日志记录，默认为关闭。<br><code>slow_query_log_file</code>的值表示慢查询日志的存放位置，和慢查询日志的文件名。<br><code>slow_launch_time</code>的默认值为2秒，这个字段与创建线程有关，如果创建线程的时间超过2秒，MySQL就会增加一个字段<code>Slow_launch_threads</code>。</p><h5 id="设置慢查询时间"><a href="#设置慢查询时间" class="headerlink" title="设置慢查询时间"></a>设置慢查询时间</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like <span class="string">"long%"</span>;</span><br><span class="line">+-----------------+-----------+</span><br><span class="line">| Variable_name   | Value     |</span><br><span class="line">+-----------------+-----------+</span><br><span class="line">| long_query_time | <span class="number">10.000000</span> |</span><br><span class="line">+-----------------+-----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; set global long_query_time=<span class="number">5</span>;</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show variables like <span class="string">"long%"</span>;</span><br><span class="line">+-----------------+-----------+</span><br><span class="line">| Variable_name   | Value     |</span><br><span class="line">+-----------------+-----------+</span><br><span class="line">| long_query_time | <span class="number">10.000000</span> |</span><br><span class="line">+-----------------+-----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; exit</span><br></pre></td></tr></table></figure><p>这里其实已经更改成功了，但是再次查看，发现时间还是10，是因为更改后需要重启MySQL，或者退出MySQL，再重新进入，再来看，已经变成了5</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like <span class="string">"long%"</span>;</span><br><span class="line">+-----------------+----------+</span><br><span class="line">| Variable_name   | Value    |</span><br><span class="line">+-----------------+----------+</span><br><span class="line">| long_query_time | <span class="number">5.000000</span> |</span><br><span class="line">+-----------------+----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h5 id="打开日志记录"><a href="#打开日志记录" class="headerlink" title="打开日志记录"></a>打开日志记录</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; set global slow_query_log=on;</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show variables like <span class="string">"slow%"</span>;</span><br><span class="line">+---------------------+-------------------------------------------+</span><br><span class="line">| Variable_name       | Value                                     |</span><br><span class="line">+---------------------+-------------------------------------------+</span><br><span class="line">| slow_launch_time    | <span class="number">2</span>                                         |</span><br><span class="line">| slow_query_log      | ON                                        |</span><br><span class="line">| slow_query_log_file | /usr/local/<span class="keyword">var</span>/mysql/ElonJelinek-slow.log |</span><br><span class="line">+---------------------+-------------------------------------------+</span><br><span class="line"><span class="number">3</span> rows in set (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>这里更改后<code>slow_query_log</code>的值直接就变成了ON，这样，查询时间超过5秒的查询语句，就会被写进慢查询日志。</p><p>慢查询时间不宜设置过长，否则意义不大，对于一般web程序来说，一个SQL语句的执行时间超过1秒，就算慢的了。如果某条SQL语句经常查询慢那基本可以判断是可以再次优化的。</p><p>打开慢查询可能会对系统性能有些影响。</p><h5 id="show命令"><a href="#show命令" class="headerlink" title="show命令"></a>show命令</h5><p>show命令用来查看MySQL状态及变量，找到系统瓶颈。</p><p>下面四个命令，在MySQL中输入</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  显示状态信息（扩展show status like 'XXX'）</span></span><br><span class="line">Mysql&gt; show status;</span><br><span class="line"><span class="comment">//  显示系统变量（扩展show variables like 'XXX'）</span></span><br><span class="line">Mysql&gt; show variables;</span><br><span class="line"><span class="comment">//  显示InnoDB存储引擎的状态</span></span><br><span class="line">Mysql&gt; show engine innodb status;</span><br><span class="line"><span class="comment">//  查看当前SQL执行，包括执行状态、是否锁表等</span></span><br><span class="line">Mysql&gt; show processlist;</span><br></pre></td></tr></table></figure><p>innodb存储引擎状态部分信息</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show engine innodb status;</span><br><span class="line"></span><br><span class="line">（……………………省略…………………）</span><br><span class="line"></span><br><span class="line">LOG</span><br><span class="line">---</span><br><span class="line">Log sequence number          <span class="number">20011557</span></span><br><span class="line">Log buffer assigned up to    <span class="number">20011557</span></span><br><span class="line">Log buffer completed up to   <span class="number">20011557</span></span><br><span class="line">Log written up to            <span class="number">20011557</span></span><br><span class="line">Log flushed up to            <span class="number">20011557</span></span><br><span class="line">Added dirty pages up to      <span class="number">20011557</span></span><br><span class="line">Pages flushed up to          <span class="number">20011557</span></span><br><span class="line">Last checkpoint at           <span class="number">20011557</span></span><br><span class="line"><span class="number">11</span> log i/o<span class="string">'s done, 0.00 log i/o'</span>s/second</span><br><span class="line">----------------------</span><br><span class="line">BUFFER POOL AND MEMORY</span><br><span class="line">----------------------</span><br><span class="line">Total large memory allocated <span class="number">137428992</span></span><br><span class="line">Dictionary memory allocated <span class="number">380672</span></span><br><span class="line">Buffer pool size   <span class="number">8192</span></span><br><span class="line">Free buffers       <span class="number">7130</span></span><br><span class="line">Database pages     <span class="number">1058</span></span><br><span class="line">Old database pages <span class="number">410</span></span><br><span class="line">Modified db pages  <span class="number">0</span></span><br><span class="line">Pending reads      <span class="number">0</span></span><br><span class="line">Pending writes: LRU <span class="number">0</span>, flush list <span class="number">0</span>, single page <span class="number">0</span></span><br><span class="line">Pages made young <span class="number">0</span>, not young <span class="number">0</span></span><br><span class="line"><span class="number">0.00</span> youngs/s, <span class="number">0.00</span> non-youngs/s</span><br><span class="line">Pages read <span class="number">926</span>, created <span class="number">132</span>, written <span class="number">139</span></span><br><span class="line"><span class="number">0.00</span> reads/s, <span class="number">0.00</span> creates/s, <span class="number">0.00</span> writes/s</span><br><span class="line">No buffer pool page gets since the last printout</span><br><span class="line">Pages read ahead <span class="number">0.00</span>/s, evicted without access <span class="number">0.00</span>/s, Random read ahead <span class="number">0.00</span>/s</span><br><span class="line">LRU <span class="built_in">len</span>: <span class="number">1058</span>, unzip_LRU <span class="built_in">len</span>: <span class="number">0</span></span><br><span class="line">I/O sum[<span class="number">0</span>]:cur[<span class="number">0</span>], unzip sum[<span class="number">0</span>]:cur[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">（……………………省略…………………）</span><br></pre></td></tr></table></figure><p>下面两个命令直接在终端中输入<br><code>mysqladmin variables -u username -p password</code><br><code>mysqladmin extended-status -u username -p password</code></p><p>示例</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  显示系统变量</span></span><br><span class="line">Shell&gt; mysqladmin variables -h <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> -u Tom -p</span><br><span class="line"><span class="comment">//  显示状态信息</span></span><br><span class="line">Shell&gt; mysqladmin extended-status -h <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> -u Tom -p</span><br></pre></td></tr></table></figure><h5 id="MySQL慢查询日志分析工具"><a href="#MySQL慢查询日志分析工具" class="headerlink" title="MySQL慢查询日志分析工具"></a>MySQL慢查询日志分析工具</h5><p>mysqldumpslow是MySQL自带的慢查询日志分析工具，直接在终端查看其使用帮助</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ mysqldumpslow -h</span><br><span class="line">Option h requires an argument</span><br><span class="line">ERROR: bad option</span><br><span class="line"></span><br><span class="line">Usage: mysqldumpslow [ OPTS... ] [ LOGS... ]</span><br><span class="line"></span><br><span class="line">Parse and summarize the MySQL slow query log. Options are</span><br><span class="line"></span><br><span class="line">  --verbose    verbose</span><br><span class="line">  --debug      debug</span><br><span class="line">  --help       write this text to standard output</span><br><span class="line"></span><br><span class="line">  -v           verbose</span><br><span class="line">  -d           debug</span><br><span class="line">  -s ORDER     what to sort by (al, at, ar, c, l, r, t), <span class="string">'at'</span> is <span class="keyword">default</span></span><br><span class="line">                al: average lock time</span><br><span class="line">                ar: average rows sent</span><br><span class="line">                at: average query time</span><br><span class="line">                 c: count</span><br><span class="line">                 l: lock time</span><br><span class="line">                 r: rows sent</span><br><span class="line">                 t: query time  </span><br><span class="line">  -r           reverse the sort order (largest last instead of first)</span><br><span class="line">  -t NUM       just show the top n queries</span><br><span class="line">  -a           don<span class="string">'t abstract all numbers to N and strings to '</span>S<span class="string">'</span></span><br><span class="line"><span class="string">  -n NUM       abstract numbers with at least n digits within names</span></span><br><span class="line"><span class="string">  -g PATTERN   grep: only consider stmts that include this string</span></span><br><span class="line"><span class="string">  -h HOSTNAME  hostname of db server for *-slow.log filename (can be wildcard),</span></span><br><span class="line"><span class="string">               default is '</span>*<span class="string">', i.e. match all</span></span><br><span class="line"><span class="string">  -i NAME      name of server instance (if using mysql.server startup script)</span></span><br><span class="line"><span class="string">  -l           don'</span>t subtract lock time from total time</span><br><span class="line"></span><br><span class="line">ElonJelinek:~ ElonJelinek$</span><br></pre></td></tr></table></figure><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="数据库" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="MySQL数据库" scheme="http://yoursite.com/tags/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>MySQL8.0：Go连接MySQL</title>
    <link href="http://yoursite.com/2018/07/31/MySQL8.0%EF%BC%9AGo%E8%BF%9E%E6%8E%A5MySQL/"/>
    <id>http://yoursite.com/2018/07/31/MySQL8.0：Go连接MySQL/</id>
    <published>2018-07-31T13:20:00.000Z</published>
    <updated>2018-09-09T02:45:52.636Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><p>go连接MySQL需要使用第三方包：<code>github.com/Go-SQL-Driver/MySQL</code>，因此，首先下载这个包，打开终端，输入：<code>go get github.com/Go-SQL-Driver/MySQL</code>，这个包就会被下载到gopath的src/github.com目录下。</p><h2 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h2><p>打开数据库，使用open()函数：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db, err := sql.Open(<span class="string">"mysql"</span>, <span class="string">"用户名:密码@tcp(IP:端口)/数据库?charset=utf8"</span>)</span><br></pre></td></tr></table></figure><p>示例：<code>db, err := sql.Open(&quot;mysql&quot;, &quot;Tom:456789@tcp(127.0.0.1:3306)/mysql2018?charset=utf8&quot;)</code></p><h2 id="增删改查"><a href="#增删改查" class="headerlink" title="增删改查"></a>增删改查</h2><h4 id="添加数据"><a href="#添加数据" class="headerlink" title="添加数据"></a>添加数据</h4><p>第一种方法：直接使用三方库的Exec()函数添加</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(db *DB)</span> <span class="title">Exec</span><span class="params">(query <span class="keyword">string</span>, args ...<span class="keyword">interface</span>&#123;&#125;)</span> <span class="params">(Result, error)</span></span></span><br></pre></td></tr></table></figure><p>示例：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result, err := db.Exec(<span class="string">"INSERT INTO userinfo (username, departname, created) VALUES (?, ?, ?)"</span>,<span class="string">"lily"</span>,<span class="string">"销售"</span>,<span class="string">"2016-06-21"</span>)</span><br></pre></td></tr></table></figure><p>返回的result是个接口，里面有两个函数，第一个LastInsertId()用来查看最近插入的数据的ID，第二个RowsAffected()用来查看本次插入对原表的影响有几行，也就是插入了几行数据。<br>其中，LastInsertId()函数只支持查询字段属性为自增长的ID。</p><p>完整示例：<br>这里加载的驱动是匿名的，限定其别名为<code>_</code>，所以整个代码中没有一个可见的MySQL包名。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"database/sql"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">_ <span class="string">"github.com/Go-SQL-Driver/MySQL"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">db, err := sql.Open(<span class="string">"mysql"</span>, <span class="string">"Tom:456789@tcp(127.0.0.1:3306)/mysql2018?charset=utf8"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"打开数据库失败："</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">result, err := db.Exec(<span class="string">"INSERT INTO students (StudentID, name, age, sex, username) VALUES (?, ?, ?, ?, ?)"</span>, <span class="number">9565</span>, <span class="string">"总钻风"</span>, <span class="number">29</span>, <span class="string">"男"</span>, <span class="string">"巡山"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"exec失败"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rows, _ := result.RowsAffected()</span><br><span class="line">insertId, _ := result.LastInsertId()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"result失败"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fmt.Println(<span class="string">"成功插入："</span>, rows, <span class="string">"行。"</span>)</span><br><span class="line">fmt.Println(<span class="string">"插入数据的ID："</span>, insertId)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">成功插入： <span class="number">1</span> 行。</span><br><span class="line">插入数据的ID： <span class="number">9565</span></span><br></pre></td></tr></table></figure><p>在终端查看：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from students;</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9556</span> | Lily      |   <span class="number">21</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9561</span> | 飞流      |   <span class="number">17</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9562</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9563</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9565</span> | 总钻风    |   <span class="number">29</span> | 男   | 巡山     | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">7</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><hr><p>第二种方法：首先使用Prepare()函数获得stmt，然后调用Exec添加</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(db *DB)</span> <span class="title">Prepare</span><span class="params">(query <span class="keyword">string</span>)</span> <span class="params">(*Stmt, error)</span></span></span><br></pre></td></tr></table></figure><p>示例代码：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">stmt, err := db.Prepare(<span class="string">"INSERT userinfo SET username=?,departname=?,created=?"</span>)</span><br><span class="line"></span><br><span class="line">result, err := stmt.Exec(<span class="string">"zhja"</span>, <span class="string">"研发"</span>, <span class="string">"2016-06-17"</span>)</span><br></pre></td></tr></table></figure><p>查看影响的行数，以判断是否插入成功：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">count, err := result.RowsAffected()</span><br></pre></td></tr></table></figure><p>获得刚刚添加数据的自增ID：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id, err := result.LastInsertId()</span><br></pre></td></tr></table></figure><p>完整示例：在mysql2018数据库的emp表中插入一条数据，用<a href="mailto:Tom@127.0.0.1" target="_blank" rel="noopener">Tom@127.0.0.1</a>用户进行登录，操作</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"database/sql"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">_ <span class="string">"github.com/Go-SQL-Driver/MySQL"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">db, err := sql.Open(<span class="string">"mysql"</span>, <span class="string">"Tom:456789@tcp(127.0.0.1:3306)/mysql2018?charset=utf8"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"打开数据库失败"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stmt, err1 := db.Prepare(<span class="string">"INSERT INTO emp(empno,ename,job,hiredate,sal) values(?,?,?,?,?)"</span>)</span><br><span class="line"><span class="keyword">if</span> err1 != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"Prepare 失败！"</span>, err1)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rest, err2 := stmt.Exec(<span class="number">9599</span>, <span class="string">"小钻风"</span>, <span class="string">"巡山"</span>, <span class="string">"2018-04-21"</span>, <span class="number">30.8</span>)</span><br><span class="line"><span class="keyword">if</span> err2 != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"插入数据失败"</span>, err2)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">count, _ := rest.RowsAffected()</span><br><span class="line">fmt.Println(<span class="string">"影响的行数"</span>, count)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">影响的行数 <span class="number">1</span></span><br></pre></td></tr></table></figure><p>在终端打开MySQL查询一下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp;</span><br><span class="line">+-------+-----------+-----------+------+---------------------+---------+---------+--------+</span><br><span class="line">| empno | ename     | job       | mgr  | hiredate            | sal     | comm    | deptno |</span><br><span class="line">+-------+-----------+-----------+------+---------------------+---------+---------+--------+</span><br><span class="line">|  <span class="number">7369</span> | SMITH     | CLERK     | <span class="number">7902</span> | <span class="number">1980</span><span class="number">-12</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">800.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN     | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1600.00</span> |  <span class="number">300.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7521</span> | WARD      | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-22</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> |  <span class="number">500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7566</span> | JONES     | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-04</span><span class="number">-02</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2975.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7654</span> | MARTIN    | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-28</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> | <span class="number">1400.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7698</span> | BLAKE     | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-05</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2850.00</span> |    NULL |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7782</span> | CLARK     | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-06</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2450.00</span> |    NULL |     <span class="number">10</span> |</span><br><span class="line">|  <span class="number">7788</span> | SCOTT     | ANALYST   | <span class="number">7566</span> | <span class="number">1982</span><span class="number">-12</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7839</span> | KING      | PRESIDENT | NULL | <span class="number">1981</span><span class="number">-11</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">5000.00</span> |    NULL |     <span class="number">10</span> |</span><br><span class="line">|  <span class="number">7844</span> | TURNER    | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-08</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1500.00</span> |    <span class="number">0.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS     | CLERK     | <span class="number">7788</span> | <span class="number">1983</span><span class="number">-01</span><span class="number">-12</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1100.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7900</span> | JAMES     | CLERK     | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">950.00</span> |    NULL |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7902</span> | FORD      | ANALYST   | <span class="number">7566</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7934</span> | MILLER    | CLERK     | <span class="number">7782</span> | <span class="number">1982</span><span class="number">-01</span><span class="number">-23</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1300.00</span> |    NULL |     <span class="number">10</span> |</span><br><span class="line">|  <span class="number">9599</span> | 小钻风    | 巡山      | NULL | <span class="number">2018</span><span class="number">-04</span><span class="number">-21</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |   <span class="number">30.80</span> |    NULL |   NULL |</span><br><span class="line">+-------+-----------+-----------+------+---------------------+---------+---------+--------+</span><br><span class="line"><span class="number">15</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>插入成功。</p><h4 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h4><p>查询一条数据：调用函数QueryRow()，再调用Scan()函数将查询结果进行保存</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(db *DB)</span> <span class="title">QueryRow</span><span class="params">(query <span class="keyword">string</span>, args ...<span class="keyword">interface</span>&#123;&#125;)</span> *<span class="title">Row</span></span></span><br></pre></td></tr></table></figure><p>保存结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *Row)</span> <span class="title">Scan</span><span class="params">(dest ...<span class="keyword">interface</span>&#123;&#125;)</span> <span class="title">error</span></span></span><br></pre></td></tr></table></figure><p>完整代码：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"database/sql"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">_ <span class="string">"github.com/Go-SQL-Driver/MySQL"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">db, err := sql.Open(<span class="string">"mysql"</span>, <span class="string">"Tom:456789@tcp(127.0.0.1:3306)/mysql2018?charset=utf8"</span>)</span><br><span class="line"><span class="keyword">defer</span> db.Close()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"打开数据库失败："</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> StudentID <span class="keyword">int</span></span><br><span class="line"><span class="keyword">var</span> name <span class="keyword">string</span></span><br><span class="line"><span class="keyword">var</span> age <span class="keyword">string</span></span><br><span class="line"><span class="keyword">var</span> sex <span class="keyword">string</span></span><br><span class="line"><span class="keyword">var</span> username <span class="keyword">string</span></span><br><span class="line"><span class="keyword">var</span> password <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line">row := db.QueryRow(<span class="string">"select * from students where name=?"</span>, <span class="string">"飞流"</span>)</span><br><span class="line">err1 := row.Scan(&amp;StudentID, &amp;name, &amp;age, &amp;sex, &amp;username, &amp;password)</span><br><span class="line"><span class="keyword">if</span> err1 != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"获取失败："</span>, err1)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(StudentID, name, age, sex, username, password)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">9561</span> 飞流 <span class="number">17</span> 男  <span class="number">123456</span></span><br></pre></td></tr></table></figure><hr><p>查询多条数据：直接调用函数Query()获取数据，再调用函数Next()遍历数据。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(db *DB)</span> <span class="title">Query</span><span class="params">(query <span class="keyword">string</span>, args ...<span class="keyword">interface</span>&#123;&#125;)</span> <span class="params">(*Rows, error)</span></span></span><br></pre></td></tr></table></figure><p>遍历：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(rs *Rows)</span> <span class="title">Next</span><span class="params">()</span> <span class="title">bool</span></span></span><br></pre></td></tr></table></figure><p>完整示例：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"database/sql"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">_ <span class="string">"github.com/Go-SQL-Driver/MySQL"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Emp <span class="keyword">struct</span> &#123;</span><br><span class="line">empno    <span class="keyword">int</span></span><br><span class="line">ename    <span class="keyword">string</span></span><br><span class="line">job      <span class="keyword">string</span></span><br><span class="line">hiredate <span class="keyword">string</span></span><br><span class="line">salary   <span class="keyword">float64</span></span><br><span class="line">deptno   <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">db, err := sql.Open(<span class="string">"mysql"</span>, <span class="string">"Tom:456789@tcp(127.0.0.1:3306)/mysql2018?charset=utf8"</span>)</span><br><span class="line"><span class="keyword">defer</span> db.Close()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"打开数据库失败："</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">rows, err1 := db.Query(<span class="string">"select empno,ename,job,hiredate,sal,deptno from emp where deptno=?"</span>, <span class="number">20</span>)</span><br><span class="line"><span class="keyword">defer</span> rows.Close()</span><br><span class="line"><span class="keyword">if</span> err1 != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"查询失败"</span>, err1)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">datas := <span class="built_in">make</span>([] Emp, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> rows.Next() &#123;</span><br><span class="line"><span class="keyword">var</span> empno <span class="keyword">int</span></span><br><span class="line"><span class="keyword">var</span> ename <span class="keyword">string</span></span><br><span class="line"><span class="keyword">var</span> job <span class="keyword">string</span></span><br><span class="line"><span class="keyword">var</span> hiredate <span class="keyword">string</span></span><br><span class="line"><span class="keyword">var</span> salary <span class="keyword">float64</span></span><br><span class="line"><span class="keyword">var</span> deptno <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> err2 := rows.Scan(&amp;empno, &amp;ename, &amp;job, &amp;hiredate, &amp;salary, &amp;deptno); err2 != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"获取失败"</span>, err2)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">emp := Emp&#123;empno, ename, job, hiredate, salary, deptno&#125;</span><br><span class="line">datas = <span class="built_in">append</span>(datas, emp)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _, value := <span class="keyword">range</span> datas &#123;</span><br><span class="line">fmt.Println(value)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="number">7369</span> SMITH CLERK <span class="number">1980</span><span class="number">-12</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="number">800</span> <span class="number">20</span>&#125;</span><br><span class="line">&#123;<span class="number">7566</span> JONES MANAGER <span class="number">1981</span><span class="number">-04</span><span class="number">-02</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="number">2975</span> <span class="number">20</span>&#125;</span><br><span class="line">&#123;<span class="number">7788</span> SCOTT ANALYST <span class="number">1982</span><span class="number">-12</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="number">3000</span> <span class="number">20</span>&#125;</span><br><span class="line">&#123;<span class="number">7876</span> ADAMS CLERK <span class="number">1983</span><span class="number">-01</span><span class="number">-12</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="number">1100</span> <span class="number">20</span>&#125;</span><br><span class="line">&#123;<span class="number">7902</span> FORD ANALYST <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="number">3000</span> <span class="number">20</span>&#125;</span><br></pre></td></tr></table></figure><h4 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h4><p>完整示例：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"database/sql"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">_ <span class="string">"github.com/Go-SQL-Driver/MySQL"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">db, err := sql.Open(<span class="string">"mysql"</span>, <span class="string">"Tom:456789@tcp(127.0.0.1:3306)/mysql2018?charset=utf8"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"打开数据库失败"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stmt, err1 := db.Prepare(<span class="string">"update emp set mgr=?,sal=?,comm=?,deptno=? where empno=?"</span>)</span><br><span class="line"><span class="keyword">if</span> err1 != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"Prepare 失败！"</span>, err1)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rest, err2 := stmt.Exec(<span class="number">7934</span>, <span class="number">1100</span>, <span class="number">0</span>,<span class="number">40</span>, <span class="number">9599</span>)</span><br><span class="line"><span class="keyword">if</span> err2 != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"执行失败"</span>, err2)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">count, _ := rest.RowsAffected()</span><br><span class="line">fmt.Println(<span class="string">"影响的行数"</span>, count)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">影响的行数 <span class="number">1</span></span><br></pre></td></tr></table></figure><h4 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h4><p>完整示例：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"database/sql"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">_ <span class="string">"github.com/Go-SQL-Driver/MySQL"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">db, err := sql.Open(<span class="string">"mysql"</span>, <span class="string">"Tom:456789@tcp(127.0.0.1:3306)/mysql2018?charset=utf8"</span>)</span><br><span class="line"><span class="keyword">defer</span> db.Close()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"连接数据库失败："</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stmt, err := db.Prepare(<span class="string">"delete from emp where ename=?"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res, err := stmt.Exec(<span class="string">"总钻风"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"删除失败"</span>)</span><br><span class="line">&#125;</span><br><span class="line">num, err := res.RowsAffected()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"查询rows失败"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fmt.Println(<span class="string">"影响的行数："</span>,num,<span class="string">"行。"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">影响的行数： <span class="number">1</span> 行。</span><br></pre></td></tr></table></figure><p>这里的修改和删除操作都比较简单，只要修改<code>func (db *DB) Prepare(query string) (*Stmt, error)</code>函数里面的sql语句，和修改<code>func (s *Stmt) Exec(args ...interface{}) (Result, error)</code>函数里面的参数就可以了。</p><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="数据库" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="MySQL数据库" scheme="http://yoursite.com/tags/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>MySQL8.0：复杂查询</title>
    <link href="http://yoursite.com/2018/07/30/MySQL8.0%EF%BC%9A%E5%A4%8D%E6%9D%82%E6%9F%A5%E8%AF%A2/"/>
    <id>http://yoursite.com/2018/07/30/MySQL8.0：复杂查询/</id>
    <published>2018-07-30T11:10:00.000Z</published>
    <updated>2018-09-17T03:02:07.304Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><h2 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h2><p>MySQL聚合函数也叫分组函数或多行函数，接收多个输入，返回一个输出，包括</p><p>求和：<code>sum()</code><br>求最大值：<code>max()</code><br>求最小值：<code>min()</code><br>求平均值：<code>avg()</code><br>统计：<code>count()</code></p><p>聚合函数经常搭配<code>group by</code>或<code>having</code>一起使用，接下来一一学习一下他们的用法</p><p>求和：<code>sum(列名)</code>    用来对不是null的值进行求和<br>演示：<code>select sum(sal) from emp;</code>      表示求所有员工的月薪之和<br>演示：<code>select sum(comm) from emp;</code>     表示求所有员工的奖金之和</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> sum(sal) from emp;</span><br><span class="line">+----------+</span><br><span class="line">| sum(sal) |</span><br><span class="line">+----------+</span><br><span class="line">| <span class="number">29025.00</span> |</span><br><span class="line">+----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> sum(comm) from emp;</span><br><span class="line">+-----------+</span><br><span class="line">| sum(comm) |</span><br><span class="line">+-----------+</span><br><span class="line">|   <span class="number">2200.00</span> |</span><br><span class="line">+-----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>求最大值：<code>max(列名)</code>      用来计算不是null的值得最大值<br>演示：<code>select max(sal) from emp;</code>      查询最高月薪<br>演示：<code>select max(comm) as 最高奖金 from emp;</code>     查询最高奖金</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> max(sal) from emp;</span><br><span class="line">+----------+</span><br><span class="line">| max(sal) |</span><br><span class="line">+----------+</span><br><span class="line">|  <span class="number">5000.00</span> |</span><br><span class="line">+----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> max(comm) as 最高奖金 from emp;</span><br><span class="line">+--------------+</span><br><span class="line">| 最高奖金     |</span><br><span class="line">+--------------+</span><br><span class="line">|      <span class="number">1400.00</span> |</span><br><span class="line">+--------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>求平均值：<code>avg(列名)</code>  用来计算不是null的值的平均值<br>演示：<code>select avg(sal) as 平均工资 from emp;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> avg(sal) as 平均工资 from emp;</span><br><span class="line">+--------------+</span><br><span class="line">| 平均工资     |</span><br><span class="line">+--------------+</span><br><span class="line">|  <span class="number">2073.214286</span> |</span><br><span class="line">+--------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>统计函数：<code>count(列名)</code>    统计某列总共有多少条记录<br>演示：<code>select count(*) from emp;</code>      统计总共有多少条记录<br>演示：<code>select count(comm) from emp;</code>   统计有奖金的人数</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> count(*) from emp;</span><br><span class="line">+----------+</span><br><span class="line">| count(*) |</span><br><span class="line">+----------+</span><br><span class="line">|       <span class="number">14</span> |</span><br><span class="line">+----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> count(comm) from emp;</span><br><span class="line">+-------------+</span><br><span class="line">| count(comm) |</span><br><span class="line">+-------------+</span><br><span class="line">|           <span class="number">4</span> |</span><br><span class="line">+-------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h2><p>group by 列名，按照指定的列进行分组，值相同的在一起，但是，group by 单独使用的意义不大，例如：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select deptno from emp group by deptno;</span><br><span class="line">+<span class="comment">--------+</span></span><br><span class="line">| deptno |</span><br><span class="line">+<span class="comment">--------+</span></span><br><span class="line">|     20 |</span><br><span class="line">|     30 |</span><br><span class="line">|     10 |</span><br><span class="line">+<span class="comment">--------+</span></span><br><span class="line">3 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> deptno,sal <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno,sal;</span><br><span class="line">+<span class="comment">--------+---------+</span></span><br><span class="line">| deptno | sal     |</span><br><span class="line">+<span class="comment">--------+---------+</span></span><br><span class="line">|     20 |  800.00 |</span><br><span class="line">|     30 | 1600.00 |</span><br><span class="line">|     30 | 1250.00 |</span><br><span class="line">|     20 | 2975.00 |</span><br><span class="line">|     30 | 2850.00 |</span><br><span class="line">|     10 | 2450.00 |</span><br><span class="line">|     20 | 3000.00 |</span><br><span class="line">|     10 | 5000.00 |</span><br><span class="line">|     30 | 1500.00 |</span><br><span class="line">|     20 | 1100.00 |</span><br><span class="line">|     30 |  950.00 |</span><br><span class="line">|     10 | 1300.00 |</span><br><span class="line">+<span class="comment">--------+---------+</span></span><br><span class="line">12 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>因此group by 的主要用法是配合聚合函数来使用，比如下面这样</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),avg(sal),min(sal),sum(sal),count(sal) from emp group by deptno;</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line">| deptno | max(sal) | avg(sal)    | min(sal) | sum(sal) | count(sal) |</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">3000.00</span> | <span class="number">2175.000000</span> |   <span class="number">800.00</span> | <span class="number">10875.00</span> |          <span class="number">5</span> |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> | <span class="number">1566.666667</span> |   <span class="number">950.00</span> |  <span class="number">9400.00</span> |          <span class="number">6</span> |</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">5000.00</span> | <span class="number">2916.666667</span> |  <span class="number">1300.00</span> |  <span class="number">8750.00</span> |          <span class="number">3</span> |</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line"><span class="number">3</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>也可以在分组之后，再加上排序，下面是用部门编号进行排序</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),avg(sal),min(sal),sum(sal),count(sal) from emp group by deptno order by deptno;</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line">| deptno | max(sal) | avg(sal)    | min(sal) | sum(sal) | count(sal) |</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">5000.00</span> | <span class="number">2916.666667</span> |  <span class="number">1300.00</span> |  <span class="number">8750.00</span> |          <span class="number">3</span> |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">3000.00</span> | <span class="number">2175.000000</span> |   <span class="number">800.00</span> | <span class="number">10875.00</span> |          <span class="number">5</span> |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> | <span class="number">1566.666667</span> |   <span class="number">950.00</span> |  <span class="number">9400.00</span> |          <span class="number">6</span> |</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line"><span class="number">3</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>按部门平均工资进行排序</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),avg(sal),min(sal),sum(sal),count(sal) from emp group by deptno order by avg(sal);</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line">| deptno | max(sal) | avg(sal)    | min(sal) | sum(sal) | count(sal) |</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> | <span class="number">1566.666667</span> |   <span class="number">950.00</span> |  <span class="number">9400.00</span> |          <span class="number">6</span> |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">3000.00</span> | <span class="number">2175.000000</span> |   <span class="number">800.00</span> | <span class="number">10875.00</span> |          <span class="number">5</span> |</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">5000.00</span> | <span class="number">2916.666667</span> |  <span class="number">1300.00</span> |  <span class="number">8750.00</span> |          <span class="number">3</span> |</span><br><span class="line">+--------+----------+-------------+----------+----------+------------+</span><br><span class="line"><span class="number">3</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>上面的几个例子是以部门为单位进行分组，再统计各个部门的最高工资，平均工资，最低工资，工资之和，以及各个部门的员工人数。之后再按部门编号或者平均工资进行排序。</p><hr><p>还可以先使用where对原始数据进行筛选，之后再通过group by进行分组，再使用聚合函数统计个部门工资情况，例如下面这个例子：<br>首先排除每个部门月薪低于1000元的人员，之后再统计各部门的最高工资，平均工资，工资之和，对统计结果以部门编号进行排序</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),avg(sal),sum(sal) from emp where sal &gt;= <span class="number">1000</span> group by deptno order by deptno;</span><br><span class="line">+--------+----------+-------------+----------+</span><br><span class="line">| deptno | max(sal) | avg(sal)    | sum(sal) |</span><br><span class="line">+--------+----------+-------------+----------+</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">5000.00</span> | <span class="number">2916.666667</span> |  <span class="number">8750.00</span> |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">3000.00</span> | <span class="number">2518.750000</span> | <span class="number">10075.00</span> |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> | <span class="number">1690.000000</span> |  <span class="number">8450.00</span> |</span><br><span class="line">+--------+----------+-------------+----------+</span><br><span class="line"><span class="number">3</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h4 id="分组后限定查询"><a href="#分组后限定查询" class="headerlink" title="分组后限定查询"></a>分组后限定查询</h4><p>having子句：在分组后再对数据进行筛选，需要使用having子句来完成</p><p>语法：<code>select 列名 from 表名 group by 列名 having 条件;</code><br>演示：<code>select mgr from emp group by mgr having mgr is not null;</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select mgr from emp group by mgr;</span><br><span class="line">+<span class="comment">------+</span></span><br><span class="line">| mgr  |</span><br><span class="line">+<span class="comment">------+</span></span><br><span class="line">| 7902 |</span><br><span class="line">| 7698 |</span><br><span class="line">| 7839 |</span><br><span class="line">| 7566 |</span><br><span class="line">| NULL |</span><br><span class="line">| 7788 |</span><br><span class="line">| 7782 |</span><br><span class="line">+<span class="comment">------+</span></span><br><span class="line">7 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> mgr <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> mgr <span class="keyword">having</span> mgr <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>;</span><br><span class="line">+<span class="comment">------+</span></span><br><span class="line">| mgr  |</span><br><span class="line">+<span class="comment">------+</span></span><br><span class="line">| 7902 |</span><br><span class="line">| 7698 |</span><br><span class="line">| 7839 |</span><br><span class="line">| 7566 |</span><br><span class="line">| 7788 |</span><br><span class="line">| 7782 |</span><br><span class="line">+<span class="comment">------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><hr><p>更复杂一些的查询，按部门统计各部门的最高工资，以及部门工资之和，并挑选出工资之和小于1万元的，再按部门编号进行排序<br>按部门统计各部门的最高工资，各部门工资之和，并挑选出部门编号大于10的，再按部门编号进行排序</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),sum(sal) from emp group by deptno having sum(sal) &lt; <span class="number">10000</span>;</span><br><span class="line">+--------+----------+----------+</span><br><span class="line">| deptno | max(sal) | sum(sal) |</span><br><span class="line">+--------+----------+----------+</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> |  <span class="number">9400.00</span> |</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">5000.00</span> |  <span class="number">8750.00</span> |</span><br><span class="line">+--------+----------+----------+</span><br><span class="line"><span class="number">2</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),sum(sal) from emp group by deptno having sum(sal) &lt; <span class="number">10000</span> order by deptno;</span><br><span class="line">+--------+----------+----------+</span><br><span class="line">| deptno | max(sal) | sum(sal) |</span><br><span class="line">+--------+----------+----------+</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">5000.00</span> |  <span class="number">8750.00</span> |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> |  <span class="number">9400.00</span> |</span><br><span class="line">+--------+----------+----------+</span><br><span class="line"><span class="number">2</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),sum(sal) from emp group by deptno having deptno &gt; <span class="number">10</span> order by deptno; </span><br><span class="line">+--------+----------+----------+</span><br><span class="line">| deptno | max(sal) | sum(sal) |</span><br><span class="line">+--------+----------+----------+</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">3000.00</span> | <span class="number">10875.00</span> |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> |  <span class="number">9400.00</span> |</span><br><span class="line">+--------+----------+----------+</span><br><span class="line"><span class="number">2</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>还可以在where之后，再跟着使用group by和having，例如：<br>首先排除每个部门工资低于1000元的员工，再按部门统计各部门的最高工资，平均工资，工资之和，再挑选出部门编号大于10的部门，筛选结果以部门编号进行排序</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> deptno,max(sal),avg(sal),sum(sal) from emp where sal &gt;= <span class="number">1000</span> group by deptno having deptno &gt; <span class="number">10</span> order by deptno ;</span><br><span class="line">+--------+----------+-------------+----------+</span><br><span class="line">| deptno | max(sal) | avg(sal)    | sum(sal) |</span><br><span class="line">+--------+----------+-------------+----------+</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">3000.00</span> | <span class="number">2518.750000</span> | <span class="number">10075.00</span> |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">2850.00</span> | <span class="number">1690.000000</span> |  <span class="number">8450.00</span> |</span><br><span class="line">+--------+----------+-------------+----------+</span><br><span class="line"><span class="number">2</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>having子句的作用是对group by分组后的结果，进行再次筛选，其与where语句的区别如下：</p><ol><li>where和having后面都是跟条件</li><li>where是对表中的数据进行原始筛选</li><li>having是对group by的结果的二次筛选</li><li>having必须配合group by使用，一般也配合聚合函数使用</li><li>可以先有where，后面跟着group by和having</li><li>where是先过滤再分组，having是先分组再过滤</li><li>如果有order by 排序的，order by一般放在最后。</li></ol><h2 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h2><p>limit子句：用于限定查询结果的起始行，以及总行数</p><p>语法：<code>select 列名 from 表名 limit start，count;</code><br>这里的start表示查询结果的起始行，表示从start➕1行开始，count表示总行数。<br>演示：<code>select * from emp limit 0,3;</code>   表示从第1行开始，查询3行。<br>演示：<code>select * from emp limit 13,3;</code>  表示从第14行开始，查询3行。<br>演示：<code>select * from emp limit 14,3;</code>  表示从第15行开始，查询3行。由于没有第15行，所以查询结果为空。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp limit <span class="number">0</span>,<span class="number">3</span>;</span><br><span class="line">+-------+-------+----------+------+---------------------+---------+--------+--------+</span><br><span class="line">| empno | ename | job      | mgr  | hiredate            | sal     | comm   | deptno |</span><br><span class="line">+-------+-------+----------+------+---------------------+---------+--------+--------+</span><br><span class="line">|  <span class="number">7369</span> | SMITH | CLERK    | <span class="number">7902</span> | <span class="number">1980</span><span class="number">-12</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">800.00</span> |   NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1600.00</span> | <span class="number">300.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7521</span> | WARD  | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-22</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> | <span class="number">500.00</span> |     <span class="number">30</span> |</span><br><span class="line">+-------+-------+----------+------+---------------------+---------+--------+--------+</span><br><span class="line"><span class="number">3</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from emp limit <span class="number">13</span>,<span class="number">3</span>;</span><br><span class="line">+-------+--------+-------+------+---------------------+---------+------+--------+</span><br><span class="line">| empno | ename  | job   | mgr  | hiredate            | sal     | comm | deptno |</span><br><span class="line">+-------+--------+-------+------+---------------------+---------+------+--------+</span><br><span class="line">|  <span class="number">7934</span> | MILLER | CLERK | <span class="number">7782</span> | <span class="number">1982</span><span class="number">-01</span><span class="number">-23</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1300.00</span> | NULL |     <span class="number">10</span> |</span><br><span class="line">+-------+--------+-------+------+---------------------+---------+------+--------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from emp limit <span class="number">14</span>,<span class="number">3</span>;</span><br><span class="line">Empty set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="内置函数"><a href="#内置函数" class="headerlink" title="内置函数"></a>内置函数</h2><h4 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h4><p>查看字符的ASCII编码：<code>select ascii(&#39;a&#39;);</code>   字符串空串返回0<br>查看ASCII编码对应的字符：<code>select char(97);</code>   编码0返回空字符串<br>字符串拼接：<code>select concat(12,34,&#39;ab&#39;);</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> ascii(<span class="string">'');</span></span><br><span class="line"><span class="string">+-----------+</span></span><br><span class="line"><span class="string">| ascii('</span><span class="string">') |</span></span><br><span class="line"><span class="string">+-----------+</span></span><br><span class="line"><span class="string">|         0 |</span></span><br><span class="line"><span class="string">+-----------+</span></span><br><span class="line"><span class="string">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt; select char(0);</span></span><br><span class="line"><span class="string">+---------+</span></span><br><span class="line"><span class="string">| char(0) |</span></span><br><span class="line"><span class="string">+---------+</span></span><br><span class="line"><span class="string">|         |</span></span><br><span class="line"><span class="string">+---------+</span></span><br><span class="line"><span class="string">1 row in set (0.01 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt; select ascii('</span>a<span class="string">');</span></span><br><span class="line"><span class="string">+------------+</span></span><br><span class="line"><span class="string">| ascii('</span>a<span class="string">') |</span></span><br><span class="line"><span class="string">+------------+</span></span><br><span class="line"><span class="string">|         97 |</span></span><br><span class="line"><span class="string">+------------+</span></span><br><span class="line"><span class="string">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt; select char(97);</span></span><br><span class="line"><span class="string">+----------+</span></span><br><span class="line"><span class="string">| char(97) |</span></span><br><span class="line"><span class="string">+----------+</span></span><br><span class="line"><span class="string">| a        |</span></span><br><span class="line"><span class="string">+----------+</span></span><br><span class="line"><span class="string">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt; select concat(12,34,'</span>ab<span class="string">');</span></span><br><span class="line"><span class="string">+--------------------+</span></span><br><span class="line"><span class="string">| concat(12,34,'</span>ab<span class="string">') |</span></span><br><span class="line"><span class="string">+--------------------+</span></span><br><span class="line"><span class="string">| 1234ab             |</span></span><br><span class="line"><span class="string">+--------------------+</span></span><br><span class="line"><span class="string">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt;</span></span><br></pre></td></tr></table></figure><p>包含字符个数length(str)   str包含几个字符<br>截取字符串left(str,count)    返回str左端count个字符<br>截取字符串right(str,count)   返回str右端count个字符</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> length(name) from students;</span><br><span class="line">+--------------+</span><br><span class="line">| length(name) |</span><br><span class="line">+--------------+</span><br><span class="line">|            <span class="number">4</span> |</span><br><span class="line">|            <span class="number">9</span> |</span><br><span class="line">|            <span class="number">9</span> |</span><br><span class="line">|            <span class="number">6</span> |</span><br><span class="line">|            <span class="number">9</span> |</span><br><span class="line">|            <span class="number">9</span> |</span><br><span class="line">+--------------+</span><br><span class="line"><span class="number">6</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> left(name,<span class="number">2</span>) from students;</span><br><span class="line">+--------------+</span><br><span class="line">| left(name,<span class="number">2</span>) |</span><br><span class="line">+--------------+</span><br><span class="line">| Li           |</span><br><span class="line">| 梅长         |</span><br><span class="line">| 穆霓         |</span><br><span class="line">| 飞流         |</span><br><span class="line">| 萧景         |</span><br><span class="line">| 萧景         |</span><br><span class="line">+--------------+</span><br><span class="line"><span class="number">6</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> right(name,<span class="number">2</span>) from students;</span><br><span class="line">+---------------+</span><br><span class="line">| right(name,<span class="number">2</span>) |</span><br><span class="line">+---------------+</span><br><span class="line">| ly            |</span><br><span class="line">| 长苏          |</span><br><span class="line">| 霓凰          |</span><br><span class="line">| 飞流          |</span><br><span class="line">| 景琰          |</span><br><span class="line">| 景琰          |</span><br><span class="line">+---------------+</span><br><span class="line"><span class="number">6</span> rows in set (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>除此之外，substring()，ltrim()，rtrim()，trim()，space()，replace()，lower()，upper()等函数，用法都很简单，就不一一列举了。</p><p>另外MySQL还提供了数学函数，时间日期函数，这里也不在列举。下面重点学习多表查询。</p><h2 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h2><p>一张表的数据不够，需要其他表的数据来补充，需要同时对多张表进行查询，例如：<br>查询部门不在accounting和sales中的员工信息</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp e,dept d where e.deptno=d.deptno and dname!= <span class="string">"accounting"</span> and  dname != <span class="string">"sales"</span>;</span><br><span class="line">+-------+-------+---------+------+---------------------+---------+------+--------+--------+----------+--------+</span><br><span class="line">| empno | ename | job     | mgr  | hiredate            | sal     | comm | deptno | deptno | dname    | loc    |</span><br><span class="line">+-------+-------+---------+------+---------------------+---------+------+--------+--------+----------+--------+</span><br><span class="line">|  <span class="number">7369</span> | SMITH | CLERK   | <span class="number">7902</span> | <span class="number">1980</span><span class="number">-12</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">800.00</span> | NULL |     <span class="number">20</span> |     <span class="number">20</span> | RESEARCH | DALLAS |</span><br><span class="line">|  <span class="number">7566</span> | JONES | MANAGER | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-04</span><span class="number">-02</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2975.00</span> | NULL |     <span class="number">20</span> |     <span class="number">20</span> | RESEARCH | DALLAS |</span><br><span class="line">|  <span class="number">7788</span> | SCOTT | ANALYST | <span class="number">7566</span> | <span class="number">1982</span><span class="number">-12</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> | NULL |     <span class="number">20</span> |     <span class="number">20</span> | RESEARCH | DALLAS |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS | CLERK   | <span class="number">7788</span> | <span class="number">1983</span><span class="number">-01</span><span class="number">-12</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1100.00</span> | NULL |     <span class="number">20</span> |     <span class="number">20</span> | RESEARCH | DALLAS |</span><br><span class="line">|  <span class="number">7902</span> | FORD  | ANALYST | <span class="number">7566</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> | NULL |     <span class="number">20</span> |     <span class="number">20</span> | RESEARCH | DALLAS |</span><br><span class="line">+-------+-------+---------+------+---------------------+---------+------+--------+--------+----------+--------+</span><br><span class="line"><span class="number">5</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p><img src="http://p83c9zj44.bkt.clouddn.com/mysql%E5%A4%9A%E8%A1%A8%E8%81%94%E6%9F%A5.jpeg" alt=""><br>除上面这样对多张表进行连接查询外，还有左外连接、右外连接以及自然连接等查询方法，需要使用join关键字，进行连接</p><h4 id="左外连接"><a href="#左外连接" class="headerlink" title="左外连接"></a>左外连接</h4><p>左表记录无论是否满足条件都会查询出来，而右表只有满足条件才能查询出来，左表中不满足条件的记录，右表部分都为null</p><p>语法：<code>select * from 表1 别名1 left outer join 表2 别名2 on 别名1.xx=别名2.xx</code><br>演示：<code>select empno,ename,job,sal,comm,d.deptno,d.dname from emp as e left outer join dept as d on e.deptno=d.deptno;</code><br>这里的两个as都可以省略</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> empno,ename,job,sal,comm,d.deptno,d.dname from emp as e left outer join dept as d on e.deptno=d.deptno;</span><br><span class="line">+-------+--------+-----------+---------+---------+--------+------------+</span><br><span class="line">| empno | ename  | job       | sal     | comm    | deptno | dname      |</span><br><span class="line">+-------+--------+-----------+---------+---------+--------+------------+</span><br><span class="line">|  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">2450.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING |</span><br><span class="line">|  <span class="number">7839</span> | KING   | PRESIDENT | <span class="number">5000.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING |</span><br><span class="line">|  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">1300.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING |</span><br><span class="line">|  <span class="number">7369</span> | SMITH  | CLERK     |  <span class="number">800.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   |</span><br><span class="line">|  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">2975.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   |</span><br><span class="line">|  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">1100.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   |</span><br><span class="line">|  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">1600.00</span> |  <span class="number">300.00</span> |     <span class="number">30</span> | SALES      |</span><br><span class="line">|  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">1250.00</span> |  <span class="number">500.00</span> |     <span class="number">30</span> | SALES      |</span><br><span class="line">|  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">1250.00</span> | <span class="number">1400.00</span> |     <span class="number">30</span> | SALES      |</span><br><span class="line">|  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">2850.00</span> |    NULL |     <span class="number">30</span> | SALES      |</span><br><span class="line">|  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">1500.00</span> |    <span class="number">0.00</span> |     <span class="number">30</span> | SALES      |</span><br><span class="line">|  <span class="number">7900</span> | JAMES  | CLERK     |  <span class="number">950.00</span> |    NULL |     <span class="number">30</span> | SALES      |</span><br><span class="line">+-------+--------+-----------+---------+---------+--------+------------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h6 id="左外自然"><a href="#左外自然" class="headerlink" title="左外自然"></a>左外自然</h6><p>以emp表和dept表为例：查询所有员工的工号、姓名、工作、月薪、奖金、部门编号，以及部门名称、所在城市。<br>显然，这些信息一部分在emp表中，一部分在dept表中，所以必须对两张表进行连接查询，才能得到所有信息。</p><p>语法：<code>select * from 表1 别名1 natural left outer join 表2 别名2;</code><br>演示：<code>select * from emp e natural left outer join dept d;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp e natural left outer join dept d;</span><br><span class="line">+--------+-------+--------+-----------+------+---------------------+---------+---------+------------+----------+</span><br><span class="line">| deptno | empno | ename  | job       | mgr  | hiredate            | sal     | comm    | dname      | loc      |</span><br><span class="line">+--------+-------+--------+-----------+------+---------------------+---------+---------+------------+----------+</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-06</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2450.00</span> |    NULL | ACCOUNTING | NEW YORK |</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">1981</span><span class="number">-11</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">5000.00</span> |    NULL | ACCOUNTING | NEW YORK |</span><br><span class="line">|     <span class="number">10</span> |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1982</span><span class="number">-01</span><span class="number">-23</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1300.00</span> |    NULL | ACCOUNTING | NEW YORK |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> | <span class="number">1980</span><span class="number">-12</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">800.00</span> |    NULL | RESEARCH   | DALLAS   |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-04</span><span class="number">-02</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2975.00</span> |    NULL | RESEARCH   | DALLAS   |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">1982</span><span class="number">-12</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> |    NULL | RESEARCH   | DALLAS   |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1983</span><span class="number">-01</span><span class="number">-12</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1100.00</span> |    NULL | RESEARCH   | DALLAS   |</span><br><span class="line">|     <span class="number">20</span> |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> |    NULL | RESEARCH   | DALLAS   |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1600.00</span> |  <span class="number">300.00</span> | SALES      | CHICAGO  |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-22</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> |  <span class="number">500.00</span> | SALES      | CHICAGO  |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-28</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> | <span class="number">1400.00</span> | SALES      | CHICAGO  |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-05</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2850.00</span> |    NULL | SALES      | CHICAGO  |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-08</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1500.00</span> |    <span class="number">0.00</span> | SALES      | CHICAGO  |</span><br><span class="line">|     <span class="number">30</span> |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">950.00</span> |    NULL | SALES      | CHICAGO  |</span><br><span class="line">+--------+-------+--------+-----------+------+---------------------+---------+---------+------------+----------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>可见，左外自然连接查询，两张表的重复字段会被放到查询结果的第一列，其余的不变。<br><img src="http://p83c9zj44.bkt.clouddn.com/mysqlMySQL%E5%B7%A6%E5%A4%96%E8%87%AA%E7%84%B6.jpeg" alt=""></p><h4 id="右外连接"><a href="#右外连接" class="headerlink" title="右外连接"></a>右外连接</h4><p>右表记录无论是否满足条件都会查询出来，而左表只有满足条件才能查询出来。右表中不满足条件的记录，左表部分都为null。</p><p>语法：<code>select * from 表1 别名1 right outer join 表2 别名2 on 别名1.xx=别名2.xx;</code><br>演示：<code>select empno,ename,job,mgr,sal,comm,e.deptno,dname,loc from emp e right outer join dept d on e.deptno=d.deptno;</code><br>或者：<code>select empno,ename,job,mgr,sal,comm,d.deptno,dname,loc from emp e right outer join dept d on e.deptno=d.deptno;</code><br>或者：<code>select empno,ename,job,mgr,sal,comm,emp.deptno,dname,loc from emp right outer join dept on emp.deptno=dept.deptno;</code><br>或者：<code>select empno,ename,job,mgr,sal,comm,d.deptno,d.dname,d.loc from emp e right outer join dept d on e.deptno=d.deptno;</code><br>两张表中都有的字段，必须要写成<code>表名.字段名</code>或者<code>别名.字段名</code>，否则会报错。比如deptno字段，两张表中都有，所以必须要写成<code>d.deptno</code>或者<code>e.deptno</code>。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> empno,ename,job,mgr,sal,comm,e.deptno,dname,loc from emp e right outer join dept d on e.deptno=d.deptno;</span><br><span class="line">+-------+--------+-----------+------+---------+---------+--------+------------+----------+</span><br><span class="line">| empno | ename  | job       | mgr  | sal     | comm    | deptno | dname      | loc      |</span><br><span class="line">+-------+--------+-----------+------+---------+---------+--------+------------+----------+</span><br><span class="line">|  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> |  <span class="number">800.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1600.00</span> |  <span class="number">300.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |  <span class="number">500.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">2975.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> | <span class="number">1400.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |    NULL |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">2450.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">5000.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1500.00</span> |    <span class="number">0.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1100.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> |  <span class="number">950.00</span> |    NULL |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1300.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  NULL | NULL   | NULL      | NULL |    NULL |    NULL |   NULL | OPERATIONS | BOSTON   |</span><br><span class="line">+-------+--------+-----------+------+---------+---------+--------+------------+----------+</span><br><span class="line"><span class="number">15</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p><img src="http://p83c9zj44.bkt.clouddn.com/mysqlmysql%E5%8F%B3%E5%A4%96%E8%BF%9E%E6%8E%A5.jpeg" alt=""></p><h6 id="右外自然"><a href="#右外自然" class="headerlink" title="右外自然"></a>右外自然</h6><p>语法：<code>select * from 表1 别名1 natural right outer join 表2 别名2;</code><br>演示：<code>select * from emp natural right outer join dept;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp natural right outer join dept;</span><br><span class="line">+--------+------------+----------+-------+--------+-----------+------+---------------------+---------+---------+</span><br><span class="line">| deptno | dname      | loc      | empno | ename  | job       | mgr  | hiredate            | sal     | comm    |</span><br><span class="line">+--------+------------+----------+-------+--------+-----------+------+---------------------+---------+---------+</span><br><span class="line">|     <span class="number">20</span> | RESEARCH   | DALLAS   |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> | <span class="number">1980</span><span class="number">-12</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">800.00</span> |    NULL |</span><br><span class="line">|     <span class="number">30</span> | SALES      | CHICAGO  |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1600.00</span> |  <span class="number">300.00</span> |</span><br><span class="line">|     <span class="number">30</span> | SALES      | CHICAGO  |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-22</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> |  <span class="number">500.00</span> |</span><br><span class="line">|     <span class="number">20</span> | RESEARCH   | DALLAS   |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-04</span><span class="number">-02</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2975.00</span> |    NULL |</span><br><span class="line">|     <span class="number">30</span> | SALES      | CHICAGO  |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-28</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> | <span class="number">1400.00</span> |</span><br><span class="line">|     <span class="number">30</span> | SALES      | CHICAGO  |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-05</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2850.00</span> |    NULL |</span><br><span class="line">|     <span class="number">10</span> | ACCOUNTING | NEW YORK |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-06</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2450.00</span> |    NULL |</span><br><span class="line">|     <span class="number">20</span> | RESEARCH   | DALLAS   |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">1982</span><span class="number">-12</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> |    NULL |</span><br><span class="line">|     <span class="number">10</span> | ACCOUNTING | NEW YORK |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">1981</span><span class="number">-11</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">5000.00</span> |    NULL |</span><br><span class="line">|     <span class="number">30</span> | SALES      | CHICAGO  |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-08</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1500.00</span> |    <span class="number">0.00</span> |</span><br><span class="line">|     <span class="number">20</span> | RESEARCH   | DALLAS   |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1983</span><span class="number">-01</span><span class="number">-12</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1100.00</span> |    NULL |</span><br><span class="line">|     <span class="number">30</span> | SALES      | CHICAGO  |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">950.00</span> |    NULL |</span><br><span class="line">|     <span class="number">20</span> | RESEARCH   | DALLAS   |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> |    NULL |</span><br><span class="line">|     <span class="number">10</span> | ACCOUNTING | NEW YORK |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1982</span><span class="number">-01</span><span class="number">-23</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1300.00</span> |    NULL |</span><br><span class="line">|     <span class="number">40</span> | OPERATIONS | BOSTON   |  NULL | NULL   | NULL      | NULL | NULL                |    NULL |    NULL |</span><br><span class="line">+--------+------------+----------+-------+--------+-----------+------+---------------------+---------+---------+</span><br><span class="line"><span class="number">15</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p><img src="http://p83c9zj44.bkt.clouddn.com/mysqlMySQL%E5%8F%B3%E5%A4%96%E8%87%AA%E7%84%B6.jpeg" alt=""></p><p>演示：<code>select empno,ename,job,sal,comm,e.deptno,dname,loc from emp e natural right outer join dept d;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> empno,ename,job,sal,comm,e.deptno,dname,loc from emp e natural right outer join dept d;</span><br><span class="line">+-------+--------+-----------+---------+---------+--------+------------+----------+</span><br><span class="line">| empno | ename  | job       | sal     | comm    | deptno | dname      | loc      |</span><br><span class="line">+-------+--------+-----------+---------+---------+--------+------------+----------+</span><br><span class="line">|  <span class="number">7369</span> | SMITH  | CLERK     |  <span class="number">800.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">1600.00</span> |  <span class="number">300.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">1250.00</span> |  <span class="number">500.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">2975.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">1250.00</span> | <span class="number">1400.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">2850.00</span> |    NULL |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">2450.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7839</span> | KING   | PRESIDENT | <span class="number">5000.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">1500.00</span> |    <span class="number">0.00</span> |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">1100.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7900</span> | JAMES  | CLERK     |  <span class="number">950.00</span> |    NULL |     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">1300.00</span> |    NULL |     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|  NULL | NULL   | NULL      |    NULL |    NULL |   NULL | OPERATIONS | BOSTON   |</span><br><span class="line">+-------+--------+-----------+---------+---------+--------+------------+----------+</span><br><span class="line"><span class="number">15</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h4 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h4><p>自连接就是一张表连接自己</p><p>语法：<code>select 别名1.字段1,别名1.字段2,别名1.字段3,别名2.字段a,别名2.字段b from 表名 as 别名1 left outer join 表名 as 别名2 on 别名1.某字段=别名2.某字段;</code></p><p>从emp表中查询所有员工的编号，姓名，上级领导，及其上级领导的编号和姓名<br>演示：<code>select e.empno,e.ename,e.mgr,m.empno,m.ename from emp as e left outer join emp as m on e.mgr=m.empno;</code><br>这里的两个as都可以省略</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> e.empno,e.ename,e.mgr,m.empno,m.ename from emp as e left outer join emp as m on e.mgr=m.empno;</span><br><span class="line">+-------+--------+------+-------+-------+</span><br><span class="line">| empno | ename  | mgr  | empno | ename |</span><br><span class="line">+-------+--------+------+-------+-------+</span><br><span class="line">|  <span class="number">7788</span> | SCOTT  | <span class="number">7566</span> |  <span class="number">7566</span> | JONES |</span><br><span class="line">|  <span class="number">7902</span> | FORD   | <span class="number">7566</span> |  <span class="number">7566</span> | JONES |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | <span class="number">7698</span> |  <span class="number">7698</span> | BLAKE |</span><br><span class="line">|  <span class="number">7521</span> | WARD   | <span class="number">7698</span> |  <span class="number">7698</span> | BLAKE |</span><br><span class="line">|  <span class="number">7654</span> | MARTIN | <span class="number">7698</span> |  <span class="number">7698</span> | BLAKE |</span><br><span class="line">|  <span class="number">7844</span> | TURNER | <span class="number">7698</span> |  <span class="number">7698</span> | BLAKE |</span><br><span class="line">|  <span class="number">7900</span> | JAMES  | <span class="number">7698</span> |  <span class="number">7698</span> | BLAKE |</span><br><span class="line">|  <span class="number">7934</span> | MILLER | <span class="number">7782</span> |  <span class="number">7782</span> | CLARK |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS  | <span class="number">7788</span> |  <span class="number">7788</span> | SCOTT |</span><br><span class="line">|  <span class="number">7566</span> | JONES  | <span class="number">7839</span> |  <span class="number">7839</span> | KING  |</span><br><span class="line">|  <span class="number">7698</span> | BLAKE  | <span class="number">7839</span> |  <span class="number">7839</span> | KING  |</span><br><span class="line">|  <span class="number">7782</span> | CLARK  | <span class="number">7839</span> |  <span class="number">7839</span> | KING  |</span><br><span class="line">|  <span class="number">7369</span> | SMITH  | <span class="number">7902</span> |  <span class="number">7902</span> | FORD  |</span><br><span class="line">|  <span class="number">7839</span> | KING   | NULL |  NULL | NULL  |</span><br><span class="line">+-------+--------+------+-------+-------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><p>子查询是指sql语句中包含另一个select语句</p><blockquote><p>一条sql语句中，包含多个select关键字<br>外查询，内查询</p></blockquote><p>子查询可以出现的位置：<br>from后面，作为表<br>where后面，作为条件</p><p>注意事项：<br>1、子查询必须在()里；<br>2、在子查询中不能使用order by子句。<br>3、子查询可以再嵌套子查询，最多不超过255层。</p><p>子查询还分为：单行子查询，多行子查询，关联子查询。</p><p>例如：查询工资至少比20部门一个员工高的员工信息</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp  where sal &gt; any(<span class="keyword">select</span> sal from emp where deptno=<span class="number">20</span>);</span><br><span class="line">+-------+--------+-----------+------+---------------------+---------+---------+--------+</span><br><span class="line">| empno | ename  | job       | mgr  | hiredate            | sal     | comm    | deptno |</span><br><span class="line">+-------+--------+-----------+------+---------------------+---------+---------+--------+</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1600.00</span> |  <span class="number">300.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-22</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> |  <span class="number">500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-04</span><span class="number">-02</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2975.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-28</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> | <span class="number">1400.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-05</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2850.00</span> |    NULL |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-06</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2450.00</span> |    NULL |     <span class="number">10</span> |</span><br><span class="line">|  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">1982</span><span class="number">-12</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">1981</span><span class="number">-11</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">5000.00</span> |    NULL |     <span class="number">10</span> |</span><br><span class="line">|  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-08</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1500.00</span> |    <span class="number">0.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1983</span><span class="number">-01</span><span class="number">-12</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1100.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">950.00</span> |    NULL |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1982</span><span class="number">-01</span><span class="number">-23</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1300.00</span> |    NULL |     <span class="number">10</span> |</span><br><span class="line">+-------+--------+-----------+------+---------------------+---------+---------+--------+</span><br><span class="line"><span class="number">13</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>查询工资比20部门所有员工都高的员工信息</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp  where sal &gt; all(<span class="keyword">select</span> sal from emp where deptno=<span class="number">20</span>);</span><br><span class="line">+-------+-------+-----------+------+---------------------+---------+------+--------+</span><br><span class="line">| empno | ename | job       | mgr  | hiredate            | sal     | comm | deptno |</span><br><span class="line">+-------+-------+-----------+------+---------------------+---------+------+--------+</span><br><span class="line">|  <span class="number">7839</span> | KING  | PRESIDENT | NULL | <span class="number">1981</span><span class="number">-11</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">5000.00</span> | NULL |     <span class="number">10</span> |</span><br><span class="line">+-------+-------+-----------+------+---------------------+---------+------+--------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>查询不是领导的员工信息</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp where empno not in(<span class="keyword">select</span> ifnull(mgr,<span class="number">0</span>) from emp);</span><br><span class="line">+-------+--------+----------+------+---------------------+---------+---------+--------+</span><br><span class="line">| empno | ename  | job      | mgr  | hiredate            | sal     | comm    | deptno |</span><br><span class="line">+-------+--------+----------+------+---------------------+---------+---------+--------+</span><br><span class="line">|  <span class="number">7369</span> | SMITH  | CLERK    | <span class="number">7902</span> | <span class="number">1980</span><span class="number">-12</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">800.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1600.00</span> |  <span class="number">300.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7521</span> | WARD   | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-22</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> |  <span class="number">500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7654</span> | MARTIN | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-28</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> | <span class="number">1400.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7844</span> | TURNER | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-08</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1500.00</span> |    <span class="number">0.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS  | CLERK    | <span class="number">7788</span> | <span class="number">1983</span><span class="number">-01</span><span class="number">-12</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1100.00</span> |    NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7900</span> | JAMES  | CLERK    | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">950.00</span> |    NULL |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7934</span> | MILLER | CLERK    | <span class="number">7782</span> | <span class="number">1982</span><span class="number">-01</span><span class="number">-23</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1300.00</span> |    NULL |     <span class="number">10</span> |</span><br><span class="line">+-------+--------+----------+------+---------------------+---------+---------+--------+</span><br><span class="line"><span class="number">8</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="窗口函数"><a href="#窗口函数" class="headerlink" title="窗口函数"></a>窗口函数</h2><p>MySQL8.0新增了窗口函数，over()，row_number()，rank(),dense_rank()函数，以前都是Oracle特有的功能，这里分别看看怎么用</p><p>over()不能单独使用，要和rank()，dense_rank()，row_number()等函数一起使用</p><p>这几个函数都是用来排名和编号，区别在于，rank()的排名会跳号，比如有两个人成绩相同，并列第一名，那么两个第一名之后，紧接着是第三名，而没有第二名，而dense_rank()则是两个第一名之后，紧接着是第二名，这里来查询一下<br>演示：<code>select rank() over(partition by mgr order by sal desc) as sal_no,empno,ename,job,mgr,deptno from emp;</code><br>这里解释下over()函数，<code>over(partition by columnname1 order by columnname2)</code><br>含义：按字段columnname1进行分组，按字段column2进行排名，具体到本例的意思就是，以上级领导的编号进行分组，在每组内以工资进行排名。即把每个部门的员工按工资进行排名</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> rank() over(partition by mgr order by sal desc) as sal_no,empno,ename,job,mgr,sal,deptno from emp; </span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">| sal_no | empno | ename  | job       | mgr  | sal     | deptno |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">5000.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1600.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">5</span> |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> |  <span class="number">950.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1300.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1100.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">2975.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">2450.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> |  <span class="number">800.00</span> |     <span class="number">20</span> |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>用dense_rank()函数排名</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> dense_rank() over(partition by mgr order by sal desc) as sal_no,empno,ename,job,mgr,sal,deptno from emp;</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">| sal_no | empno | ename  | job       | mgr  | sal     | deptno |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">5000.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1600.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">4</span> |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> |  <span class="number">950.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1300.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1100.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">2975.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">2450.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> |  <span class="number">800.00</span> |     <span class="number">20</span> |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>对比两次查询结果发现，使用rank()函数的时候，第三组7698中六个员工的排名是1、2、3、3、5，而使用dense_rank()函数的时候，六个人排名变成了1、2、3、3、4</p><p>接下来再看看row_number()函数，其作用是为每一条记录编号，并且编号不重复，<br>演示：<code>select row_number() over(partition by mgr order by sal) as sal_no,empno,ename,job,mgr,deptno from emp;</code><br>这里的意思是，以上级领导进行分组，以工资进行排序，并按顺序编号，工资相同的，以其他字段排名。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> row_number() over(partition by mgr order by sal desc) as sal_no,empno,ename,job,mgr,sal,deptno from emp;</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">| sal_no | empno | ename  | job       | mgr  | sal     | deptno |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">5000.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1600.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">4</span> |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">5</span> |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> |  <span class="number">950.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1300.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1100.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">2975.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">2450.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> |  <span class="number">800.00</span> |     <span class="number">20</span> |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>以部门分组，并以工资高低排序</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> rank() over(partition by deptno order by sal) as sal_no,empno,ename,job,mgr,sal,deptno from emp;</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">| sal_no | empno | ename  | job       | mgr  | sal     | deptno |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1300.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">2450.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">5000.00</span> |     <span class="number">10</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> |  <span class="number">800.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1100.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">3</span> |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">2975.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">4</span> |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">4</span> |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|      <span class="number">1</span> |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> |  <span class="number">950.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">2</span> |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">4</span> |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">5</span> |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1600.00</span> |     <span class="number">30</span> |</span><br><span class="line">|      <span class="number">6</span> |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |     <span class="number">30</span> |</span><br><span class="line">+--------+-------+--------+-----------+------+---------+--------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>按部门分组，并以工资高低按顺序编号</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> row_number() over(partition by deptno order by sal desc) as dept_no,empno,ename,job,mgr,sal,deptno from emp;</span><br><span class="line">+---------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">| dept_no | empno | ename  | job       | mgr  | sal     | deptno |</span><br><span class="line">+---------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">5000.00</span> |     <span class="number">10</span> |</span><br><span class="line">|       <span class="number">2</span> |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">2450.00</span> |     <span class="number">10</span> |</span><br><span class="line">|       <span class="number">3</span> |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1300.00</span> |     <span class="number">10</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">2</span> |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">3</span> |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">2975.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">4</span> |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1100.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">5</span> |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> |  <span class="number">800.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">2</span> |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1600.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">3</span> |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">4</span> |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">5</span> |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">6</span> |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> |  <span class="number">950.00</span> |     <span class="number">30</span> |</span><br><span class="line">+---------+-------+--------+-----------+------+---------+--------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>找出每个部门工资最高的员工</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> dense_rank() over(partition by deptno order by sal desc) as dept_no,empno,ename,job,mgr,sal,deptno from emp;</span><br><span class="line">+---------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">| dept_no | empno | ename  | job       | mgr  | sal     | deptno |</span><br><span class="line">+---------+-------+--------+-----------+------+---------+--------+</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">5000.00</span> |     <span class="number">10</span> |</span><br><span class="line">|       <span class="number">2</span> |  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">2450.00</span> |     <span class="number">10</span> |</span><br><span class="line">|       <span class="number">3</span> |  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1300.00</span> |     <span class="number">10</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">2</span> |  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">2975.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">3</span> |  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1100.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">4</span> |  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> |  <span class="number">800.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">2</span> |  <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">7698</span> | <span class="number">1600.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">3</span> |  <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">7698</span> | <span class="number">1500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">4</span> |  <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">4</span> |  <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">7698</span> | <span class="number">1250.00</span> |     <span class="number">30</span> |</span><br><span class="line">|       <span class="number">5</span> |  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> |  <span class="number">950.00</span> |     <span class="number">30</span> |</span><br><span class="line">+---------+-------+--------+-----------+------+---------+--------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from ( <span class="keyword">select</span> dense_rank() over(partition by deptno order by sal desc) as dept_no,empno,ename,job,mgr,sal,deptno from emp ) as t where dept_no=<span class="number">1</span>;</span><br><span class="line">+---------+-------+-------+-----------+------+---------+--------+</span><br><span class="line">| dept_no | empno | ename | job       | mgr  | sal     | deptno |</span><br><span class="line">+---------+-------+-------+-----------+------+---------+--------+</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7839</span> | KING  | PRESIDENT | NULL | <span class="number">5000.00</span> |     <span class="number">10</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7788</span> | SCOTT | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7902</span> | FORD  | ANALYST   | <span class="number">7566</span> | <span class="number">3000.00</span> |     <span class="number">20</span> |</span><br><span class="line">|       <span class="number">1</span> |  <span class="number">7698</span> | BLAKE | MANAGER   | <span class="number">7839</span> | <span class="number">2850.00</span> |     <span class="number">30</span> |</span><br><span class="line">+---------+-------+-------+-----------+------+---------+--------+</span><br><span class="line"><span class="number">4</span> rows in set (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h6 id="综合运用"><a href="#综合运用" class="headerlink" title="综合运用"></a>综合运用</h6><p>窗口函数、嵌套查询、外连接的综合运用</p><p>将所有员工以其工资从高到底在部门内排序，查询所有员工的详细信息，包括部门编号、部门名称、和部门所在地<br>演示：<code>select * from (select rank() over(partition by deptno order by sal desc) as sal_no,empno,ename,job,mgr,comm,sal,deptno from emp ) as t left outer join dept d on t.deptno=d.deptno;</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from (select rank() over(partition by deptno order by sal desc) as sal_no,empno,ename,job,mgr,comm,sal,deptno from emp ) as t left outer join dept d on t.deptno=d.deptno;</span><br><span class="line">+<span class="comment">--------+-------+--------+-----------+------+---------+---------+--------+--------+------------+----------+</span></span><br><span class="line">| sal_no | empno | ename  | job       | mgr  | comm    | sal     | deptno | deptno | dname      | loc      |</span><br><span class="line">+<span class="comment">--------+-------+--------+-----------+------+---------+---------+--------+--------+------------+----------+</span></span><br><span class="line">|      1 |  7839 | KING   | PRESIDENT | NULL |    NULL | 5000.00 |     10 |     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|      2 |  7782 | CLARK  | MANAGER   | 7839 |    NULL | 2450.00 |     10 |     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|      3 |  7934 | MILLER | CLERK     | 7782 |    NULL | 1300.00 |     10 |     10 | ACCOUNTING | NEW YORK |</span><br><span class="line">|      1 |  7788 | SCOTT  | ANALYST   | 7566 |    NULL | 3000.00 |     20 |     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|      1 |  7902 | FORD   | ANALYST   | 7566 |    NULL | 3000.00 |     20 |     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|      3 |  7566 | JONES  | MANAGER   | 7839 |    NULL | 2975.00 |     20 |     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|      4 |  7876 | ADAMS  | CLERK     | 7788 |    NULL | 1100.00 |     20 |     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|      5 |  7369 | SMITH  | CLERK     | 7902 |    NULL |  800.00 |     20 |     20 | RESEARCH   | DALLAS   |</span><br><span class="line">|      1 |  7698 | BLAKE  | MANAGER   | 7839 |    NULL | 2850.00 |     30 |     30 | SALES      | CHICAGO  |</span><br><span class="line">|      2 |  7499 | ALLEN  | SALESMAN  | 7698 |  300.00 | 1600.00 |     30 |     30 | SALES      | CHICAGO  |</span><br><span class="line">|      3 |  7844 | TURNER | SALESMAN  | 7698 |    0.00 | 1500.00 |     30 |     30 | SALES      | CHICAGO  |</span><br><span class="line">|      4 |  7521 | WARD   | SALESMAN  | 7698 |  500.00 | 1250.00 |     30 |     30 | SALES      | CHICAGO  |</span><br><span class="line">|      4 |  7654 | MARTIN | SALESMAN  | 7698 | 1400.00 | 1250.00 |     30 |     30 | SALES      | CHICAGO  |</span><br><span class="line">|      6 |  7900 | JAMES  | CLERK     | 7698 |    NULL |  950.00 |     30 |     30 | SALES      | CHICAGO  |</span><br><span class="line">+<span class="comment">--------+-------+--------+-----------+------+---------+---------+--------+--------+------------+----------+</span></span><br><span class="line">14 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p>查询每个部门工资最高的员工的详细信息，包括其部门编号、部门名称和部门所在地<br>演示：<code>select * from (select rank() over(partition by deptno order by sal desc) as sal_no,empno,ename,job,mgr,comm,sal,deptno from emp ) as t natural left outer join dept d where sal_no=1;</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from (select rank() over(partition by deptno order by sal desc) as sal_no,empno,ename,job,mgr,comm,sal,deptno from emp ) as t natural left outer join dept d where sal_no=1;</span><br><span class="line">+<span class="comment">--------+--------+-------+-------+-----------+------+------+---------+------------+----------+</span></span><br><span class="line">| deptno | sal_no | empno | ename | job       | mgr  | comm | sal     | dname      | loc      |</span><br><span class="line">+<span class="comment">--------+--------+-------+-------+-----------+------+------+---------+------------+----------+</span></span><br><span class="line">|     10 |      1 |  7839 | KING  | PRESIDENT | NULL | NULL | 5000.00 | ACCOUNTING | NEW YORK |</span><br><span class="line">|     20 |      1 |  7788 | SCOTT | ANALYST   | 7566 | NULL | 3000.00 | RESEARCH   | DALLAS   |</span><br><span class="line">|     20 |      1 |  7902 | FORD  | ANALYST   | 7566 | NULL | 3000.00 | RESEARCH   | DALLAS   |</span><br><span class="line">|     30 |      1 |  7698 | BLAKE | MANAGER   | 7839 | NULL | 2850.00 | SALES      | CHICAGO  |</span><br><span class="line">+<span class="comment">--------+--------+-------+-------+-----------+------+------+---------+------------+----------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>本节就到这里，MySQL8.0还新增了很多功能，下一节继续学习。</p><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="数据库" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="MySQL数据库" scheme="http://yoursite.com/tags/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>MySQL8.0：查询数据--简单查询</title>
    <link href="http://yoursite.com/2018/07/29/MySQL8.0%20%E7%AE%80%E5%8D%95%E6%9F%A5%E8%AF%A2/"/>
    <id>http://yoursite.com/2018/07/29/MySQL8.0 简单查询/</id>
    <published>2018-07-29T02:10:00.000Z</published>
    <updated>2018-09-01T08:09:19.981Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><h2 id="首先创建三张表："><a href="#首先创建三张表：" class="headerlink" title="首先创建三张表："></a>首先创建三张表：</h2><h4 id="第一张表emp："><a href="#第一张表emp：" class="headerlink" title="第一张表emp："></a>第一张表emp：</h4><p>建表语句：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create table emp (</span><br><span class="line">empno numeric(<span class="number">4</span>) not null,</span><br><span class="line">ename varchar(<span class="number">10</span>),</span><br><span class="line">job varchar(<span class="number">9</span>),</span><br><span class="line">mgr numeric(<span class="number">4</span>),</span><br><span class="line">hiredate datetime,</span><br><span class="line">sal numeric(<span class="number">7</span>, <span class="number">2</span>),</span><br><span class="line">comm numeric(<span class="number">7</span>, <span class="number">2</span>),</span><br><span class="line">deptno numeric(<span class="number">2</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>演示：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create table emp (</span><br><span class="line">    -&gt; empno numeric(<span class="number">4</span>) not null,</span><br><span class="line">    -&gt; ename varchar(<span class="number">10</span>),</span><br><span class="line">    -&gt; job varchar(<span class="number">9</span>),</span><br><span class="line">    -&gt; mgr numeric(<span class="number">4</span>),</span><br><span class="line">    -&gt; hiredate datetime,</span><br><span class="line">    -&gt; sal numeric(<span class="number">7</span>, <span class="number">2</span>),</span><br><span class="line">    -&gt; comm numeric(<span class="number">7</span>, <span class="number">2</span>),</span><br><span class="line">    -&gt; deptno numeric(<span class="number">2</span>)</span><br><span class="line">    -&gt; );</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.06</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>emp表的结构：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; describe emp;</span><br><span class="line">+----------+--------------+------+-----+---------+-------+</span><br><span class="line">| Field    | Type         | Null | Key | Default | Extra |</span><br><span class="line">+----------+--------------+------+-----+---------+-------+</span><br><span class="line">| empno    | decimal(<span class="number">4</span>,<span class="number">0</span>) | NO   |     | NULL    |       |</span><br><span class="line">| ename    | varchar(<span class="number">10</span>)  | YES  |     | NULL    |       |</span><br><span class="line">| job      | varchar(<span class="number">9</span>)   | YES  |     | NULL    |       |</span><br><span class="line">| mgr      | decimal(<span class="number">4</span>,<span class="number">0</span>) | YES  |     | NULL    |       |</span><br><span class="line">| hiredate | datetime     | YES  |     | NULL    |       |</span><br><span class="line">| sal      | decimal(<span class="number">7</span>,<span class="number">2</span>) | YES  |     | NULL    |       |</span><br><span class="line">| comm     | decimal(<span class="number">7</span>,<span class="number">2</span>) | YES  |     | NULL    |       |</span><br><span class="line">| deptno   | decimal(<span class="number">2</span>,<span class="number">0</span>) | YES  |     | NULL    |       |</span><br><span class="line">+----------+--------------+------+-----+---------+-------+</span><br><span class="line"><span class="number">8</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>插入一些数据：</p><p>插入语句：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">insert into emp values (<span class="number">7369</span>, <span class="string">'SMITH'</span>, <span class="string">'CLERK'</span>, <span class="number">7902</span>, <span class="string">'1980-12-17'</span>, <span class="number">800</span>, null, <span class="number">20</span>),</span><br><span class="line">(<span class="number">7499</span>, <span class="string">'ALLEN'</span>, <span class="string">'SALESMAN'</span>, <span class="number">7698</span>, <span class="string">'1981-02-20'</span>, <span class="number">1600</span>, <span class="number">300</span>, <span class="number">30</span>),</span><br><span class="line">(<span class="number">7521</span>, <span class="string">'WARD'</span>, <span class="string">'SALESMAN'</span>, <span class="number">7698</span>, <span class="string">'1981-02-22'</span>, <span class="number">1250</span>, <span class="number">500</span>, <span class="number">30</span>),</span><br><span class="line">(<span class="number">7566</span>, <span class="string">'JONES'</span>, <span class="string">'MANAGER'</span>, <span class="number">7839</span>, <span class="string">'1981-04-02'</span>, <span class="number">2975</span>, null, <span class="number">20</span>),</span><br><span class="line">(<span class="number">7654</span>, <span class="string">'MARTIN'</span>, <span class="string">'SALESMAN'</span>, <span class="number">7698</span>, <span class="string">'1981-09-28'</span>, <span class="number">1250</span>, <span class="number">1400</span>, <span class="number">30</span>),</span><br><span class="line">(<span class="number">7698</span>, <span class="string">'BLAKE'</span>, <span class="string">'MANAGER'</span>, <span class="number">7839</span>, <span class="string">'1981-05-01'</span>, <span class="number">2850</span>, null, <span class="number">30</span>),</span><br><span class="line">(<span class="number">7782</span>, <span class="string">'CLARK'</span>, <span class="string">'MANAGER'</span>, <span class="number">7839</span>, <span class="string">'1981-06-09'</span>, <span class="number">2450</span>, null, <span class="number">10</span>),</span><br><span class="line">(<span class="number">7788</span>, <span class="string">'SCOTT'</span>, <span class="string">'ANALYST'</span>, <span class="number">7566</span>, <span class="string">'1982-12-09'</span>, <span class="number">3000</span>, null, <span class="number">20</span>),</span><br><span class="line">(<span class="number">7839</span>, <span class="string">'KING'</span>, <span class="string">'PRESIDENT'</span>, null, <span class="string">'1981-11-17'</span>, <span class="number">5000</span>, null, <span class="number">10</span>),</span><br><span class="line">(<span class="number">7844</span>, <span class="string">'TURNER'</span>, <span class="string">'SALESMAN'</span>, <span class="number">7698</span>, <span class="string">'1981-09-08'</span>, <span class="number">1500</span>, <span class="number">0</span>, <span class="number">30</span>),</span><br><span class="line">(<span class="number">7876</span>, <span class="string">'ADAMS'</span>, <span class="string">'CLERK'</span>, <span class="number">7788</span>, <span class="string">'1983-01-12'</span>, <span class="number">1100</span>, null, <span class="number">20</span>),</span><br><span class="line">(<span class="number">7900</span>, <span class="string">'JAMES'</span>, <span class="string">'CLERK'</span>, <span class="number">7698</span>, <span class="string">'1981-12-03'</span>, <span class="number">950</span>, null, <span class="number">30</span>),</span><br><span class="line">(<span class="number">7902</span>, <span class="string">'FORD'</span>, <span class="string">'ANALYST'</span>, <span class="number">7566</span>, <span class="string">'1981-12-03'</span>, <span class="number">3000</span>, null, <span class="number">20</span>),</span><br><span class="line">(<span class="number">7934</span>, <span class="string">'MILLER'</span>, <span class="string">'CLERK'</span>, <span class="number">7782</span>, <span class="string">'1982-01-23'</span>, <span class="number">1300</span>, null, <span class="number">10</span>);</span><br></pre></td></tr></table></figure><p>演示：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; insert into emp values (<span class="number">7369</span>, <span class="string">'SMITH'</span>, <span class="string">'CLERK'</span>, <span class="number">7902</span>, <span class="string">'1980-12-17'</span>, <span class="number">800</span>, null, <span class="number">20</span>),</span><br><span class="line">    -&gt; (<span class="number">7499</span>, <span class="string">'ALLEN'</span>, <span class="string">'SALESMAN'</span>, <span class="number">7698</span>, <span class="string">'1981-02-20'</span>, <span class="number">1600</span>, <span class="number">300</span>, <span class="number">30</span>),</span><br><span class="line">    -&gt; (<span class="number">7521</span>, <span class="string">'WARD'</span>, <span class="string">'SALESMAN'</span>, <span class="number">7698</span>, <span class="string">'1981-02-22'</span>, <span class="number">1250</span>, <span class="number">500</span>, <span class="number">30</span>),</span><br><span class="line">    -&gt; (<span class="number">7566</span>, <span class="string">'JONES'</span>, <span class="string">'MANAGER'</span>, <span class="number">7839</span>, <span class="string">'1981-04-02'</span>, <span class="number">2975</span>, null, <span class="number">20</span>),</span><br><span class="line">    -&gt; (<span class="number">7654</span>, <span class="string">'MARTIN'</span>, <span class="string">'SALESMAN'</span>, <span class="number">7698</span>, <span class="string">'1981-09-28'</span>, <span class="number">1250</span>, <span class="number">1400</span>, <span class="number">30</span>),</span><br><span class="line">    -&gt; (<span class="number">7698</span>, <span class="string">'BLAKE'</span>, <span class="string">'MANAGER'</span>, <span class="number">7839</span>, <span class="string">'1981-05-01'</span>, <span class="number">2850</span>, null, <span class="number">30</span>),</span><br><span class="line">    -&gt; (<span class="number">7782</span>, <span class="string">'CLARK'</span>, <span class="string">'MANAGER'</span>, <span class="number">7839</span>, <span class="string">'1981-06-09'</span>, <span class="number">2450</span>, null, <span class="number">10</span>),</span><br><span class="line">    -&gt; (<span class="number">7788</span>, <span class="string">'SCOTT'</span>, <span class="string">'ANALYST'</span>, <span class="number">7566</span>, <span class="string">'1982-12-09'</span>, <span class="number">3000</span>, null, <span class="number">20</span>),</span><br><span class="line">    -&gt; (<span class="number">7839</span>, <span class="string">'KING'</span>, <span class="string">'PRESIDENT'</span>, null, <span class="string">'1981-11-17'</span>, <span class="number">5000</span>, null, <span class="number">10</span>),</span><br><span class="line">    -&gt; (<span class="number">7844</span>, <span class="string">'TURNER'</span>, <span class="string">'SALESMAN'</span>, <span class="number">7698</span>, <span class="string">'1981-09-08'</span>, <span class="number">1500</span>, <span class="number">0</span>, <span class="number">30</span>),</span><br><span class="line">    -&gt; (<span class="number">7876</span>, <span class="string">'ADAMS'</span>, <span class="string">'CLERK'</span>, <span class="number">7788</span>, <span class="string">'1983-01-12'</span>, <span class="number">1100</span>, null, <span class="number">20</span>),</span><br><span class="line">    -&gt; (<span class="number">7900</span>, <span class="string">'JAMES'</span>, <span class="string">'CLERK'</span>, <span class="number">7698</span>, <span class="string">'1981-12-03'</span>, <span class="number">950</span>, null, <span class="number">30</span>),</span><br><span class="line">    -&gt; (<span class="number">7902</span>, <span class="string">'FORD'</span>, <span class="string">'ANALYST'</span>, <span class="number">7566</span>, <span class="string">'1981-12-03'</span>, <span class="number">3000</span>, null, <span class="number">20</span>),</span><br><span class="line">    -&gt; (<span class="number">7934</span>, <span class="string">'MILLER'</span>, <span class="string">'CLERK'</span>, <span class="number">7782</span>, <span class="string">'1982-01-23'</span>, <span class="number">1300</span>, null, <span class="number">10</span>);</span><br><span class="line">Query OK, <span class="number">14</span> rows affected (<span class="number">0.03</span> sec)</span><br><span class="line">Records: <span class="number">14</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h4 id="第二张表dept："><a href="#第二张表dept：" class="headerlink" title="第二张表dept："></a>第二张表dept：</h4><p>建表语句：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table dept (</span><br><span class="line">deptno numeric(<span class="number">2</span>),</span><br><span class="line">dname varchar(<span class="number">14</span>),</span><br><span class="line">loc varchar(<span class="number">13</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>演示：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create table dept (</span><br><span class="line">    -&gt; deptno numeric(<span class="number">2</span>),</span><br><span class="line">    -&gt; dname varchar(<span class="number">14</span>),</span><br><span class="line">    -&gt; loc varchar(<span class="number">13</span>)</span><br><span class="line">    -&gt; );</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.09</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>dept表的结构：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; describe dept;</span><br><span class="line">+--------+--------------+------+-----+---------+-------+</span><br><span class="line">| Field  | Type         | Null | Key | Default | Extra |</span><br><span class="line">+--------+--------------+------+-----+---------+-------+</span><br><span class="line">| deptno | decimal(<span class="number">2</span>,<span class="number">0</span>) | YES  |     | NULL    |       |</span><br><span class="line">| dname  | varchar(<span class="number">14</span>)  | YES  |     | NULL    |       |</span><br><span class="line">| loc    | varchar(<span class="number">13</span>)  | YES  |     | NULL    |       |</span><br><span class="line">+--------+--------------+------+-----+---------+-------+</span><br><span class="line"><span class="number">3</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>插入数据：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">insert into dept values (<span class="number">10</span>, <span class="string">'ACCOUNTING'</span>, <span class="string">'NEW YORK'</span>),</span><br><span class="line">(<span class="number">20</span>, <span class="string">'RESEARCH'</span>, <span class="string">'DALLAS'</span>),</span><br><span class="line">(<span class="number">30</span>, <span class="string">'SALES'</span>, <span class="string">'CHICAGO'</span>),</span><br><span class="line">(<span class="number">40</span>, <span class="string">'OPERATIONS'</span>, <span class="string">'BOSTON'</span>);</span><br></pre></td></tr></table></figure><p>演示：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; insert into dept values (<span class="number">10</span>, <span class="string">'ACCOUNTING'</span>, <span class="string">'NEW YORK'</span>),</span><br><span class="line">    -&gt; (<span class="number">20</span>, <span class="string">'RESEARCH'</span>, <span class="string">'DALLAS'</span>),</span><br><span class="line">    -&gt; (<span class="number">30</span>, <span class="string">'SALES'</span>, <span class="string">'CHICAGO'</span>),</span><br><span class="line">    -&gt; (<span class="number">40</span>, <span class="string">'OPERATIONS'</span>, <span class="string">'BOSTON'</span>);</span><br><span class="line">Query OK, <span class="number">4</span> rows affected (<span class="number">0.17</span> sec)</span><br><span class="line">Records: <span class="number">4</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h4 id="第三张表salgrade："><a href="#第三张表salgrade：" class="headerlink" title="第三张表salgrade："></a>第三张表salgrade：</h4><p>建表语句：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table salgrade (</span><br><span class="line">grade numeric,</span><br><span class="line">losal numeric,</span><br><span class="line">hisal numeric</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>演示：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create table salgrade (</span><br><span class="line">    -&gt; grade numeric,</span><br><span class="line">    -&gt; losal numeric,</span><br><span class="line">    -&gt; hisal numeric</span><br><span class="line">    -&gt; );</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.07</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>插入数据：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">insert into salgrade values (<span class="number">1</span>, <span class="number">700</span>, <span class="number">1200</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="number">1201</span>, <span class="number">1400</span>),</span><br><span class="line">(<span class="number">3</span>, <span class="number">1401</span>, <span class="number">2000</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="number">2001</span>, <span class="number">3000</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="number">3001</span>, <span class="number">9999</span>);</span><br></pre></td></tr></table></figure><p>演示：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; insert into salgrade values (<span class="number">1</span>, <span class="number">700</span>, <span class="number">1200</span>),</span><br><span class="line">    -&gt; (<span class="number">2</span>, <span class="number">1201</span>, <span class="number">1400</span>),</span><br><span class="line">    -&gt; (<span class="number">3</span>, <span class="number">1401</span>, <span class="number">2000</span>),</span><br><span class="line">    -&gt; (<span class="number">4</span>, <span class="number">2001</span>, <span class="number">3000</span>),</span><br><span class="line">    -&gt; (<span class="number">5</span>, <span class="number">3001</span>, <span class="number">9999</span>);</span><br><span class="line">Query OK, <span class="number">5</span> rows affected (<span class="number">0.07</span> sec)</span><br><span class="line">Records: <span class="number">5</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="简单查询："><a href="#简单查询：" class="headerlink" title="简单查询："></a>简单查询：</h2><h4 id="查询所有字段："><a href="#查询所有字段：" class="headerlink" title="查询所有字段："></a>查询所有字段：</h4><p>以表dept为例：<br>语法：<code>select * from 表名;</code><br>演示：<code>select * from dept;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from dept;</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">| deptno | dname      | loc      |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line">|     <span class="number">10</span> | ACCOUNTING | NEW YORK |</span><br><span class="line">|     <span class="number">20</span> | RESEARCH   | DALLAS   |</span><br><span class="line">|     <span class="number">30</span> | SALES      | CHICAGO  |</span><br><span class="line">|     <span class="number">40</span> | OPERATIONS | BOSTON   |</span><br><span class="line">+--------+------------+----------+</span><br><span class="line"><span class="number">4</span> rows in set (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h4 id="查询指定列："><a href="#查询指定列：" class="headerlink" title="查询指定列："></a>查询指定列：</h4><p>以emp表为例：<br>语法：<code>select 列名,列名 from 表名;</code><br>演示：<code>select empno,ename,job from emp;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> empno,ename,job from emp;</span><br><span class="line">+-------+--------+-----------+</span><br><span class="line">| empno | ename  | job       |</span><br><span class="line">+-------+--------+-----------+</span><br><span class="line">|  <span class="number">7369</span> | SMITH  | CLERK     |</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN  |</span><br><span class="line">|  <span class="number">7521</span> | WARD   | SALESMAN  |</span><br><span class="line">|  <span class="number">7566</span> | JONES  | MANAGER   |</span><br><span class="line">|  <span class="number">7654</span> | MARTIN | SALESMAN  |</span><br><span class="line">|  <span class="number">7698</span> | BLAKE  | MANAGER   |</span><br><span class="line">|  <span class="number">7782</span> | CLARK  | MANAGER   |</span><br><span class="line">|  <span class="number">7788</span> | SCOTT  | ANALYST   |</span><br><span class="line">|  <span class="number">7839</span> | KING   | PRESIDENT |</span><br><span class="line">|  <span class="number">7844</span> | TURNER | SALESMAN  |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS  | CLERK     |</span><br><span class="line">|  <span class="number">7900</span> | JAMES  | CLERK     |</span><br><span class="line">|  <span class="number">7902</span> | FORD   | ANALYST   |</span><br><span class="line">|  <span class="number">7934</span> | MILLER | CLERK     |</span><br><span class="line">+-------+--------+-----------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h4 id="起别名："><a href="#起别名：" class="headerlink" title="起别名："></a>起别名：</h4><p>以emp表为例：<br>语法：<code>select 列名 as 别名,列名 as 别名,列名 as 别名 from 表名;</code><br>演示：<code>select empno as 工号,ename as 姓名,job as 工作 from emp;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> empno as 工号,ename as 姓名,job as 工作 from emp;</span><br><span class="line">+--------+--------+-----------+</span><br><span class="line">| 工号   | 姓名   | 工作      |</span><br><span class="line">+--------+--------+-----------+</span><br><span class="line">|   <span class="number">7369</span> | SMITH  | CLERK     |</span><br><span class="line">|   <span class="number">7499</span> | ALLEN  | SALESMAN  |</span><br><span class="line">|   <span class="number">7521</span> | WARD   | SALESMAN  |</span><br><span class="line">|   <span class="number">7566</span> | JONES  | MANAGER   |</span><br><span class="line">|   <span class="number">7654</span> | MARTIN | SALESMAN  |</span><br><span class="line">|   <span class="number">7698</span> | BLAKE  | MANAGER   |</span><br><span class="line">|   <span class="number">7782</span> | CLARK  | MANAGER   |</span><br><span class="line">|   <span class="number">7788</span> | SCOTT  | ANALYST   |</span><br><span class="line">|   <span class="number">7839</span> | KING   | PRESIDENT |</span><br><span class="line">|   <span class="number">7844</span> | TURNER | SALESMAN  |</span><br><span class="line">|   <span class="number">7876</span> | ADAMS  | CLERK     |</span><br><span class="line">|   <span class="number">7900</span> | JAMES  | CLERK     |</span><br><span class="line">|   <span class="number">7902</span> | FORD   | ANALYST   |</span><br><span class="line">|   <span class="number">7934</span> | MILLER | CLERK     |</span><br><span class="line">+--------+--------+-----------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h4 id="列运算："><a href="#列运算：" class="headerlink" title="列运算："></a>列运算：</h4><p>在select语句中，对于number和date类型的值可以使用算术表达式<br>加法：<code>+</code><br>减法：<code>-</code><br>乘法：<code>*</code><br>除法：<code>/</code><br>括号：<code>()</code></p><p>如果某个字段有null值，那么计算后的结果也是null，<br>可以用函数ifnull(a,b)，若a为null则取b，若a不为null则取a的值。</p><p>演示：<code>select empno as 工号,ename as 姓名,job as 工作,sal*12+ifnull(comm,0) as 年薪 from emp;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> empno as 工号,ename as 姓名,job as 工作,sal*<span class="number">12</span>+ifnull(comm,<span class="number">0</span>) as 年薪 from emp;</span><br><span class="line">+--------+--------+-----------+----------+</span><br><span class="line">| 工号   | 姓名   | 工作      | 年薪     |</span><br><span class="line">+--------+--------+-----------+----------+</span><br><span class="line">|   <span class="number">7369</span> | SMITH  | CLERK     |  <span class="number">9600.00</span> |</span><br><span class="line">|   <span class="number">7499</span> | ALLEN  | SALESMAN  | <span class="number">19500.00</span> |</span><br><span class="line">|   <span class="number">7521</span> | WARD   | SALESMAN  | <span class="number">15500.00</span> |</span><br><span class="line">|   <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">35700.00</span> |</span><br><span class="line">|   <span class="number">7654</span> | MARTIN | SALESMAN  | <span class="number">16400.00</span> |</span><br><span class="line">|   <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">34200.00</span> |</span><br><span class="line">|   <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">29400.00</span> |</span><br><span class="line">|   <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">36000.00</span> |</span><br><span class="line">|   <span class="number">7839</span> | KING   | PRESIDENT | <span class="number">60000.00</span> |</span><br><span class="line">|   <span class="number">7844</span> | TURNER | SALESMAN  | <span class="number">18000.00</span> |</span><br><span class="line">|   <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">13200.00</span> |</span><br><span class="line">|   <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">11400.00</span> |</span><br><span class="line">|   <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">36000.00</span> |</span><br><span class="line">|   <span class="number">7934</span> | MILLER | CLERK     | <span class="number">15600.00</span> |</span><br><span class="line">+--------+--------+-----------+----------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h4 id="字符串类型的连续运算："><a href="#字符串类型的连续运算：" class="headerlink" title="字符串类型的连续运算："></a>字符串类型的连续运算：</h4><p>concat函数用来把搜索到的列和列进行拼接显示：<br>语法：<code>concat(&quot;字符串&quot;,字段1,&quot;字符串&quot;,字段2,...)</code><br>演示：<code>select concat(&quot;我是&quot;,ename,&quot;，我的年薪是&quot;,sal*12+ifnull(comm,0),&quot;欧元。&quot;) as 员工薪酬 from emp;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> concat(<span class="string">"我是"</span>,ename,<span class="string">"，我的年薪是"</span>,sal*<span class="number">12</span>+ifnull(comm,<span class="number">0</span>),<span class="string">"欧元。"</span>) as 员工薪酬 from emp; </span><br><span class="line">+-------------------------------------------------+</span><br><span class="line">| 员工薪酬                                        |</span><br><span class="line">+-------------------------------------------------+</span><br><span class="line">| 我是SMITH，我的年薪是<span class="number">9600.00</span>欧元。              |</span><br><span class="line">| 我是ALLEN，我的年薪是<span class="number">19500.00</span>欧元。             |</span><br><span class="line">| 我是WARD，我的年薪是<span class="number">15500.00</span>欧元。              |</span><br><span class="line">| 我是JONES，我的年薪是<span class="number">35700.00</span>欧元。             |</span><br><span class="line">| 我是MARTIN，我的年薪是<span class="number">16400.00</span>欧元。            |</span><br><span class="line">| 我是BLAKE，我的年薪是<span class="number">34200.00</span>欧元。             |</span><br><span class="line">| 我是CLARK，我的年薪是<span class="number">29400.00</span>欧元。             |</span><br><span class="line">| 我是SCOTT，我的年薪是<span class="number">36000.00</span>欧元。             |</span><br><span class="line">| 我是KING，我的年薪是<span class="number">60000.00</span>欧元。              |</span><br><span class="line">| 我是TURNER，我的年薪是<span class="number">18000.00</span>欧元。            |</span><br><span class="line">| 我是ADAMS，我的年薪是<span class="number">13200.00</span>欧元。             |</span><br><span class="line">| 我是JAMES，我的年薪是<span class="number">11400.00</span>欧元。             |</span><br><span class="line">| 我是FORD，我的年薪是<span class="number">36000.00</span>欧元。              |</span><br><span class="line">| 我是MILLER，我的年薪是<span class="number">15600.00</span>欧元。            |</span><br><span class="line">+-------------------------------------------------+</span><br><span class="line"><span class="number">14</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h4 id="distinct去除重复项"><a href="#distinct去除重复项" class="headerlink" title="distinct去除重复项"></a>distinct去除重复项</h4><p>distinct的用法稍微复杂一点，这里分别演示一下：<br>首先，在之前的students表中增加两条数据，以备接下来的查询，</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from students;</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9556</span> | Lily      |   <span class="number">21</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9561</span> | 飞流      |   <span class="number">17</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">4</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into students values (<span class="number">0</span>,<span class="string">"萧景琰"</span>,<span class="number">28</span>,<span class="string">"男"</span>,<span class="string">"靖王"</span>,<span class="number">123456</span>);</span><br><span class="line">Query OK, <span class="number">1</span> row affected (<span class="number">0.12</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into students values (<span class="number">0</span>,<span class="string">"萧景琰"</span>,<span class="number">28</span>,<span class="string">"男"</span>,<span class="string">"靖王"</span>,<span class="number">123456</span>);</span><br><span class="line">Query OK, <span class="number">1</span> row affected (<span class="number">0.05</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from students;</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9556</span> | Lily      |   <span class="number">21</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9561</span> | 飞流      |   <span class="number">17</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9562</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9563</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">6</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>现在students表中最后两条数据，除了第一个字段不一样外，其余字段都完全相同，接下来就看看distinct怎么用</p><p>首先，distinct必须放在要查询字段的前面，而不能跟在字段后面：</p><p>语法：<code>select distinct 字段名 from 表名;</code><br>distinct后面可跟多个字段，</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> distinct name from students;</span><br><span class="line">+-----------+</span><br><span class="line">| name      |</span><br><span class="line">+-----------+</span><br><span class="line">| Lily      |</span><br><span class="line">| 梅长苏    |</span><br><span class="line">| 穆霓凰    |</span><br><span class="line">| 飞流      |</span><br><span class="line">| 萧景琰    |</span><br><span class="line">+-----------+</span><br><span class="line"><span class="number">5</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> distinct StudentID,name from students;</span><br><span class="line">+-----------+-----------+</span><br><span class="line">| StudentID | name      |</span><br><span class="line">+-----------+-----------+</span><br><span class="line">|      <span class="number">9556</span> | Lily      |</span><br><span class="line">|      <span class="number">9559</span> | 梅长苏    |</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |</span><br><span class="line">|      <span class="number">9561</span> | 飞流      |</span><br><span class="line">|      <span class="number">9562</span> | 萧景琰    |</span><br><span class="line">|      <span class="number">9563</span> | 萧景琰    |</span><br><span class="line">+-----------+-----------+</span><br><span class="line"><span class="number">6</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> distinct StudentID,name,age from students;</span><br><span class="line">+-----------+-----------+------+</span><br><span class="line">| StudentID | name      | age  |</span><br><span class="line">+-----------+-----------+------+</span><br><span class="line">|      <span class="number">9556</span> | Lily      |   <span class="number">21</span> |</span><br><span class="line">|      <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> |</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> |</span><br><span class="line">|      <span class="number">9561</span> | 飞流      |   <span class="number">17</span> |</span><br><span class="line">|      <span class="number">9562</span> | 萧景琰    |   <span class="number">28</span> |</span><br><span class="line">|      <span class="number">9563</span> | 萧景琰    |   <span class="number">28</span> |</span><br><span class="line">+-----------+-----------+------+</span><br><span class="line"><span class="number">6</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> distinct name,age,sex from students;</span><br><span class="line">+-----------+------+------+</span><br><span class="line">| name      | age  | sex  |</span><br><span class="line">+-----------+------+------+</span><br><span class="line">| Lily      |   <span class="number">21</span> | 女   |</span><br><span class="line">| 梅长苏    |   <span class="number">28</span> | 男   |</span><br><span class="line">| 穆霓凰    |   <span class="number">26</span> | 女   |</span><br><span class="line">| 飞流      |   <span class="number">17</span> | 男   |</span><br><span class="line">| 萧景琰    |   <span class="number">28</span> | 男   |</span><br><span class="line">+-----------+------+------+</span><br><span class="line"><span class="number">5</span> rows in set (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> distinct StudentID,name,age,sex from students;</span><br><span class="line">+-----------+-----------+------+------+</span><br><span class="line">| StudentID | name      | age  | sex  |</span><br><span class="line">+-----------+-----------+------+------+</span><br><span class="line">|      <span class="number">9556</span> | Lily      |   <span class="number">21</span> | 女   |</span><br><span class="line">|      <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> | 男   |</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |</span><br><span class="line">|      <span class="number">9561</span> | 飞流      |   <span class="number">17</span> | 男   |</span><br><span class="line">|      <span class="number">9562</span> | 萧景琰    |   <span class="number">28</span> | 男   |</span><br><span class="line">|      <span class="number">9563</span> | 萧景琰    |   <span class="number">28</span> | 男   |</span><br><span class="line">+-----------+-----------+------+------+</span><br><span class="line"><span class="number">6</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>上面分别是distinct后面有一个字段、两个字段、三个字段和四个字段的情形，可见，如果distinct后面如果有多个字段的话，只有多个字段的内容全部相同，才会被视为重复，只要有一个字段不相同，就不认为是重复。</p><p>除此之外，distinct经常用来统计不重复字段的条数，</p><p>语法：<code>select count(distinct 字段名) from 表名;</code><br>演示：<code>select count(distinct StudentID) from students;</code><br>演示：<code>select count(distinct name) from students;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> count(distinct StudentID) from students;</span><br><span class="line">+---------------------------+</span><br><span class="line">| count(distinct StudentID) |</span><br><span class="line">+---------------------------+</span><br><span class="line">|                         <span class="number">6</span> |</span><br><span class="line">+---------------------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> count(distinct name) from students;</span><br><span class="line">+----------------------+</span><br><span class="line">| count(distinct name) |</span><br><span class="line">+----------------------+</span><br><span class="line">|                    <span class="number">5</span> |</span><br><span class="line">+----------------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>以上两条查询结果表示在students表中，ID不相同的记录有6条，而name不相同的记录有5条。</p><h2 id="条件查询"><a href="#条件查询" class="headerlink" title="条件查询"></a>条件查询</h2><h4 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h4><ul><li>等于 <code>=</code></li><li>大于 <code>&gt;</code></li><li>小于 <code>&lt;</code></li><li>大于等于 <code>&gt;=</code></li><li>小于等于 <code>&lt;=</code></li><li>不等于 <code>!=</code> 或 <code>&lt;&gt;</code></li></ul><hr><p>单条件比较运算很简单，与以下类似，就不一一列举了<br>语法：<code>select 列名 from 表名 where 条件;</code><br>演示：<code>select * from students where age &gt; 25;</code>         年龄大于25的；<br>演示：<code>select * from students where age &lt;&gt; 28;</code>        年龄不等于28的；<br>演示：<code>select * from students where age &lt;= 25;</code>        年龄小于等于25的；<br>演示：<code>select * from students where sex = &quot;女&quot;;</code>        性别为女性的；</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from students where age &gt; <span class="number">25</span>;</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9562</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9563</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">4</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from students where age &lt;&gt; <span class="number">28</span>;</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9556</span> | Lily      |   <span class="number">21</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9561</span> | 飞流      |   <span class="number">17</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">3</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from students where age &lt;= <span class="number">25</span>;</span><br><span class="line">+-----------+--------+------+------+----------+----------+</span><br><span class="line">| StudentID | name   | age  | sex  | username | password |</span><br><span class="line">+-----------+--------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9556</span> | Lily   |   <span class="number">21</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9561</span> | 飞流   |   <span class="number">17</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">+-----------+--------+------+------+----------+----------+</span><br><span class="line"><span class="number">2</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from students where sex = <span class="string">"女"</span>;</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9556</span> | Lily      |   <span class="number">21</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">2</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h4 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h4><ul><li>and, &amp;&amp; (与)</li><li>or, || (或)</li><li>not, !(非)</li><li>xor (异或)</li></ul><hr><p>从students表中找出年龄大于25的或者性别为女性的学生<br>演示：<code>select * from students where age &gt; 25 or sex = &quot;女&quot;</code><br>或者：<code>select * from students where age &gt; 25 || sex = &quot;女&quot;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from students where age &gt; <span class="number">25</span> or sex = <span class="string">"女"</span>;</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9556</span> | Lily      |   <span class="number">21</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9562</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9563</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">5</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>从students表中找出要么年龄大于25的，要么性别为女性的学生<br>演示：<code>select * from students where age &gt; 25 xor sex = &quot;女&quot;;</code><br>这里的异或表示两个条件既不能同时满足，也不能同时不满足，</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from students where age &gt; <span class="number">25</span> xor sex = <span class="string">"女"</span>;</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9556</span> | Lily      |   <span class="number">21</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9562</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9563</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">4</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h4 id="模糊查询"><a href="#模糊查询" class="headerlink" title="模糊查询"></a>模糊查询</h4><p>从students表中查询姓名中含有“梅”字的学生，使用<strong>like</strong>关键字，<br>演示：<code>select * from students where name like &quot;%梅%&quot;;</code><br>这里的   <strong>%</strong>   表示任意多个字符，</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from students where name like <span class="string">"%梅%"</span>;</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from students where name like <span class="string">"%凰"</span>;</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>找出名字是两个字的学生，<br>演示：<code>select * from students where name like &quot;__&quot;;</code><br>这里用下划线<code>_</code>表示，一个下划线表示任意一个字符，两个下划线表示任意两个字符，</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from students where name like <span class="string">"__"</span>;</span><br><span class="line">+-----------+--------+------+------+----------+----------+</span><br><span class="line">| StudentID | name   | age  | sex  | username | password |</span><br><span class="line">+-----------+--------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9561</span> | 飞流   |   <span class="number">17</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">+-----------+--------+------+------+----------+----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h4 id="区间查询"><a href="#区间查询" class="headerlink" title="区间查询"></a>区间查询</h4><h6 id="非连续区间"><a href="#非连续区间" class="headerlink" title="非连续区间"></a>非连续区间</h6><p>语法：<code>in(条件1，条件2)</code><br>演示：<code>select * from students where age in(21,26,28);</code><br>表示找出年龄是21岁，26岁，或者28岁的学生</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from students where age in(<span class="number">21</span>,<span class="number">26</span>,<span class="number">28</span>);</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9556</span> | Lily      |   <span class="number">21</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9562</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9563</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">5</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h6 id="连续区间"><a href="#连续区间" class="headerlink" title="连续区间"></a>连续区间</h6><p>语法：<code>between 条件1 and 条件2</code><br>演示：<code>select * from students where StudentID between 9561 and 9563;</code><br>表示查询ID在9561和9563之间的学生</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from students where StudentID between <span class="number">9561</span> and <span class="number">9563</span>;</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9561</span> | 飞流      |   <span class="number">17</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9562</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9563</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">3</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h6 id="null判断"><a href="#null判断" class="headerlink" title="null判断"></a>null判断</h6><p>is null 和 is not null<br>从emp表中查询comm为null的，再查询comm不为null的数据</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from emp where comm is null;</span><br><span class="line">+-------+--------+-----------+------+---------------------+---------+------+--------+</span><br><span class="line">| empno | ename  | job       | mgr  | hiredate            | sal     | comm | deptno |</span><br><span class="line">+-------+--------+-----------+------+---------------------+---------+------+--------+</span><br><span class="line">|  <span class="number">7369</span> | SMITH  | CLERK     | <span class="number">7902</span> | <span class="number">1980</span><span class="number">-12</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">800.00</span> | NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7566</span> | JONES  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-04</span><span class="number">-02</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2975.00</span> | NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7698</span> | BLAKE  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-05</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2850.00</span> | NULL |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7782</span> | CLARK  | MANAGER   | <span class="number">7839</span> | <span class="number">1981</span><span class="number">-06</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">2450.00</span> | NULL |     <span class="number">10</span> |</span><br><span class="line">|  <span class="number">7788</span> | SCOTT  | ANALYST   | <span class="number">7566</span> | <span class="number">1982</span><span class="number">-12</span><span class="number">-09</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> | NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7839</span> | KING   | PRESIDENT | NULL | <span class="number">1981</span><span class="number">-11</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">5000.00</span> | NULL |     <span class="number">10</span> |</span><br><span class="line">|  <span class="number">7876</span> | ADAMS  | CLERK     | <span class="number">7788</span> | <span class="number">1983</span><span class="number">-01</span><span class="number">-12</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1100.00</span> | NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7900</span> | JAMES  | CLERK     | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> |  <span class="number">950.00</span> | NULL |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7902</span> | FORD   | ANALYST   | <span class="number">7566</span> | <span class="number">1981</span><span class="number">-12</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">3000.00</span> | NULL |     <span class="number">20</span> |</span><br><span class="line">|  <span class="number">7934</span> | MILLER | CLERK     | <span class="number">7782</span> | <span class="number">1982</span><span class="number">-01</span><span class="number">-23</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1300.00</span> | NULL |     <span class="number">10</span> |</span><br><span class="line">+-------+--------+-----------+------+---------------------+---------+------+--------+</span><br><span class="line"><span class="number">10</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from emp where comm is not null;</span><br><span class="line">+-------+--------+----------+------+---------------------+---------+---------+--------+</span><br><span class="line">| empno | ename  | job      | mgr  | hiredate            | sal     | comm    | deptno |</span><br><span class="line">+-------+--------+----------+------+---------------------+---------+---------+--------+</span><br><span class="line">|  <span class="number">7499</span> | ALLEN  | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1600.00</span> |  <span class="number">300.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7521</span> | WARD   | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-02</span><span class="number">-22</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> |  <span class="number">500.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7654</span> | MARTIN | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-28</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1250.00</span> | <span class="number">1400.00</span> |     <span class="number">30</span> |</span><br><span class="line">|  <span class="number">7844</span> | TURNER | SALESMAN | <span class="number">7698</span> | <span class="number">1981</span><span class="number">-09</span><span class="number">-08</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> | <span class="number">1500.00</span> |    <span class="number">0.00</span> |     <span class="number">30</span> |</span><br><span class="line">+-------+--------+----------+------+---------------------+---------+---------+--------+</span><br><span class="line"><span class="number">4</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h2><p>order by 排序，包括升序（asc）和降序（desc），order by 默认为升序，所以asc关键字可省略</p><p>从students表中查询所有的学生，并按年龄从小到大排序，<br>演示：<code>select * from students order by age;</code>       这里省略了关键字<code>asc</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from students order by age;</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9561</span> | 飞流      |   <span class="number">17</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9556</span> | Lily      |   <span class="number">21</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9562</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9563</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">6</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>从students表中查询所有的学生信息，并按年龄从大到小排序，<br>演示：<code>select * from students order by age desc;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from students order by age desc;</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9562</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9563</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9556</span> | Lily      |   <span class="number">21</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9561</span> | 飞流      |   <span class="number">17</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">6</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h6 id="多种规则排序"><a href="#多种规则排序" class="headerlink" title="多种规则排序"></a>多种规则排序</h6><p>从students表中查询所有学生信息，并按年龄从小到大排列，年龄相同的，按学号从大到小排列<br>演示：<code>select * from students order by age,studentID desc;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from students order by age,studentID desc;</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9561</span> | 飞流      |   <span class="number">17</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9556</span> | Lily      |   <span class="number">21</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9563</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9562</span> | 萧景琰    |   <span class="number">28</span> | 男   | 靖王     | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">6</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>MySQL查询这一节就到这里，下一节继续复杂查询，并学习多表联查。</p><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="数据库" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="MySQL数据库" scheme="http://yoursite.com/tags/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>MySQL8.0：添加、修改、删除数据，修改表结构</title>
    <link href="http://yoursite.com/2018/07/28/MySQL8.0%EF%BC%9A%E6%B7%BB%E5%8A%A0%E3%80%81%E4%BF%AE%E6%94%B9%E3%80%81%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%EF%BC%8C%E4%BF%AE%E6%94%B9%E8%A1%A8%E7%BB%93%E6%9E%84/"/>
    <id>http://yoursite.com/2018/07/28/MySQL8.0：添加、修改、删除数据，修改表结构/</id>
    <published>2018-07-28T02:10:00.000Z</published>
    <updated>2018-08-27T09:35:58.382Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><p>基于上一节中创建的student表，这一节中，来对student表进行进一步的增删改查。</p><h2 id="MySQL的数据类型"><a href="#MySQL的数据类型" class="headerlink" title="MySQL的数据类型"></a>MySQL的数据类型</h2><p>最常用的类型：<br>int：整型<br>double：浮点型<br>char：固定长度字符串类型，中文汉字属于字符串类型<br>varchar：可变长度字符串类型，中文汉字属于字符串类型<br>text：字符串类型，存储超大文本<br>date：日期类型，格式为：yyyy-MM-dd<br>time：时间类型，格式为：hh:mm:ss<br>timestamp：时间戳</p><h2 id="表的约束"><a href="#表的约束" class="headerlink" title="表的约束"></a>表的约束</h2><p>这里的约束是指在创建表的时候，对表的字段所设置的约束条件，用来限制该列的数据类型和内容</p><p>default：默认值<br>not null ：非空约束，其值不能为空，不是0，也不是空字符串””，也可以是null<br>unique：唯一性约束，强调该字段所有的值都是唯一的，不允许重复，但允许空值，且可以有多个空值<br>primary key：主键约束，要求该字段数值不能为空，而且数值唯一<br>auto_increment：自增约束，要求该字段不能为空，数值唯一，类型为整型，并根据前一条数据自动加1</p><h2 id="添加数据："><a href="#添加数据：" class="headerlink" title="添加数据："></a>添加数据：</h2><p>先看一下表的结构：<br><code>mysql&gt; describe student;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; describe student;</span><br><span class="line">+-------+-------------+------+-----+---------+----------------+</span><br><span class="line">| Field | Type        | Null | Key | Default | Extra          |</span><br><span class="line">+-------+-------------+------+-----+---------+----------------+</span><br><span class="line">| id    | <span class="keyword">int</span>(<span class="number">11</span>)     | NO   | PRI | NULL    | auto_increment |</span><br><span class="line">| name  | varchar(<span class="number">16</span>) | NO   |     | NULL    |                |</span><br><span class="line">| age   | <span class="keyword">int</span>(<span class="number">11</span>)     | YES  |     | NULL    |                |</span><br><span class="line">| sex   | char(<span class="number">1</span>)     | YES  |     | NULL    |                |</span><br><span class="line">+-------+-------------+------+-----+---------+----------------+</span><br><span class="line"><span class="number">4</span> rows in set (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h4 id="全列插入："><a href="#全列插入：" class="headerlink" title="全列插入："></a>全列插入：</h4><p>name和sex字段为字符串类型，注意加双引号，英文符号。</p><p>插入一行数据：<br>语法：<code>insert into 表名 values(值1，值2，....);</code><br>演示：<code>insert into student values(9527,&quot;jack&quot;,23,&quot;男&quot;);</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; insert into student values(<span class="number">9527</span>,<span class="string">"jack"</span>,<span class="number">23</span>,<span class="string">"男"</span>);</span><br><span class="line">Query OK, <span class="number">1</span> row affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>全列插入的时候，每一列的数据都要填。<br>查询数据：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from student;</span><br><span class="line">+------+------+------+------+</span><br><span class="line">| id   | name | age  | sex  |</span><br><span class="line">+------+------+------+------+</span><br><span class="line">| <span class="number">9527</span> | jack |   <span class="number">23</span> | 男   |</span><br><span class="line">+------+------+------+------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>同时插入多条数据：<br>语法：<code>insert into 表名 values(值1, 值2,...), (值1, 值2,...),...;</code><br>演示：<code>insert into student value (9529,&quot;Tom&quot;,22,&quot;男&quot;), (9555,&quot;lucy&quot;,20,&quot;女&quot;), (0,&quot;liiy&quot;,21,&quot;女&quot;);</code><br>value和values均可，<br>一行写不完，可以按回车，在下一行继续写，一般一条数据占一行，即一个括号占一行，以便整洁美观。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; insert into student value</span><br><span class="line">    -&gt; (<span class="number">9529</span>,<span class="string">"Tom"</span>,<span class="number">22</span>,<span class="string">"男"</span>),</span><br><span class="line">    -&gt; (<span class="number">9555</span>,<span class="string">"lucy"</span>,<span class="number">20</span>,<span class="string">"女"</span>),</span><br><span class="line">    -&gt; (<span class="number">0</span>,<span class="string">"liiy"</span>,<span class="number">21</span>,<span class="string">"女"</span>);</span><br><span class="line">Query OK, <span class="number">3</span> rows affected (<span class="number">0.09</span> sec)</span><br><span class="line">Records: <span class="number">3</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from student;</span><br><span class="line">+------+------+------+------+</span><br><span class="line">| id   | name | age  | sex  |</span><br><span class="line">+------+------+------+------+</span><br><span class="line">| <span class="number">9527</span> | jack |   <span class="number">23</span> | 男   |</span><br><span class="line">| <span class="number">9529</span> | Tom  |   <span class="number">22</span> | 男   |</span><br><span class="line">| <span class="number">9555</span> | lucy |   <span class="number">20</span> | 女   |</span><br><span class="line">| <span class="number">9556</span> | liiy |   <span class="number">21</span> | 女   |</span><br><span class="line">+------+------+------+------+</span><br><span class="line"><span class="number">4</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>每一条数据用一个英文()括起来，<br>两个括号之间，用逗号隔开，<br>字符串类型的值，要加双引号，<br>最后一个括号后面用分号结束。</p><p>其中id字段为自增长类型，0用来对自增长的数据占位，表示前一个id加1。</p><h4 id="缺省插入"><a href="#缺省插入" class="headerlink" title="缺省插入"></a>缺省插入</h4><p>同时插入多条数据：<br>语法：<code>insert into 表名(列1, 列2, ...) values(值1, 值2, ...);</code><br>演示：<code>insert into student(name,age,sex) values (&quot;梅长苏&quot;,28,&quot;男&quot;), (&quot;穆霓凰&quot;,26,&quot;女&quot;), (&quot;飞流&quot;,17,&quot;男&quot;);</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; insert into student(name,age,sex) values</span><br><span class="line">    -&gt; (<span class="string">"梅长苏"</span>,<span class="number">28</span>,<span class="string">"男"</span>),</span><br><span class="line">    -&gt; (<span class="string">"穆霓凰"</span>,<span class="number">26</span>,<span class="string">"女"</span>),</span><br><span class="line">    -&gt; (<span class="string">"飞流"</span>,<span class="number">17</span>,<span class="string">"男"</span>);</span><br><span class="line">Query OK, <span class="number">3</span> rows affected (<span class="number">0.10</span> sec)</span><br><span class="line">Records: <span class="number">3</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from student;</span><br><span class="line">+------+-----------+------+------+</span><br><span class="line">| id   | name      | age  | sex  |</span><br><span class="line">+------+-----------+------+------+</span><br><span class="line">| <span class="number">9527</span> | jack      |   <span class="number">23</span> | 男   |</span><br><span class="line">| <span class="number">9529</span> | Tom       |   <span class="number">22</span> | 男   |</span><br><span class="line">| <span class="number">9555</span> | lucy      |   <span class="number">20</span> | 女   |</span><br><span class="line">| <span class="number">9556</span> | liiy      |   <span class="number">21</span> | 女   |</span><br><span class="line">| <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> | 男   |</span><br><span class="line">| <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |</span><br><span class="line">| <span class="number">9561</span> | 飞流      |   <span class="number">17</span> | 男   |</span><br><span class="line">+------+-----------+------+------+</span><br><span class="line"><span class="number">7</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p><code>not null</code>和<code>primary key</code>字段必须赋值，其他字段可以省略。</p><h2 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h2><p>语法：<code>update 表名 set 列1=值1,列2=值2,... where 条件</code></p><p>演示：<code>update student set name=&quot;Lily&quot; where name=&quot;liiy&quot;;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; update student set name=<span class="string">"Lily"</span> where name=<span class="string">"liiy"</span>;</span><br><span class="line">Query OK, <span class="number">1</span> row affected (<span class="number">0.04</span> sec)</span><br><span class="line">Rows matched: <span class="number">1</span>  Changed: <span class="number">1</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from student;                                                   +------+-----------+------+------+</span><br><span class="line">| id   | name      | age  | sex  |</span><br><span class="line">+------+-----------+------+------+</span><br><span class="line">| <span class="number">9527</span> | jack      |   <span class="number">23</span> | 男   |</span><br><span class="line">| <span class="number">9529</span> | Tom       |   <span class="number">22</span> | 男   |</span><br><span class="line">| <span class="number">9555</span> | lucy      |   <span class="number">20</span> | 女   |</span><br><span class="line">| <span class="number">9556</span> | Lily      |   <span class="number">21</span> | 女   |</span><br><span class="line">| <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> | 男   |</span><br><span class="line">| <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |</span><br><span class="line">| <span class="number">9561</span> | 飞流      |   <span class="number">17</span> | 男   |</span><br><span class="line">+------+-----------+------+------+</span><br><span class="line"><span class="number">7</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h2><p>语法：<code>delete from 表名 where 条件</code><br>演示：<code>delete from student where id=9555;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="built_in">delete</span> from student where id=<span class="number">9555</span>;</span><br><span class="line">Query OK, <span class="number">1</span> row affected (<span class="number">0.15</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="built_in">delete</span> from student where id=<span class="number">9527</span> or name=<span class="string">"Tom"</span>;</span><br><span class="line">Query OK, <span class="number">2</span> rows affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="修改表结构"><a href="#修改表结构" class="headerlink" title="修改表结构"></a>修改表结构</h2><h4 id="添加字段"><a href="#添加字段" class="headerlink" title="添加字段"></a>添加字段</h4><p>语法：<code>alter table 表名 add 列名 列类型;</code><br>演示：<code>alter table student add username varchar(18) not null;</code><br>演示：<code>alter table student add password varchar(12) default &quot;123456&quot;;</code></p><h4 id="修改列类型"><a href="#修改列类型" class="headerlink" title="修改列类型"></a>修改列类型</h4><p>语法：<code>alter table 表名 modify 列名 列类型;</code><br>演示：<code>alter table student modify password varchar(10) default &quot;123456&quot;;</code></p><h4 id="修改列名"><a href="#修改列名" class="headerlink" title="修改列名"></a>修改列名</h4><p>语法：<code>alter table 表名 change 原列名 新列名 列类型;</code><br>演示：<code>alter table student change id StudentID int(11) auto_increment;</code></p><h4 id="修改表名称"><a href="#修改表名称" class="headerlink" title="修改表名称"></a>修改表名称</h4><p>语法：<code>rename table 原表名 to 新表名;</code><br>演示：<code>rename table student to students;</code></p><p>演示结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; alter table student add username varchar(<span class="number">18</span>) not null;</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.12</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql&gt; alter table student add password varchar(<span class="number">12</span>) <span class="keyword">default</span> <span class="string">"123456"</span>;</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.18</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql&gt; alter table student modify password varchar(<span class="number">10</span>) <span class="keyword">default</span> <span class="string">"123456"</span>;</span><br><span class="line">Query OK, <span class="number">4</span> rows affected (<span class="number">0.20</span> sec)</span><br><span class="line">Records: <span class="number">4</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql&gt; alter table student change id StudentID <span class="keyword">int</span>(<span class="number">11</span>) auto_increment;</span><br><span class="line">Query OK, <span class="number">4</span> rows affected (<span class="number">0.05</span> sec)</span><br><span class="line">Records: <span class="number">4</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql&gt; rename table student to students;</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.04</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; describe students;</span><br><span class="line">+-----------+-------------+------+-----+---------+----------------+</span><br><span class="line">| Field     | Type        | Null | Key | Default | Extra          |</span><br><span class="line">+-----------+-------------+------+-----+---------+----------------+</span><br><span class="line">| StudentID | <span class="keyword">int</span>(<span class="number">11</span>)     | NO   | PRI | NULL    | auto_increment |</span><br><span class="line">| name      | varchar(<span class="number">16</span>) | NO   |     | NULL    |                |</span><br><span class="line">| age       | <span class="keyword">int</span>(<span class="number">11</span>)     | YES  |     | NULL    |                |</span><br><span class="line">| sex       | char(<span class="number">1</span>)     | YES  |     | NULL    |                |</span><br><span class="line">| username  | varchar(<span class="number">18</span>) | NO   |     | NULL    |                |</span><br><span class="line">| password  | varchar(<span class="number">10</span>) | YES  |     | <span class="number">123456</span>  |                |</span><br><span class="line">+-----------+-------------+------+-----+---------+----------------+</span><br><span class="line"><span class="number">6</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * from students;</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">| StudentID | name      | age  | sex  | username | password |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line">|      <span class="number">9556</span> | Lily      |   <span class="number">21</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9559</span> | 梅长苏    |   <span class="number">28</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9560</span> | 穆霓凰    |   <span class="number">26</span> | 女   |          | <span class="number">123456</span>   |</span><br><span class="line">|      <span class="number">9561</span> | 飞流      |   <span class="number">17</span> | 男   |          | <span class="number">123456</span>   |</span><br><span class="line">+-----------+-----------+------+------+----------+----------+</span><br><span class="line"><span class="number">4</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>注意add添加列不会影响数据，更改表的名称也不会影响到数据，而modify修改列类型，change修改列名都会影响到数据，所以当表中有数据的时候，修改列名和列类型的时候要格外注意。</p><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="数据库" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="MySQL数据库" scheme="http://yoursite.com/tags/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>MySQL8.0 创建用户，创建数据库，授权和创建表</title>
    <link href="http://yoursite.com/2018/07/27/MySQL8.0%20%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7%EF%BC%8C%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8C%E6%8E%88%E6%9D%83%E5%92%8C%E5%88%9B%E5%BB%BA%E8%A1%A8/"/>
    <id>http://yoursite.com/2018/07/27/MySQL8.0 创建用户，创建数据库，授权和创建表/</id>
    <published>2018-07-27T14:29:00.000Z</published>
    <updated>2018-08-27T09:40:24.189Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><h2 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h2><p>创建一个指定主机为127.0.0.1的用户，该用户只能在IP为127.0.0.1的主机登录，用户名叫做<code>Tom</code>，密码为<code>234567</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create user <span class="string">'Tom'</span>@<span class="string">'127.0.0.1'</span> identified by <span class="string">'234567'</span>;</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.14</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="为新用户授权"><a href="#为新用户授权" class="headerlink" title="为新用户授权"></a>为新用户授权</h2><p>为<a href="mailto:`Tom@127.0.0.1" target="_blank" rel="noopener">`Tom@127.0.0.1</a><code>用户授权，</code>grant all`表示授权所有权限</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; grant all on *.* to <span class="string">'Tom'</span>@<span class="string">'127.0.0.1'</span> with grant option;</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.16</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="查看权限"><a href="#查看权限" class="headerlink" title="查看权限"></a>查看权限</h2><p>查看用户<a href="mailto:`Tom@127.0.0.1" target="_blank" rel="noopener">`Tom@127.0.0.1</a>`的权限</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show grants <span class="keyword">for</span> <span class="string">'Tom'</span>@<span class="string">'127.0.0.1'</span>;</span><br><span class="line">+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Grants <span class="keyword">for</span> Tom@<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>                                                                                                                                                                                                                                                                                                                                                                                |</span><br><span class="line">+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, RELOAD, SHUTDOWN, PROCESS, FILE, REFERENCES, INDEX, ALTER, SHOW DATABASES, SUPER, CREATE TEMPORARY TABLES, LOCK TABLES, EXECUTE, REPLICATION SLAVE, REPLICATION CLIENT, CREATE VIEW, SHOW VIEW, CREATE ROUTINE, ALTER ROUTINE, CREATE USER, EVENT, TRIGGER, CREATE TABLESPACE, CREATE ROLE, DROP ROLE ON *.* TO <span class="string">`Tom`</span>@<span class="string">`127.0.0.1`</span> WITH GRANT OPTION |</span><br><span class="line">| GRANT BACKUP_ADMIN,BINLOG_ADMIN,CONNECTION_ADMIN,ENCRYPTION_KEY_ADMIN,GROUP_REPLICATION_ADMIN,PERSIST_RO_VARIABLES_ADMIN,REPLICATION_SLAVE_ADMIN,RESOURCE_GROUP_ADMIN,RESOURCE_GROUP_USER,ROLE_ADMIN,SET_USER_ID,SYSTEM_VARIABLES_ADMIN,XA_RECOVER_ADMIN ON *.* TO <span class="string">`Tom`</span>@<span class="string">`127.0.0.1`</span> WITH GRANT OPTION                                                                                                  |</span><br><span class="line">+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line"><span class="number">2</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="查看所有的用户"><a href="#查看所有的用户" class="headerlink" title="查看所有的用户"></a>查看所有的用户</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> host,user from mysql.user;</span><br><span class="line">+-----------+------------------+</span><br><span class="line">| host      | user             |</span><br><span class="line">+-----------+------------------+</span><br><span class="line">| <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> | Tom              |</span><br><span class="line">| localhost | mysql.infoschema |</span><br><span class="line">| localhost | mysql.session    |</span><br><span class="line">| localhost | mysql.sys        |</span><br><span class="line">| localhost | root             |</span><br><span class="line">+-----------+------------------+</span><br><span class="line"><span class="number">5</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="查看当前用户"><a href="#查看当前用户" class="headerlink" title="查看当前用户"></a>查看当前用户</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> current_user();</span><br><span class="line">+----------------+</span><br><span class="line">| current_user() |</span><br><span class="line">+----------------+</span><br><span class="line">| root@localhost |</span><br><span class="line">+----------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>退出root用户，用<a href="mailto:Tom@127.0.0.1" target="_blank" rel="noopener">Tom@127.0.0.1</a>用户登录<br><code>-h</code>表示指定主机IP，<code>-u</code>表示指定用户名，<code>-p</code>表示指定密码</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ mysql -h <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> -u Tom -p</span><br><span class="line">Enter password: </span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is <span class="number">53</span></span><br><span class="line">Server version: <span class="number">8.0</span><span class="number">.12</span> Homebrew</span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">2000</span>, <span class="number">2018</span>, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type <span class="string">'help;'</span> or <span class="string">'\h'</span> <span class="keyword">for</span> help. Type <span class="string">'\c'</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>查看当前用户</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> current_user;</span><br><span class="line">+---------------+</span><br><span class="line">| current_user  |</span><br><span class="line">+---------------+</span><br><span class="line">| Tom@<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> |</span><br><span class="line">+---------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="查看当前用户权限"><a href="#查看当前用户权限" class="headerlink" title="查看当前用户权限"></a>查看当前用户权限</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show grants;</span><br><span class="line">+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Grants <span class="keyword">for</span> Tom@<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>                                                                                                                                                                                                                                                                                                                                                                                |</span><br><span class="line">+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, RELOAD, SHUTDOWN, PROCESS, FILE, REFERENCES, INDEX, ALTER, SHOW DATABASES, SUPER, CREATE TEMPORARY TABLES, LOCK TABLES, EXECUTE, REPLICATION SLAVE, REPLICATION CLIENT, CREATE VIEW, SHOW VIEW, CREATE ROUTINE, ALTER ROUTINE, CREATE USER, EVENT, TRIGGER, CREATE TABLESPACE, CREATE ROLE, DROP ROLE ON *.* TO <span class="string">`Tom`</span>@<span class="string">`127.0.0.1`</span> WITH GRANT OPTION |</span><br><span class="line">| GRANT BACKUP_ADMIN,BINLOG_ADMIN,CONNECTION_ADMIN,ENCRYPTION_KEY_ADMIN,GROUP_REPLICATION_ADMIN,PERSIST_RO_VARIABLES_ADMIN,REPLICATION_SLAVE_ADMIN,RESOURCE_GROUP_ADMIN,RESOURCE_GROUP_USER,ROLE_ADMIN,SET_USER_ID,SYSTEM_VARIABLES_ADMIN,XA_RECOVER_ADMIN ON *.* TO <span class="string">`Tom`</span>@<span class="string">`127.0.0.1`</span> WITH GRANT OPTION                                                                                                  |</span><br><span class="line">+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line"><span class="number">2</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h2><p>创建一个数据库<br><code>mysql2018</code>为新创建的数据库的名称，<br><code>default character set = utf8</code>表示默认编码格式为utf8格式。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create database mysql2018 <span class="keyword">default</span> character set = utf8;</span><br><span class="line">Query OK, <span class="number">1</span> row affected, <span class="number">1</span> warning (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>查看当前用户下所有数据库</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| mysql2018          |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line"><span class="number">5</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>选择一个数据库mysql，并查看其中的表</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use mysql;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+---------------------------+</span><br><span class="line">| Tables_in_mysql           |</span><br><span class="line">+---------------------------+</span><br><span class="line">| columns_priv              |</span><br><span class="line">| component                 |</span><br><span class="line">| db                        |</span><br><span class="line">| default_roles             |</span><br><span class="line">| engine_cost               |</span><br><span class="line">| <span class="function"><span class="keyword">func</span>                      |</span></span><br><span class="line"><span class="function">| <span class="title">general_log</span>               |</span></span><br><span class="line"><span class="function">| <span class="title">global_grants</span>             |</span></span><br><span class="line"><span class="function">| <span class="title">gtid_executed</span>             |</span></span><br><span class="line"><span class="function">| <span class="title">help_category</span>             |</span></span><br><span class="line"><span class="function">| <span class="title">help_keyword</span>              |</span></span><br><span class="line"><span class="function">| <span class="title">help_relation</span>             |</span></span><br><span class="line"><span class="function">| <span class="title">help_topic</span>                |</span></span><br><span class="line"><span class="function">| <span class="title">innodb_index_stats</span>        |</span></span><br><span class="line"><span class="function">| <span class="title">innodb_table_stats</span>        |</span></span><br><span class="line"><span class="function">| <span class="title">password_history</span>          |</span></span><br><span class="line"><span class="function">| <span class="title">plugin</span>                    |</span></span><br><span class="line"><span class="function">| <span class="title">procs_priv</span>                |</span></span><br><span class="line"><span class="function">| <span class="title">proxies_priv</span>              |</span></span><br><span class="line"><span class="function">| <span class="title">role_edges</span>                |</span></span><br><span class="line"><span class="function">| <span class="title">server_cost</span>               |</span></span><br><span class="line"><span class="function">| <span class="title">servers</span>                   |</span></span><br><span class="line"><span class="function">| <span class="title">slave_master_info</span>         |</span></span><br><span class="line"><span class="function">| <span class="title">slave_relay_log_info</span>      |</span></span><br><span class="line"><span class="function">| <span class="title">slave_worker_info</span>         |</span></span><br><span class="line"><span class="function">| <span class="title">slow_log</span>                  |</span></span><br><span class="line"><span class="function">| <span class="title">tables_priv</span>               |</span></span><br><span class="line"><span class="function">| <span class="title">time_zone</span>                 |</span></span><br><span class="line"><span class="function">| <span class="title">time_zone_leap_second</span>     |</span></span><br><span class="line"><span class="function">| <span class="title">time_zone_name</span>            |</span></span><br><span class="line"><span class="function">| <span class="title">time_zone_transition</span>      |</span></span><br><span class="line"><span class="function">| <span class="title">time_zone_transition_type</span> |</span></span><br><span class="line"><span class="function">| <span class="title">user</span>                      |</span></span><br><span class="line"><span class="function">+---------------------------+</span></span><br><span class="line"><span class="function">33 <span class="title">rows</span> <span class="title">in</span> <span class="title">set</span> <span class="params">(0.00 sec)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">mysql</span>&gt;</span></span><br></pre></td></tr></table></figure><p>再次查询一下当前用户，看看是哪个用户，发现确实是新创建的<a href="mailto:Tom@127.0.0.1" target="_blank" rel="noopener">Tom@127.0.0.1</a>用户，这个新创建的用户下面就已经默认有一些数据库，并且数据库里默认有一些表。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> current_user;</span><br><span class="line">+---------------+</span><br><span class="line">| current_user  |</span><br><span class="line">+---------------+</span><br><span class="line">| Tom@<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> |</span><br><span class="line">+---------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>这里选择刚刚新创建的那个数据库mysql2018，做进一步操作</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use mysql2018;</span><br><span class="line">Database changed</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>查看当前所使用的数据库</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> database();</span><br><span class="line">+------------+</span><br><span class="line">| database() |</span><br><span class="line">+------------+</span><br><span class="line">| mysql2018  |</span><br><span class="line">+------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="授权当前用户拥有mysql2018这个数据库的所有权限"><a href="#授权当前用户拥有mysql2018这个数据库的所有权限" class="headerlink" title="授权当前用户拥有mysql2018这个数据库的所有权限"></a>授权当前用户拥有mysql2018这个数据库的所有权限</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; grant all privileges on mysql2018.* to Tom@<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>;</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.17</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>刷新系统权限表</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; flush privileges;</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>查看这个数据库中是否有表</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show tables;</span><br><span class="line">Empty set (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><h2 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h2><p>经查询发现这个数据库中并没有表，接下来就创建一张表</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create table student(id <span class="keyword">int</span> auto_increment primary key,name varchar(<span class="number">16</span>) not null,age <span class="keyword">int</span>,sex char(<span class="number">1</span>));</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.12</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>表名为<code>student</code>，表中有<code>id,name,age,sex</code>四个字段，其中</p><p>字段<code>id</code>为自增长，并且为主键，数据类型为<code>int</code>，<br>字段<code>name</code>的数据类型为<code>varchar</code>，最大长度为16，并且不能为空，<br>字段<code>age</code>的数据类型为<code>int</code>，<br>字段<code>sex</code>的数据类型为<code>char</code>，长度为1。</p><p>数据类型<code>char</code>的长度不可变，<code>varchar</code>的长度可变。</p><p>查看刚刚创建的表<code>student</code>的结构</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; describe student;</span><br><span class="line">+-------+-------------+------+-----+---------+----------------+</span><br><span class="line">| Field | Type        | Null | Key | Default | Extra          |</span><br><span class="line">+-------+-------------+------+-----+---------+----------------+</span><br><span class="line">| id    | <span class="keyword">int</span>(<span class="number">11</span>)     | NO   | PRI | NULL    | auto_increment |</span><br><span class="line">| name  | varchar(<span class="number">16</span>) | NO   |     | NULL    |                |</span><br><span class="line">| age   | <span class="keyword">int</span>(<span class="number">11</span>)     | YES  |     | NULL    |                |</span><br><span class="line">| sex   | char(<span class="number">1</span>)     | YES  |     | NULL    |                |</span><br><span class="line">+-------+-------------+------+-----+---------+----------------+</span><br><span class="line"><span class="number">4</span> rows in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>查看表的创建语句</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show create table student;</span><br><span class="line">+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Table   | Create Table                                                                                                                                                                                                          |</span><br><span class="line">+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| student | CREATE TABLE <span class="string">`student`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="keyword">int</span>(<span class="number">11</span>) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`name`</span> varchar(<span class="number">16</span>) NOT NULL,</span><br><span class="line">  <span class="string">`age`</span> <span class="keyword">int</span>(<span class="number">11</span>) DEFAULT NULL,</span><br><span class="line">  <span class="string">`sex`</span> char(<span class="number">1</span>) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (<span class="string">`id`</span>)</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8 |</span><br><span class="line">+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>下一节，就开始对这里创建的student表进行增删改查操作。</p><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="数据库" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="MySQL数据库" scheme="http://yoursite.com/tags/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>MySQL8.0的帮助信息</title>
    <link href="http://yoursite.com/2018/07/27/MySQL8.0%E7%9A%84%E5%B8%AE%E5%8A%A9%E4%BF%A1%E6%81%AF/"/>
    <id>http://yoursite.com/2018/07/27/MySQL8.0的帮助信息/</id>
    <published>2018-07-27T14:10:08.000Z</published>
    <updated>2018-08-24T11:48:17.386Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><h1 id="MySQL8-0的帮助信息"><a href="#MySQL8-0的帮助信息" class="headerlink" title="MySQL8.0的帮助信息"></a>MySQL8.0的帮助信息</h1><p>MySQL8.0版本相比于MySQL5.0做了很多的更改，有很多函数和字段都被删除了，因此之前网上的很多操作，现在已经不适用于8.0版本了，由于8.0版本是近期才更新的，所以对新手来说，会遇到很多的坑，而且一些坑在网上还找不到答案，所以跳坑最好的方法，就是查看MySQL自带的帮助信息，这里列出来一部分查看帮助信息的命令，以及一些帮助信息。</p><p>当然，帮助信息需要在安装MySQL8.0并登陆成功之后，才能查看得到，并且需要有一定的英语基础。</p><p>另外，跳坑最好的方法，就是不断地尝试，不断地总结，做记录。</p><h2 id="账户管理"><a href="#账户管理" class="headerlink" title="账户管理"></a>账户管理</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; help account management;</span><br><span class="line">You asked <span class="keyword">for</span> help about help category: <span class="string">"Account Management"</span></span><br><span class="line">For more information, <span class="keyword">type</span> <span class="string">'help &lt;item&gt;'</span>, where &lt;item&gt; is one of the following</span><br><span class="line">topics:</span><br><span class="line">   ALTER RESOURCE GROUP</span><br><span class="line">   ALTER USER</span><br><span class="line">   CREATE RESOURCE GROUP</span><br><span class="line">   CREATE ROLE</span><br><span class="line">   CREATE USER</span><br><span class="line">   DROP RESOURCE GROUP</span><br><span class="line">   DROP ROLE</span><br><span class="line">   DROP USER</span><br><span class="line">   GRANT</span><br><span class="line">   RENAME USER</span><br><span class="line">   REVOKE</span><br><span class="line">   SET DEFAULT ROLE</span><br><span class="line">   SET PASSWORD</span><br><span class="line">   SET RESOURCE GROUP</span><br><span class="line">   SET ROLE</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="创建用户："><a href="#创建用户：" class="headerlink" title="创建用户："></a>创建用户：</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; help create user;</span><br><span class="line">Name: <span class="string">'CREATE USER'</span></span><br><span class="line">Description:</span><br><span class="line">Syntax:</span><br><span class="line">CREATE USER [IF NOT EXISTS]</span><br><span class="line">    user [auth_option] [, user [auth_option]] ...</span><br><span class="line">    DEFAULT ROLE role [, role ] ...</span><br><span class="line">    [REQUIRE &#123;NONE | tls_option [[AND] tls_option] ...&#125;]</span><br><span class="line">    [WITH resource_option [resource_option] ...]</span><br><span class="line">    [password_option | lock_option] ...</span><br><span class="line"></span><br><span class="line">user:</span><br><span class="line">    (see )</span><br><span class="line"></span><br><span class="line">auth_option: &#123;</span><br><span class="line">    IDENTIFIED BY <span class="string">'auth_string'</span></span><br><span class="line">  | IDENTIFIED WITH auth_plugin</span><br><span class="line">  | IDENTIFIED WITH auth_plugin BY <span class="string">'auth_string'</span></span><br><span class="line">  | IDENTIFIED WITH auth_plugin AS <span class="string">'hash_string'</span></span><br><span class="line">  | IDENTIFIED BY PASSWORD <span class="string">'hash_string'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tls_option: &#123;</span><br><span class="line">   SSL</span><br><span class="line"> | X509</span><br><span class="line"> | CIPHER <span class="string">'cipher'</span></span><br><span class="line"> | ISSUER <span class="string">'issuer'</span></span><br><span class="line"> | SUBJECT <span class="string">'subject'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">resource_option: &#123;</span><br><span class="line">    MAX_QUERIES_PER_HOUR count</span><br><span class="line">  | MAX_UPDATES_PER_HOUR count</span><br><span class="line">  | MAX_CONNECTIONS_PER_HOUR count</span><br><span class="line">  | MAX_USER_CONNECTIONS count</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">password_option: &#123;</span><br><span class="line">    PASSWORD EXPIRE</span><br><span class="line">  | PASSWORD EXPIRE DEFAULT</span><br><span class="line">  | PASSWORD EXPIRE NEVER</span><br><span class="line">  | PASSWORD EXPIRE INTERVAL N DAY</span><br><span class="line">  | PASSWORD HISTORY DEFAULT</span><br><span class="line">  | PASSWORD HISTORY N</span><br><span class="line">  | PASSWORD REUSE INTERVAL DEFAULT</span><br><span class="line">  | PASSWORD REUSE INTERVAL N DAY</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">lock_option: &#123;</span><br><span class="line">    ACCOUNT LOCK</span><br><span class="line">  | ACCOUNT UNLOCK</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">The CREATE USER statement creates <span class="built_in">new</span> MySQL accounts. It enables</span><br><span class="line">authentication, SSL/TLS, resource-limit, and password-management</span><br><span class="line">properties to be established <span class="keyword">for</span> <span class="built_in">new</span> accounts, and controls whether</span><br><span class="line">accounts are initially locked or unlocked.</span><br><span class="line"></span><br><span class="line">To use CREATE USER, you must have the global CREATE USER privilege, or</span><br><span class="line">the INSERT privilege <span class="keyword">for</span> the mysql database. When the read_only system</span><br><span class="line">variable is enabled, CREATE USER additionally requires the</span><br><span class="line">CONNECTION_ADMIN or SUPER privilege.</span><br><span class="line"></span><br><span class="line">CREATE USER either succeeds <span class="keyword">for</span> all named users or rolls back and has</span><br><span class="line">no effect <span class="keyword">if</span> any error occurs. By <span class="keyword">default</span>, an error occurs <span class="keyword">if</span> you try</span><br><span class="line">to create a user that already exists. If the IF NOT EXISTS clause is</span><br><span class="line">given, the statement produces a warning <span class="keyword">for</span> each named user that</span><br><span class="line">already exists, rather than an error.</span><br><span class="line"></span><br><span class="line">The statement is written to the binary log <span class="keyword">if</span> it succeeds, but not <span class="keyword">if</span></span><br><span class="line">it fails; in that <span class="keyword">case</span>, rollback occurs and no changes are made. A</span><br><span class="line">statement written to the binary log includes all named users. If the IF</span><br><span class="line">NOT EXISTS clause is given, this includes even users that already exist</span><br><span class="line">and were not created.</span><br><span class="line"></span><br><span class="line">The statement written to the binary log specifies an authentication</span><br><span class="line">plugin <span class="keyword">for</span> each user, determined as follows:</span><br><span class="line"></span><br><span class="line">o The plugin named in the original statement, <span class="keyword">if</span> one was specified.</span><br><span class="line"></span><br><span class="line">o Otherwise, the <span class="keyword">default</span> authentication plugin. In particular, <span class="keyword">if</span> a</span><br><span class="line">  user u1 already exists and uses a nondefault authentication plugin,</span><br><span class="line">  the statement written to the binary log <span class="keyword">for</span> CREATE USER IF NOT EXISTS</span><br><span class="line">  u1 names the <span class="keyword">default</span> authentication plugin. (If the statement written</span><br><span class="line">  to the binary log must specify a nondefault authentication plugin <span class="keyword">for</span></span><br><span class="line">  a user, include it in the original statement.)</span><br><span class="line"></span><br><span class="line">If the server adds the <span class="keyword">default</span> authentication plugin <span class="keyword">for</span> any</span><br><span class="line">nonexisting users in the statement written to the binary log, it writes</span><br><span class="line">a warning to the error log naming those users.</span><br><span class="line"></span><br><span class="line">URL: http:<span class="comment">//dev.mysql.com/doc/refman/8.0/en/create-user.html</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h2><p>新的方法为</p><p><code>set password for root@localhost = &#39;123456&#39;;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; set password <span class="keyword">for</span> root@localhost = <span class="string">'123456'</span>;</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.04</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>旧的方法</p><p><code>set password for &#39;root&#39;@&#39;localhost&#39; = password (&#39;123456&#39;);</code></p><p>在MySQL8.0.11已经被删除，因为新版的MySQL已经没有password字段了，但是password函数没有被删除。  </p><h2 id="修改密码的帮助信息"><a href="#修改密码的帮助信息" class="headerlink" title="修改密码的帮助信息"></a>修改密码的帮助信息</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; help set password</span><br><span class="line">Name: <span class="string">'SET PASSWORD'</span></span><br><span class="line">Description:</span><br><span class="line">Syntax:</span><br><span class="line">SET PASSWORD [FOR user] = password_option</span><br><span class="line"></span><br><span class="line">password_option: &#123;</span><br><span class="line">    <span class="string">'auth_string'</span></span><br><span class="line">  | PASSWORD(<span class="string">'auth_string'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">The SET PASSWORD statement assigns a password to a MySQL user account.</span><br><span class="line"><span class="string">'auth_string'</span> represents a cleartext (unencrypted) password.</span><br><span class="line"></span><br><span class="line">*Note*:</span><br><span class="line"></span><br><span class="line">o SET PASSWORD ... = PASSWORD(<span class="string">'auth_string'</span>) syntax was removed in</span><br><span class="line">  MySQL <span class="number">8.0</span><span class="number">.11</span>.</span><br><span class="line"></span><br><span class="line">o Rather than using SET PASSWORD ... = <span class="string">'auth_string'</span> syntax, ALTER USER</span><br><span class="line">  syntax is the preferred statement <span class="keyword">for</span> account alterations, including</span><br><span class="line">  assigning passwords. For example:</span><br><span class="line"></span><br><span class="line">ALTER USER user IDENTIFIED BY <span class="string">'auth_string'</span>;</span><br><span class="line"></span><br><span class="line">*Important*:</span><br><span class="line"></span><br><span class="line">Under some circumstances, SET PASSWORD may be recorded in server logs</span><br><span class="line">or on the client side in a history file such as ~/.mysql_history, which</span><br><span class="line">means that cleartext passwords may be read by anyone having read access</span><br><span class="line">to that information. For information about the conditions under which</span><br><span class="line">this occurs <span class="keyword">for</span> the server logs and how to control it, see</span><br><span class="line">http:<span class="comment">//dev.mysql.com/doc/refman/8.0/en/password-logging.html. For</span></span><br><span class="line">similar information about client-side logging, see</span><br><span class="line">http:<span class="comment">//dev.mysql.com/doc/refman/8.0/en/mysql-logging.html.</span></span><br><span class="line"></span><br><span class="line">SET PASSWORD can be used with or without a FOR clause that explicitly</span><br><span class="line">names a user account:</span><br><span class="line"></span><br><span class="line">o With a FOR user clause, the statement sets the password <span class="keyword">for</span> the named</span><br><span class="line">  account, which must exist:</span><br><span class="line"></span><br><span class="line">SET PASSWORD FOR <span class="string">'jeffrey'</span>@<span class="string">'localhost'</span> = <span class="string">'auth_string'</span>;</span><br><span class="line"></span><br><span class="line">o With no FOR user clause, the statement sets the password <span class="keyword">for</span> the</span><br><span class="line">  current user:</span><br><span class="line"></span><br><span class="line">SET PASSWORD = <span class="string">'auth_string'</span>;</span><br><span class="line"></span><br><span class="line">  Any client who connects to the server using a nonanonymous account</span><br><span class="line">  can change the password <span class="keyword">for</span> that account. To see which account the</span><br><span class="line">  server authenticated you as, invoke the CURRENT_USER() function:</span><br><span class="line"></span><br><span class="line">SELECT CURRENT_USER();</span><br><span class="line"></span><br><span class="line">Setting the password <span class="keyword">for</span> a named account (with a FOR clause) requires</span><br><span class="line">the UPDATE privilege <span class="keyword">for</span> the mysql database. Setting the password <span class="keyword">for</span></span><br><span class="line">yourself (<span class="keyword">for</span> a nonanonymous account with no FOR clause) requires no</span><br><span class="line">special privileges. When the read_only system variable is enabled, SET</span><br><span class="line">PASSWORD requires the CONNECTION_ADMIN or SUPER privilege in addition</span><br><span class="line">to any other required privileges.</span><br><span class="line"></span><br><span class="line">If a FOR user clause is given, the account name uses the format</span><br><span class="line">described in http:<span class="comment">//dev.mysql.com/doc/refman/8.0/en/account-names.html.</span></span><br><span class="line">For example:</span><br><span class="line"></span><br><span class="line">SET PASSWORD FOR <span class="string">'bob'</span>@<span class="string">'%.example.org'</span> = <span class="string">'auth_string'</span>;</span><br><span class="line"></span><br><span class="line">The host name part of the account name, <span class="keyword">if</span> omitted, defaults to <span class="string">'%'</span>.</span><br><span class="line"></span><br><span class="line">SET PASSWORD interprets the <span class="keyword">string</span> as a cleartext <span class="keyword">string</span>, passes it to</span><br><span class="line">the authentication plugin associated with the account, and stores the</span><br><span class="line">result returned by the plugin in the mysql.user account row. (The</span><br><span class="line">plugin is given the opportunity to hash the value into the encryption</span><br><span class="line">format it expects. The plugin may use the value as specified, in which</span><br><span class="line"><span class="keyword">case</span> no hashing occurs.)</span><br><span class="line"></span><br><span class="line">URL: http:<span class="comment">//dev.mysql.com/doc/refman/8.0/en/set-password.html</span></span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="授权"><a href="#授权" class="headerlink" title="授权"></a>授权</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; help grant;</span><br><span class="line">Name: <span class="string">'GRANT'</span></span><br><span class="line">Description:</span><br><span class="line">Syntax:</span><br><span class="line">GRANT</span><br><span class="line">    priv_type [(column_list)]</span><br><span class="line">      [, priv_type [(column_list)]] ...</span><br><span class="line">    ON [object_type] priv_level</span><br><span class="line">    TO user_or_role [auth_option] [, user_or_role [auth_option]] ...</span><br><span class="line">    [REQUIRE &#123;NONE | tls_option [[AND] tls_option] ...&#125;]</span><br><span class="line">    [WITH &#123;GRANT OPTION | resource_option&#125; ...]</span><br><span class="line"></span><br><span class="line">GRANT PROXY ON user_or_role</span><br><span class="line">    TO user_or_role [, user_or_role] ...</span><br><span class="line">    [WITH GRANT OPTION]</span><br><span class="line"></span><br><span class="line">GRANT role [, role] ...</span><br><span class="line">    TO user_or_role [, user_or_role] ...</span><br><span class="line">    [WITH ADMIN OPTION]</span><br><span class="line"></span><br><span class="line">object_type: &#123;</span><br><span class="line">    TABLE</span><br><span class="line">  | FUNCTION</span><br><span class="line">  | PROCEDURE</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">priv_level: &#123;</span><br><span class="line">    *</span><br><span class="line">  | *.*</span><br><span class="line">  | db_name.*</span><br><span class="line">  | db_name.tbl_name</span><br><span class="line">  | tbl_name</span><br><span class="line">  | db_name.routine_name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">user_or_role: &#123;</span><br><span class="line">    user</span><br><span class="line">  | role</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">user:</span><br><span class="line">    (see http:<span class="comment">//dev.mysql.com/doc/refman/8.0/en/account-names.html)</span></span><br><span class="line"></span><br><span class="line">role:</span><br><span class="line">    (see http:<span class="comment">//dev.mysql.com/doc/refman/8.0/en/role-names.html.</span></span><br><span class="line"></span><br><span class="line">auth_option: &#123;</span><br><span class="line">    IDENTIFIED BY <span class="string">'auth_string'</span></span><br><span class="line">  | IDENTIFIED WITH auth_plugin</span><br><span class="line">  | IDENTIFIED WITH auth_plugin BY <span class="string">'auth_string'</span></span><br><span class="line">  | IDENTIFIED WITH auth_plugin AS <span class="string">'hash_string'</span></span><br><span class="line">  | IDENTIFIED BY PASSWORD <span class="string">'hash_string'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tls_option: &#123;</span><br><span class="line">    SSL</span><br><span class="line">  | X509</span><br><span class="line">  | CIPHER <span class="string">'cipher'</span></span><br><span class="line">  | ISSUER <span class="string">'issuer'</span></span><br><span class="line">  | SUBJECT <span class="string">'subject'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">resource_option: &#123;</span><br><span class="line">  | MAX_QUERIES_PER_HOUR count</span><br><span class="line">  | MAX_UPDATES_PER_HOUR count</span><br><span class="line">  | MAX_CONNECTIONS_PER_HOUR count</span><br><span class="line">  | MAX_USER_CONNECTIONS count</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">The GRANT statement enables system administrators to grant privileges</span><br><span class="line">and roles, which can be granted to user accounts and roles. These</span><br><span class="line">syntax restrictions apply:</span><br><span class="line"></span><br><span class="line">The GRANT statement enables system administrators to grant privileges</span><br><span class="line">and roles, which can be granted to user accounts and roles. These</span><br><span class="line">syntax restrictions apply:</span><br><span class="line"></span><br><span class="line">o GRANT cannot mix granting both privileges and roles in the same</span><br><span class="line">  statement. A given GRANT statement must grant either privileges or</span><br><span class="line">  roles.</span><br><span class="line"></span><br><span class="line">o The ON clause distinguishes whether the statement grants privileges</span><br><span class="line">  or roles:</span><br><span class="line"></span><br><span class="line">  o With ON, the statement grants privileges.</span><br><span class="line"></span><br><span class="line">  o Without ON, the statement grants roles.</span><br><span class="line"></span><br><span class="line">  o It is permitted to assign both privileges and roles to an account,</span><br><span class="line">    but you must use separate GRANT statements, each with syntax</span><br><span class="line">    appropriate to what is to be granted.</span><br><span class="line"></span><br><span class="line">For more information about roles, see</span><br><span class="line">http:<span class="comment">//dev.mysql.com/doc/refman/8.0/en/roles.html.</span></span><br><span class="line"></span><br><span class="line">To use GRANT, you must have the GRANT OPTION privilege, and you must</span><br><span class="line">have the privileges that you are granting. When the read_only system</span><br><span class="line">variable is enabled, GRANT additionally requires the CONNECTION_ADMIN</span><br><span class="line">or SUPER privilege.</span><br><span class="line"></span><br><span class="line">GRANT either succeeds <span class="keyword">for</span> all named users and roles or rolls back and</span><br><span class="line">has no effect <span class="keyword">if</span> any error occurs. The statement is written to the</span><br><span class="line">binary log only <span class="keyword">if</span> it succeeds <span class="keyword">for</span> all named users and roles.</span><br><span class="line"></span><br><span class="line">The REVOKE statement is related to GRANT and enables administrators to</span><br><span class="line">remove account privileges. See [HELP REVOKE].</span><br><span class="line"></span><br><span class="line">Each account name uses the format described in</span><br><span class="line">http:<span class="comment">//dev.mysql.com/doc/refman/8.0/en/account-names.html. Each role</span></span><br><span class="line">name uses the format described in</span><br><span class="line">http:<span class="comment">//dev.mysql.com/doc/refman/8.0/en/role-names.html. For example:</span></span><br><span class="line"></span><br><span class="line">GRANT ALL ON db1.* TO <span class="string">'jeffrey'</span>@<span class="string">'localhost'</span>;</span><br><span class="line">GRANT <span class="string">'role1'</span>, <span class="string">'role2'</span> TO <span class="string">'user1'</span>@<span class="string">'localhost'</span>, <span class="string">'user2'</span>@<span class="string">'localhost'</span>;</span><br><span class="line">GRANT SELECT ON world.* TO <span class="string">'role3'</span>;</span><br><span class="line"></span><br><span class="line">The host name part of the account or role name, <span class="keyword">if</span> omitted, defaults to</span><br><span class="line"><span class="string">'%'</span>.</span><br><span class="line"></span><br><span class="line">Normally, a database administrator first uses CREATE USER to create an</span><br><span class="line">account and define its nonprivilege characteristics such as its</span><br><span class="line">password, whether it uses secure connections, and limits on access to</span><br><span class="line">server resources, then uses GRANT to define its privileges. ALTER USER</span><br><span class="line">may be used to change the nonprivilege characteristics of existing</span><br><span class="line">accounts. For example:</span><br><span class="line"></span><br><span class="line">CREATE USER <span class="string">'jeffrey'</span>@<span class="string">'localhost'</span> IDENTIFIED BY <span class="string">'password'</span>;</span><br><span class="line">GRANT ALL ON db1.* TO <span class="string">'jeffrey'</span>@<span class="string">'localhost'</span>;</span><br><span class="line">GRANT SELECT ON db2.invoice TO <span class="string">'jeffrey'</span>@<span class="string">'localhost'</span>;</span><br><span class="line">ALTER USER <span class="string">'jeffrey'</span>@<span class="string">'localhost'</span> WITH MAX_QUERIES_PER_HOUR <span class="number">90</span>;</span><br><span class="line"></span><br><span class="line">*Note*:</span><br><span class="line"></span><br><span class="line">As of MySQL <span class="number">8.0</span><span class="number">.11</span>, GRANT is used only <span class="keyword">for</span> defining account privileges.</span><br><span class="line">the REQUIRE clause, WITH clause as used <span class="keyword">for</span> setting resource limits,</span><br><span class="line">and the IDENTIFIED clause have been removed, and it is no longer</span><br><span class="line">possible to use GRANT to modify nonprivilege account characteristics.</span><br><span class="line">This includes using GRANT to create accounts or specify characteristics</span><br><span class="line">such as passwords, whether accounts use secure connections, and limits</span><br><span class="line">on access to server resources. Instead, perform these tasks using</span><br><span class="line">CREATE USER or ALTER USER.</span><br><span class="line"></span><br><span class="line">From the mysql program, GRANT responds with Query OK, <span class="number">0</span> rows affected</span><br><span class="line">when executed successfully. To determine what privileges result from</span><br><span class="line">the operation, use SHOW GRANTS. See [HELP SHOW GRANTS].</span><br><span class="line"></span><br><span class="line">URL: http:<span class="comment">//dev.mysql.com/doc/refman/8.0/en/grant.html</span></span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="数据库和创建数据库"><a href="#数据库和创建数据库" class="headerlink" title="数据库和创建数据库"></a>数据库和创建数据库</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; help databases;</span><br><span class="line">Many help items <span class="keyword">for</span> your request exist.</span><br><span class="line">To <span class="built_in">make</span> a more specific request, please <span class="keyword">type</span> <span class="string">'help &lt;item&gt;'</span>,</span><br><span class="line">where &lt;item&gt; is one of the following</span><br><span class="line">topics:</span><br><span class="line">   SHOW</span><br><span class="line">   SHOW DATABASES</span><br><span class="line"></span><br><span class="line">mysql&gt; help create database;</span><br><span class="line">Name: <span class="string">'CREATE DATABASE'</span></span><br><span class="line">Description:</span><br><span class="line">Syntax:</span><br><span class="line">CREATE &#123;DATABASE | SCHEMA&#125; [IF NOT EXISTS] db_name</span><br><span class="line">    [create_specification] ...</span><br><span class="line"></span><br><span class="line">create_specification:</span><br><span class="line">    [DEFAULT] CHARACTER SET [=] charset_name</span><br><span class="line">  | [DEFAULT] COLLATE [=] collation_name</span><br><span class="line"></span><br><span class="line">CREATE DATABASE creates a database with the given name. To use this</span><br><span class="line">statement, you need the CREATE privilege <span class="keyword">for</span> the database. CREATE</span><br><span class="line">SCHEMA is a synonym <span class="keyword">for</span> CREATE DATABASE.</span><br><span class="line"></span><br><span class="line">URL: http:<span class="comment">//dev.mysql.com/doc/refman/8.0/en/create-database.html</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; help create table;</span><br><span class="line">Name: <span class="string">'CREATE TABLE'</span></span><br><span class="line">Description:</span><br><span class="line">Syntax:</span><br><span class="line">CREATE [TEMPORARY] TABLE [IF NOT EXISTS] tbl_name</span><br><span class="line">    (create_definition,...)</span><br><span class="line">    [table_options]</span><br><span class="line">    [partition_options]</span><br><span class="line"></span><br><span class="line">CREATE [TEMPORARY] TABLE [IF NOT EXISTS] tbl_name</span><br><span class="line">    [(create_definition,...)]</span><br><span class="line">    [table_options]</span><br><span class="line">    [partition_options]</span><br><span class="line">    [IGNORE | REPLACE]</span><br><span class="line">    [AS] query_expression</span><br><span class="line"></span><br><span class="line">CREATE [TEMPORARY] TABLE [IF NOT EXISTS] tbl_name</span><br><span class="line">    &#123; LIKE old_tbl_name | (LIKE old_tbl_name) &#125;</span><br><span class="line"></span><br><span class="line">create_definition:</span><br><span class="line">    col_name column_definition</span><br><span class="line">  | [CONSTRAINT [symbol]] PRIMARY KEY [index_type] (index_col_name,...)</span><br><span class="line">      [index_option] ...</span><br><span class="line">  | &#123;INDEX|KEY&#125; [index_name] [index_type] (index_col_name,...)</span><br><span class="line">      [index_option] ...</span><br><span class="line">  | [CONSTRAINT [symbol]] UNIQUE [INDEX|KEY]</span><br><span class="line">      [index_name] [index_type] (index_col_name,...)</span><br><span class="line">      [index_option] ...</span><br><span class="line">  | &#123;FULLTEXT|SPATIAL&#125; [INDEX|KEY] [index_name] (index_col_name,...)</span><br><span class="line">      [index_option] ...</span><br><span class="line">  | [CONSTRAINT [symbol]] FOREIGN KEY</span><br><span class="line">      [index_name] (index_col_name,...) reference_definition</span><br><span class="line">  | CHECK (expr)</span><br><span class="line"></span><br><span class="line">column_definition:</span><br><span class="line">    data_type [NOT NULL | NULL] [DEFAULT default_value]</span><br><span class="line">      [AUTO_INCREMENT] [UNIQUE [KEY]] [[PRIMARY] KEY]</span><br><span class="line">      [COMMENT <span class="string">'string'</span>]</span><br><span class="line">      [COLUMN_FORMAT &#123;FIXED|DYNAMIC|DEFAULT&#125;]</span><br><span class="line">      [reference_definition]</span><br><span class="line">  | data_type [GENERATED ALWAYS] AS (expression)</span><br><span class="line">      [VIRTUAL | STORED] [NOT NULL | NULL]</span><br><span class="line">      [UNIQUE [KEY]] [[PRIMARY] KEY]</span><br><span class="line">      [COMMENT <span class="string">'string'</span>]</span><br><span class="line"></span><br><span class="line">data_type:</span><br><span class="line">    BIT[(length)]</span><br><span class="line">  | TINYINT[(length)] [UNSIGNED] [ZEROFILL]</span><br><span class="line">  | SMALLINT[(length)] [UNSIGNED] [ZEROFILL]</span><br><span class="line">  | MEDIUMINT[(length)] [UNSIGNED] [ZEROFILL]</span><br><span class="line">  | INT[(length)] [UNSIGNED] [ZEROFILL]</span><br><span class="line">  | INTEGER[(length)] [UNSIGNED] [ZEROFILL]</span><br><span class="line">  | BIGINT[(length)] [UNSIGNED] [ZEROFILL]</span><br><span class="line">  | REAL[(length,decimals)] [UNSIGNED] [ZEROFILL]</span><br><span class="line">  | DOUBLE[(length,decimals)] [UNSIGNED] [ZEROFILL]</span><br><span class="line">  | FLOAT[(length,decimals)] [UNSIGNED] [ZEROFILL]</span><br><span class="line">  | DECIMAL[(length[,decimals])] [UNSIGNED] [ZEROFILL]</span><br><span class="line">  | NUMERIC[(length[,decimals])] [UNSIGNED] [ZEROFILL]</span><br><span class="line">  | DATE</span><br><span class="line">  | TIME[(fsp)]</span><br><span class="line">  | TIMESTAMP[(fsp)]</span><br><span class="line">  | DATETIME[(fsp)]</span><br><span class="line">  | YEAR</span><br><span class="line">  | CHAR[(length)]</span><br><span class="line">      [CHARACTER SET charset_name] [COLLATE collation_name]</span><br><span class="line">  | VARCHAR(length)</span><br><span class="line">      [CHARACTER SET charset_name] [COLLATE collation_name]</span><br><span class="line">  | BINARY[(length)]</span><br><span class="line">  | VARBINARY(length)</span><br><span class="line">  | TINYBLOB</span><br><span class="line">  | BLOB[(length)]</span><br><span class="line">  | MEDIUMBLOB</span><br><span class="line">  | LONGBLOB</span><br><span class="line">  | TINYTEXT</span><br><span class="line">      [CHARACTER SET charset_name] [COLLATE collation_name]</span><br><span class="line">  | TEXT[(length)]</span><br><span class="line">      [CHARACTER SET charset_name] [COLLATE collation_name]</span><br><span class="line">  | MEDIUMTEXT</span><br><span class="line">      [CHARACTER SET charset_name] [COLLATE collation_name]</span><br><span class="line">  | LONGTEXT</span><br><span class="line">      [CHARACTER SET charset_name] [COLLATE collation_name]</span><br><span class="line">  | ENUM(value1,value2,value3,...)</span><br><span class="line">      [CHARACTER SET charset_name] [COLLATE collation_name]</span><br><span class="line">  | SET(value1,value2,value3,...)</span><br><span class="line">      [CHARACTER SET charset_name] [COLLATE collation_name]</span><br><span class="line">  | JSON</span><br><span class="line">  | spatial_type</span><br><span class="line"></span><br><span class="line">index_col_name:</span><br><span class="line">    col_name [(length)] [ASC | DESC]</span><br><span class="line"></span><br><span class="line">index_type:</span><br><span class="line">    USING &#123;BTREE | HASH&#125;</span><br><span class="line"></span><br><span class="line">index_option:</span><br><span class="line">    KEY_BLOCK_SIZE [=] value</span><br><span class="line">  | index_type</span><br><span class="line">  | WITH PARSER parser_name</span><br><span class="line">  | COMMENT <span class="string">'string'</span></span><br><span class="line">  | &#123;VISIBLE | INVISIBLE&#125;</span><br><span class="line"></span><br><span class="line">reference_definition:</span><br><span class="line">    REFERENCES tbl_name (index_col_name,...)</span><br><span class="line">      [MATCH FULL | MATCH PARTIAL | MATCH SIMPLE]</span><br><span class="line">      [ON DELETE reference_option]</span><br><span class="line">      [ON UPDATE reference_option]</span><br><span class="line"></span><br><span class="line">reference_option:</span><br><span class="line">    RESTRICT | CASCADE | SET NULL | NO ACTION | SET DEFAULT</span><br><span class="line"></span><br><span class="line">table_options:</span><br><span class="line">    table_option [[,] table_option] ...</span><br><span class="line"></span><br><span class="line">table_option:</span><br><span class="line">    AUTO_INCREMENT [=] value</span><br><span class="line">  | AVG_ROW_LENGTH [=] value</span><br><span class="line">  | [DEFAULT] CHARACTER SET [=] charset_name</span><br><span class="line">  | CHECKSUM [=] &#123;<span class="number">0</span> | <span class="number">1</span>&#125;</span><br><span class="line">  | [DEFAULT] COLLATE [=] collation_name</span><br><span class="line">  | COMMENT [=] <span class="string">'string'</span></span><br><span class="line">  | COMPRESSION [=] &#123;<span class="string">'ZLIB'</span>|<span class="string">'LZ4'</span>|<span class="string">'NONE'</span>&#125;</span><br><span class="line">  | CONNECTION [=] <span class="string">'connect_string'</span></span><br><span class="line">  | &#123;DATA|INDEX&#125; DIRECTORY [=] <span class="string">'absolute path to directory'</span></span><br><span class="line">  | DELAY_KEY_WRITE [=] &#123;<span class="number">0</span> | <span class="number">1</span>&#125;</span><br><span class="line">  | ENCRYPTION [=] &#123;<span class="string">'Y'</span> | <span class="string">'N'</span>&#125;</span><br><span class="line">  | ENGINE [=] engine_name</span><br><span class="line">  | INSERT_METHOD [=] &#123; NO | FIRST | LAST &#125;</span><br><span class="line">  | KEY_BLOCK_SIZE [=] value</span><br><span class="line">  | MAX_ROWS [=] value</span><br><span class="line">  | MIN_ROWS [=] value</span><br><span class="line">  | PACK_KEYS [=] &#123;<span class="number">0</span> | <span class="number">1</span> | DEFAULT&#125;</span><br><span class="line">  | PASSWORD [=] <span class="string">'string'</span></span><br><span class="line">  | ROW_FORMAT [=] &#123;DEFAULT|DYNAMIC|FIXED|COMPRESSED|REDUNDANT|COMPACT&#125;</span><br><span class="line">  | STATS_AUTO_RECALC [=] &#123;DEFAULT|<span class="number">0</span>|<span class="number">1</span>&#125;</span><br><span class="line">  | STATS_PERSISTENT [=] &#123;DEFAULT|<span class="number">0</span>|<span class="number">1</span>&#125;</span><br><span class="line">  | STATS_SAMPLE_PAGES [=] value</span><br><span class="line">  | TABLESPACE tablespace_name</span><br><span class="line">  | UNION [=] (tbl_name[,tbl_name]...)</span><br><span class="line"></span><br><span class="line">partition_options:</span><br><span class="line">    PARTITION BY</span><br><span class="line">        &#123; [LINEAR] HASH(expr)</span><br><span class="line">        | [LINEAR] KEY [ALGORITHM=&#123;<span class="number">1</span>|<span class="number">2</span>&#125;] (column_list)</span><br><span class="line">        | RANGE&#123;(expr) | COLUMNS(column_list)&#125;</span><br><span class="line">        | LIST&#123;(expr) | COLUMNS(column_list)&#125; &#125;</span><br><span class="line">    [PARTITIONS num]</span><br><span class="line">    [SUBPARTITION BY</span><br><span class="line">        &#123; [LINEAR] HASH(expr)</span><br><span class="line">        | [LINEAR] KEY [ALGORITHM=&#123;<span class="number">1</span>|<span class="number">2</span>&#125;] (column_list) &#125;</span><br><span class="line">      [SUBPARTITIONS num]</span><br><span class="line">    ]</span><br><span class="line">    [(partition_definition [, partition_definition] ...)]</span><br><span class="line"></span><br><span class="line">partition_definition:</span><br><span class="line">    PARTITION partition_name</span><br><span class="line">        [VALUES</span><br><span class="line">            &#123;LESS THAN &#123;(expr | value_list) | MAXVALUE&#125;</span><br><span class="line">            |</span><br><span class="line">            IN (value_list)&#125;]</span><br><span class="line">        [[STORAGE] ENGINE [=] engine_name]</span><br><span class="line">        [COMMENT [=] <span class="string">'string'</span> ]</span><br><span class="line">        [DATA DIRECTORY [=] <span class="string">'data_dir'</span>]</span><br><span class="line">        [INDEX DIRECTORY [=] <span class="string">'index_dir'</span>]</span><br><span class="line">        [MAX_ROWS [=] max_number_of_rows]</span><br><span class="line">        [MIN_ROWS [=] min_number_of_rows]</span><br><span class="line">        [TABLESPACE [=] tablespace_name]</span><br><span class="line">        [(subpartition_definition [, subpartition_definition] ...)]</span><br><span class="line"></span><br><span class="line">subpartition_definition:</span><br><span class="line">    SUBPARTITION logical_name</span><br><span class="line">        [[STORAGE] ENGINE [=] engine_name]</span><br><span class="line">        [COMMENT [=] <span class="string">'string'</span> ]</span><br><span class="line">        [DATA DIRECTORY [=] <span class="string">'data_dir'</span>]</span><br><span class="line">        [INDEX DIRECTORY [=] <span class="string">'index_dir'</span>]</span><br><span class="line">        [MAX_ROWS [=] max_number_of_rows]</span><br><span class="line">        [MIN_ROWS [=] min_number_of_rows]</span><br><span class="line">        [TABLESPACE [=] tablespace_name]</span><br><span class="line"></span><br><span class="line">query_expression:</span><br><span class="line">    SELECT ...   (Some valid <span class="keyword">select</span> or union statement)</span><br><span class="line"></span><br><span class="line">CREATE TABLE creates a table with the given name. You must have the</span><br><span class="line">CREATE privilege <span class="keyword">for</span> the table.</span><br><span class="line"></span><br><span class="line">By <span class="keyword">default</span>, tables are created in the <span class="keyword">default</span> database, using the</span><br><span class="line">InnoDB storage engine. An error occurs <span class="keyword">if</span> the table exists, <span class="keyword">if</span> there is</span><br><span class="line">no <span class="keyword">default</span> database, or <span class="keyword">if</span> the database does not exist.</span><br><span class="line"></span><br><span class="line">For information about the physical representation of a table, see</span><br><span class="line">http:<span class="comment">//dev.mysql.com/doc/refman/8.0/en/create-table-files.html.</span></span><br><span class="line"></span><br><span class="line">URL: http:<span class="comment">//dev.mysql.com/doc/refman/8.0/en/create-table.html</span></span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="数据库" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="MySQL数据库" scheme="http://yoursite.com/tags/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>Mac安装MySQL 8.0</title>
    <link href="http://yoursite.com/2018/07/27/Mac%E5%AE%89%E8%A3%85MySQL%208.0%E7%89%88%E6%9C%AC/"/>
    <id>http://yoursite.com/2018/07/27/Mac安装MySQL 8.0版本/</id>
    <published>2018-07-27T13:29:00.000Z</published>
    <updated>2018-08-24T05:29:28.476Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><h2 id="用Homebrew安装MySQL"><a href="#用Homebrew安装MySQL" class="headerlink" title="用Homebrew安装MySQL"></a>用Homebrew安装MySQL</h2><p>打开终端，输入命令：<code>brew install mysql</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ brew install mysql</span><br><span class="line">==&gt; Downloading https:<span class="comment">//homebrew.bintray.com/bottles/mysql-8.0.12.high_sierra.bo</span></span><br><span class="line">Already downloaded: /Users/ElonJelinek/Library/Caches/Homebrew/mysql-<span class="number">-8.0</span><span class="number">.12</span>.high_sierra.bottle.tar.gz</span><br><span class="line">==&gt; Pouring mysql-<span class="number">-8.0</span><span class="number">.12</span>.high_sierra.bottle.tar.gz</span><br><span class="line">==&gt; /usr/local/Cellar/mysql/<span class="number">8.0</span><span class="number">.12</span>/bin/mysqld --initialize-insecure --user=ElonJ</span><br><span class="line">==&gt; Caveats</span><br><span class="line">We<span class="string">'ve installed your MySQL database without a root password. To secure it run:</span></span><br><span class="line"><span class="string">    mysql_secure_installation</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">MySQL is configured to only allow connections from localhost by default</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">To connect run:</span></span><br><span class="line"><span class="string">    mysql -uroot</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">To have launchd start mysql now and restart at login:</span></span><br><span class="line"><span class="string">  brew services start mysql</span></span><br><span class="line"><span class="string">Or, if you don'</span>t want/need a background service you can just run:</span><br><span class="line">  mysql.server start</span><br><span class="line">==&gt; Summary</span><br><span class="line">🍺  /usr/local/Cellar/mysql/<span class="number">8.0</span><span class="number">.12</span>: <span class="number">255</span> files, <span class="number">233.0</span>MB</span><br></pre></td></tr></table></figure><p>启动MySQL服务：<code>brew services start mysql</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ brew services start mysql</span><br><span class="line">Service <span class="string">`mysql`</span> already started, use <span class="string">`brew services restart mysql`</span> to restart.</span><br></pre></td></tr></table></figure><p>设置开机启动：<code>launchctl load ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ launchctl load ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist</span><br><span class="line">/Users/ElonJelinek/Library/LaunchAgents/homebrew.mxcl.mysql.plist: service already loaded</span><br></pre></td></tr></table></figure><p>用root用户登录MySQL：<code>mysql -uroot</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ mysql -uroot</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is <span class="number">8</span></span><br><span class="line">Server version: <span class="number">8.0</span><span class="number">.12</span> Homebrew</span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">2000</span>, <span class="number">2018</span>, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type <span class="string">'help;'</span> or <span class="string">'\h'</span> <span class="keyword">for</span> help. Type <span class="string">'\c'</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="一些简单操作，注意每一个命令都以分号-结束。"><a href="#一些简单操作，注意每一个命令都以分号-结束。" class="headerlink" title="一些简单操作，注意每一个命令都以分号;结束。"></a>一些简单操作，注意每一个命令都以分号<code>;</code>结束。</h2><p>查看版本：<code>select version();</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> version();</span><br><span class="line">+-----------+</span><br><span class="line">| version() |</span><br><span class="line">+-----------+</span><br><span class="line">| <span class="number">8.0</span><span class="number">.12</span>    |</span><br><span class="line">+-----------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p>查看当前时间：<code>select now();</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> now();</span><br><span class="line">+---------------------+</span><br><span class="line">| now()               |</span><br><span class="line">+---------------------+</span><br><span class="line">| <span class="number">2018</span><span class="number">-07</span><span class="number">-27</span> <span class="number">19</span>:<span class="number">45</span>:<span class="number">13</span> |</span><br><span class="line">+---------------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p>查看所有的数据库：<code>show databases;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line"><span class="number">4</span> rows in set (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p>查看当前所进入的数据库，即当前正在使用的数据库：<code>select database();</code>  由于当前没有进入任何一个数据库，所以结果为<strong>null</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> database();</span><br><span class="line">+------------+</span><br><span class="line">| database() |</span><br><span class="line">+------------+</span><br><span class="line">| NULL       |</span><br><span class="line">+------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p>查看数据库中的表：<code>show tables;</code>  由于当前并没有进入任何一个数据库，所以查不到表</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show tables;</span><br><span class="line">ERROR <span class="number">1046</span> (<span class="number">3</span>D000): No database selected</span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>修改root用户密码：<code>ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED WITH mysql_native_password BY &#39;123456&#39;;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER USER <span class="string">'root'</span>@<span class="string">'localhost'</span> IDENTIFIED WITH mysql_native_password BY <span class="string">'123456'</span>;</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure><p>退出：<code>exit</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; exit</span><br><span class="line">Bye</span><br><span class="line">ElonJelinek:~ ElonJelinek$</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">重新登录，此时已经为root用户设置了密码：123456，因此，用用户名加密码方式登录：</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span>mysql -u root -p<span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">回车后，输入密码`</span><span class="number">123456</span><span class="string">`  </span></span><br><span class="line"><span class="string">（这里并不显示输入的密码，直接输入123456并回车就OK。）</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span><span class="keyword">go</span></span><br><span class="line">ElonJelinek:~ ElonJelinek$ mysql -u root -p </span><br><span class="line">Enter password: </span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is <span class="number">13</span></span><br><span class="line">Server version: <span class="number">8.0</span><span class="number">.12</span> Homebrew</span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">2000</span>, <span class="number">2018</span>, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type <span class="string">'help;'</span> or <span class="string">'\h'</span> <span class="keyword">for</span> help. Type <span class="string">'\c'</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><h2 id="选择一个数据库"><a href="#选择一个数据库" class="headerlink" title="选择一个数据库"></a>选择一个数据库</h2><p>首次安装后，会有四个数据库，这里我们选择mysql这个库</p><p><code>use mysql;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use mysql;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; <span class="keyword">select</span> database();</span><br><span class="line">+------------+</span><br><span class="line">| database() |</span><br><span class="line">+------------+</span><br><span class="line">| mysql      |</span><br><span class="line">+------------+</span><br><span class="line"><span class="number">1</span> row in set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure><p>查看mysql库里的所有表：</p><p><code>show tables;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show tables;</span><br><span class="line">+---------------------------+</span><br><span class="line">| Tables_in_mysql           |</span><br><span class="line">+---------------------------+</span><br><span class="line">| columns_priv              |</span><br><span class="line">| component                 |</span><br><span class="line">| db                        |</span><br><span class="line">| default_roles             |</span><br><span class="line">| engine_cost               |</span><br><span class="line">| <span class="function"><span class="keyword">func</span>                      |</span></span><br><span class="line"><span class="function">| <span class="title">general_log</span>               |</span></span><br><span class="line"><span class="function">| <span class="title">global_grants</span>             |</span></span><br><span class="line"><span class="function">| <span class="title">gtid_executed</span>             |</span></span><br><span class="line"><span class="function">| <span class="title">help_category</span>             |</span></span><br><span class="line"><span class="function">| <span class="title">help_keyword</span>              |</span></span><br><span class="line"><span class="function">| <span class="title">help_relation</span>             |</span></span><br><span class="line"><span class="function">| <span class="title">help_topic</span>                |</span></span><br><span class="line"><span class="function">| <span class="title">innodb_index_stats</span>        |</span></span><br><span class="line"><span class="function">| <span class="title">innodb_table_stats</span>        |</span></span><br><span class="line"><span class="function">| <span class="title">password_history</span>          |</span></span><br><span class="line"><span class="function">| <span class="title">plugin</span>                    |</span></span><br><span class="line"><span class="function">| <span class="title">procs_priv</span>                |</span></span><br><span class="line"><span class="function">| <span class="title">proxies_priv</span>              |</span></span><br><span class="line"><span class="function">| <span class="title">role_edges</span>                |</span></span><br><span class="line"><span class="function">| <span class="title">server_cost</span>               |</span></span><br><span class="line"><span class="function">| <span class="title">servers</span>                   |</span></span><br><span class="line"><span class="function">| <span class="title">slave_master_info</span>         |</span></span><br><span class="line"><span class="function">| <span class="title">slave_relay_log_info</span>      |</span></span><br><span class="line"><span class="function">| <span class="title">slave_worker_info</span>         |</span></span><br><span class="line"><span class="function">| <span class="title">slow_log</span>                  |</span></span><br><span class="line"><span class="function">| <span class="title">tables_priv</span>               |</span></span><br><span class="line"><span class="function">| <span class="title">time_zone</span>                 |</span></span><br><span class="line"><span class="function">| <span class="title">time_zone_leap_second</span>     |</span></span><br><span class="line"><span class="function">| <span class="title">time_zone_name</span>            |</span></span><br><span class="line"><span class="function">| <span class="title">time_zone_transition</span>      |</span></span><br><span class="line"><span class="function">| <span class="title">time_zone_transition_type</span> |</span></span><br><span class="line"><span class="function">| <span class="title">user</span>                      |</span></span><br><span class="line"><span class="function">+---------------------------+</span></span><br><span class="line"><span class="function">33 <span class="title">rows</span> <span class="title">in</span> <span class="title">set</span> <span class="params">(0.01 sec)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">mysql</span>&gt;</span></span><br></pre></td></tr></table></figure><p>默认有33张表。</p><p>本节到此结束，下一次开始进行数据库、表的增删改查。</p><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="数据库" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="MySQL数据库" scheme="http://yoursite.com/tags/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>go解析复杂json数据</title>
    <link href="http://yoursite.com/2018/05/12/go%E8%A7%A3%E6%9E%90%E5%A4%8D%E6%9D%82json%E6%95%B0%E6%8D%AE/"/>
    <id>http://yoursite.com/2018/05/12/go解析复杂json数据/</id>
    <published>2018-05-12T13:08:00.000Z</published>
    <updated>2018-09-26T11:17:56.837Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><p>用go解析多层嵌套json数据，数据来源<a href="https://api.coinmarketcap.com/v2/ticker/" target="_blank" rel="noopener">https://api.coinmarketcap.com/v2/ticker/</a><br>数据示例<br><img src="http://p83c9zj44.bkt.clouddn.com/%E6%95%B0%E6%8D%AE%E7%A4%BA%E4%BE%8B.png" alt=""></p><p>完整代码</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"encoding/json"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"log"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> coinmarketcap <span class="keyword">struct</span> &#123;</span><br><span class="line">DATA Data     <span class="string">`json:"data"`</span></span><br><span class="line">MD   Metadata <span class="string">`json:"metadata"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Metadata <span class="keyword">struct</span> &#123;</span><br><span class="line">Timestamp <span class="keyword">int</span>   <span class="string">`json:"timestamp"`</span></span><br><span class="line">Num       <span class="keyword">int</span>   <span class="string">`json:"num_cryptocurrencies"`</span></span><br><span class="line">Error     error <span class="string">`json:"error"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Coin <span class="keyword">struct</span> &#123;</span><br><span class="line">Id          <span class="keyword">int</span>     <span class="string">`json:"id"`</span></span><br><span class="line">Name        <span class="keyword">string</span>  <span class="string">`json:"name"`</span></span><br><span class="line">Symbol      <span class="keyword">string</span>  <span class="string">`json:"symbol"`</span></span><br><span class="line">Website     <span class="keyword">string</span>  <span class="string">`json:"website_slug"`</span></span><br><span class="line">Rank        <span class="keyword">int</span>     <span class="string">`json:"rank"`</span></span><br><span class="line">Circulating <span class="keyword">float32</span> <span class="string">`json:"circulating_supply"`</span></span><br><span class="line">Total       <span class="keyword">float32</span> <span class="string">`json:"total_supply"`</span></span><br><span class="line">QUotes      Quotes  <span class="string">`json:"quotes"`</span></span><br><span class="line">Update      <span class="keyword">int</span>     <span class="string">`json:"last_updated"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Data <span class="keyword">struct</span> &#123;</span><br><span class="line">COin Coin <span class="string">`json:"1027"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Quotes <span class="keyword">struct</span> &#123;</span><br><span class="line">USD Usd <span class="string">`json:"USD"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Usd <span class="keyword">struct</span> &#123;</span><br><span class="line">Price      <span class="keyword">float64</span> <span class="string">`json:"price"`</span></span><br><span class="line">Volume     <span class="keyword">float64</span> <span class="string">`json:"volume_24h"`</span></span><br><span class="line">MarketCap  <span class="keyword">float32</span> <span class="string">`json:"market_cap"`</span></span><br><span class="line">Percent1h  <span class="keyword">float32</span> <span class="string">`json:"percent_change_1h"`</span></span><br><span class="line">Percent24h <span class="keyword">float32</span> <span class="string">`json:"percent_change_24h"`</span></span><br><span class="line">Percent7d  <span class="keyword">float32</span> <span class="string">`json:"percent_change_7d"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">url := <span class="string">"https://api.coinmarketcap.com/v2/ticker/"</span></span><br><span class="line">resp, err := http.Get(url)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Println(<span class="string">"ERROR:"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> cm coinmarketcap</span><br><span class="line"><span class="comment">// 将json串反序列化到结构体cm中</span></span><br><span class="line">err = json.NewDecoder(resp.Body).Decode(&amp;cm)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Println(<span class="string">"ERROR:"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打印结构体对象cm</span></span><br><span class="line">fmt.Println(cm)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将结构体对象cm转为json串</span></span><br><span class="line">jsData, err := json.Marshal(cm)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"%s"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 打印json串</span></span><br><span class="line">fmt.Println(<span class="keyword">string</span>(jsData))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#123;<span class="number">1027</span> Ethereum ETH ethereum <span class="number">2</span> <span class="number">1.0217674e+08</span> <span class="number">1.0217674e+08</span> &#123;&#123;<span class="number">208.370687119</span> <span class="number">1.89967509491939e+09</span> <span class="number">2.1290637e+10</span> <span class="number">-1.21</span> <span class="number">-10.96</span> <span class="number">1.95</span>&#125;&#125; <span class="number">1537877260</span>&#125;&#125; &#123;<span class="number">1537876696</span> <span class="number">1993</span> &lt;<span class="literal">nil</span>&gt;&#125;&#125;</span><br><span class="line">&#123;<span class="string">"data"</span>:&#123;<span class="string">"1027"</span>:&#123;<span class="string">"id"</span>:<span class="number">1027</span>,<span class="string">"name"</span>:<span class="string">"Ethereum"</span>,<span class="string">"symbol"</span>:<span class="string">"ETH"</span>,<span class="string">"website_slug"</span>:<span class="string">"ethereum"</span>,<span class="string">"rank"</span>:<span class="number">2</span>,<span class="string">"circulating_supply"</span>:<span class="number">102176740</span>,<span class="string">"total_supply"</span>:<span class="number">102176740</span>,<span class="string">"quotes"</span>:&#123;<span class="string">"USD"</span>:&#123;<span class="string">"price"</span>:<span class="number">208.370687119</span>,<span class="string">"volume_24h"</span>:<span class="number">1899675094.91939</span>,<span class="string">"market_cap"</span>:<span class="number">21290637000</span>,<span class="string">"percent_change_1h"</span>:<span class="number">-1.21</span>,<span class="string">"percent_change_24h"</span>:<span class="number">-10.96</span>,<span class="string">"percent_change_7d"</span>:<span class="number">1.95</span>&#125;&#125;,<span class="string">"last_updated"</span>:<span class="number">1537877260</span>&#125;&#125;,<span class="string">"metadata"</span>:&#123;<span class="string">"timestamp"</span>:<span class="number">1537876696</span>,<span class="string">"num_cryptocurrencies"</span>:<span class="number">1993</span>,<span class="string">"error"</span>:null&#125;&#125;</span><br></pre></td></tr></table></figure><h5 id="另一种写法"><a href="#另一种写法" class="headerlink" title="另一种写法"></a>另一种写法</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"encoding/json"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"io/ioutil"</span></span><br><span class="line"><span class="string">"log"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> coinmarketcap <span class="keyword">struct</span> &#123;</span><br><span class="line">DATA Data     <span class="string">`json:"data"`</span></span><br><span class="line">MD   Metadata <span class="string">`json:"metadata"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Metadata <span class="keyword">struct</span> &#123;</span><br><span class="line">Timestamp <span class="keyword">int</span>   <span class="string">`json:"timestamp"`</span></span><br><span class="line">Num       <span class="keyword">int</span>   <span class="string">`json:"num_cryptocurrencies"`</span></span><br><span class="line">Error     error <span class="string">`json:"error"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Coin <span class="keyword">struct</span> &#123;</span><br><span class="line">Id          <span class="keyword">int</span>     <span class="string">`json:"id"`</span></span><br><span class="line">Name        <span class="keyword">string</span>  <span class="string">`json:"name"`</span></span><br><span class="line">Symbol      <span class="keyword">string</span>  <span class="string">`json:"symbol"`</span></span><br><span class="line">Website     <span class="keyword">string</span>  <span class="string">`json:"website_slug"`</span></span><br><span class="line">Rank        <span class="keyword">int</span>     <span class="string">`json:"rank"`</span></span><br><span class="line">Circulating <span class="keyword">float32</span> <span class="string">`json:"circulating_supply"`</span></span><br><span class="line">Total       <span class="keyword">float32</span> <span class="string">`json:"total_supply"`</span></span><br><span class="line">QUotes      Quotes  <span class="string">`json:"quotes"`</span></span><br><span class="line">Update      <span class="keyword">int</span>     <span class="string">`json:"last_updated"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Data <span class="keyword">struct</span> &#123;</span><br><span class="line">COin Coin <span class="string">`json:"1027"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Quotes <span class="keyword">struct</span> &#123;</span><br><span class="line">USD Usd <span class="string">`json:"USD"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Usd <span class="keyword">struct</span> &#123;</span><br><span class="line">Price      <span class="keyword">float64</span> <span class="string">`json:"price"`</span></span><br><span class="line">Volume     <span class="keyword">float64</span> <span class="string">`json:"volume_24h"`</span></span><br><span class="line">MarketCap  <span class="keyword">float32</span> <span class="string">`json:"market_cap"`</span></span><br><span class="line">Percent1h  <span class="keyword">float32</span> <span class="string">`json:"percent_change_1h"`</span></span><br><span class="line">Percent24h <span class="keyword">float32</span> <span class="string">`json:"percent_change_24h"`</span></span><br><span class="line">Percent7d  <span class="keyword">float32</span> <span class="string">`json:"percent_change_7d"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">url := <span class="string">"https://api.coinmarketcap.com/v2/ticker/"</span></span><br><span class="line">resp, err := http.Get(url)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Println(<span class="string">"ERROR:"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> cm coinmarketcap</span><br><span class="line"><span class="comment">// 解析HTTP响应</span></span><br><span class="line">b, err := ioutil.ReadAll(resp.Body)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Println(<span class="string">"ERROR:"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将解析到的byte数组，反序列化到结构体对象中</span></span><br><span class="line">err = json.Unmarshal(b, &amp;cm)</span><br><span class="line"><span class="comment">// 打印结构体对象</span></span><br><span class="line">fmt.Println(cm)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 再将结构体对象转为json串</span></span><br><span class="line">jsData, err := json.Marshal(cm)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"%s"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 打印json串</span></span><br><span class="line">fmt.Println(<span class="keyword">string</span>(jsData))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#123;<span class="number">1027</span> Ethereum ETH ethereum <span class="number">2</span> <span class="number">1.0217727e+08</span> <span class="number">1.0217727e+08</span> &#123;&#123;<span class="number">210.279432658</span> <span class="number">1.92356647022044e+09</span> <span class="number">2.1485779e+10</span> <span class="number">1.19</span> <span class="number">-10.19</span> <span class="number">2.56</span>&#125;&#125; <span class="number">1537879535</span>&#125;&#125; &#123;<span class="number">1537878974</span> <span class="number">1993</span> &lt;<span class="literal">nil</span>&gt;&#125;&#125;</span><br><span class="line">&#123;<span class="string">"data"</span>:&#123;<span class="string">"1027"</span>:&#123;<span class="string">"id"</span>:<span class="number">1027</span>,<span class="string">"name"</span>:<span class="string">"Ethereum"</span>,<span class="string">"symbol"</span>:<span class="string">"ETH"</span>,<span class="string">"website_slug"</span>:<span class="string">"ethereum"</span>,<span class="string">"rank"</span>:<span class="number">2</span>,<span class="string">"circulating_supply"</span>:<span class="number">102177270</span>,<span class="string">"total_supply"</span>:<span class="number">102177270</span>,<span class="string">"quotes"</span>:&#123;<span class="string">"USD"</span>:&#123;<span class="string">"price"</span>:<span class="number">210.279432658</span>,<span class="string">"volume_24h"</span>:<span class="number">1923566470.22044</span>,<span class="string">"market_cap"</span>:<span class="number">21485779000</span>,<span class="string">"percent_change_1h"</span>:<span class="number">1.19</span>,<span class="string">"percent_change_24h"</span>:<span class="number">-10.19</span>,<span class="string">"percent_change_7d"</span>:<span class="number">2.56</span>&#125;&#125;,<span class="string">"last_updated"</span>:<span class="number">1537879535</span>&#125;&#125;,<span class="string">"metadata"</span>:&#123;<span class="string">"timestamp"</span>:<span class="number">1537878974</span>,<span class="string">"num_cryptocurrencies"</span>:<span class="number">1993</span>,<span class="string">"error"</span>:null&#125;&#125;</span><br></pre></td></tr></table></figure><p>这里还有一个问题没有解决，就是data的下一层，每一个标签都不一样，暂时还没想到要怎么解析这样的数据，暂时留待日后解决。</p><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="go语言" scheme="http://yoursite.com/categories/go%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="json解析" scheme="http://yoursite.com/tags/json%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>在本地网络部署super—dictionary智能合约</title>
    <link href="http://yoursite.com/2018/05/03/%E5%9C%A8localhost%E9%83%A8%E7%BD%B2super%E2%80%94dictionary%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/"/>
    <id>http://yoursite.com/2018/05/03/在localhost部署super—dictionary智能合约/</id>
    <published>2018-05-03T11:10:00.000Z</published>
    <updated>2018-07-28T10:45:10.196Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><h3 id="星云链Dapp开发系列"><a href="#星云链Dapp开发系列" class="headerlink" title="星云链Dapp开发系列"></a><a href="https://charlienike.github.io/tags/星云链Dapp开发/" target="_blank" rel="noopener">星云链Dapp开发系列</a></h3><h4 id="在本地网络（localhost）部署super-dictionary智能合约"><a href="#在本地网络（localhost）部署super-dictionary智能合约" class="headerlink" title="在本地网络（localhost）部署super-dictionary智能合约"></a>在本地网络（localhost）部署super-dictionary智能合约</h4><p>super-dictionary智能合约源码下载地址：<a href="https://github.com/15010159959/super-dictionary" target="_blank" rel="noopener">https://github.com/15010159959/super-dictionary</a></p><h6 id="1、解决本地交易网络错误问题："><a href="#1、解决本地交易网络错误问题：" class="headerlink" title="1、解决本地交易网络错误问题："></a>1、解决本地交易网络错误问题：</h6><p>进入go/src/github.com/nebulasio/go-nebulas/conf/default文件夹，打开config.conf文件，找到以下代码：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">rpc &#123;</span><br><span class="line">    rpc_listen: [<span class="string">"0.0.0.0:8684"</span>]</span><br><span class="line">    http_listen: [<span class="string">"0.0.0.0:8685"</span>]</span><br><span class="line">    http_module: [<span class="string">"api"</span>,<span class="string">"admin"</span>]</span><br><span class="line">    # HTTP CORS allowed origins</span><br><span class="line">    # http_cors: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>去掉最后一行代码的注释，并更改如下：<br><code>http_cors: [&quot;*&quot;]</code></p><h6 id="2、进入super-dictionary-master-lib文件夹："><a href="#2、进入super-dictionary-master-lib文件夹：" class="headerlink" title="2、进入super-dictionary-master/lib文件夹："></a>2、进入super-dictionary-master/lib文件夹：</h6><p>打开nebPay.js文件：<br>找到第四行代码：<br><code>var payUrl = &quot;http://18.221.150.42/api/pay&quot;;</code><br>更改为：<br><code>var payUrl = &quot;http://localhost:8685/api/pay&quot;;</code></p><h6 id="3、启动节点："><a href="#3、启动节点：" class="headerlink" title="3、启动节点："></a>3、启动节点：</h6><p>打开第一个终端窗口，启动第一个星云节点：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd $GOPATH/src/github.com/nebulasio/go-nebulas</span><br><span class="line">./neb -c conf/default/config.conf</span><br></pre></td></tr></table></figure><p>再打开一个终端窗口，启动第一个矿工节点：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd $GOPATH/src/github.com/nebulasio/go-nebulas</span><br><span class="line">./neb -c conf/example/miner.conf</span><br></pre></td></tr></table></figure><h6 id="4、部署合约："><a href="#4、部署合约：" class="headerlink" title="4、部署合约："></a>4、部署合约：</h6><p>打开web-wallet钱包，部署super-dictionary智能合约到星云链localhost网络：<br>进入web-wallet文件夹，用浏览器打开index.html文件，点击合约，再点击部署，找到super-dictionary-master/smartContract文件夹下的super-dictionary.js文件，将全部代码粘贴到合约代码框内：<br><img src="http://p83c9zj44.bkt.clouddn.com/%E9%83%A8%E7%BD%B2%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6.jpeg" alt=""><br>选择钱包文件，输入密码，点击解锁，再点击测试，<br><img src="http://p83c9zj44.bkt.clouddn.com/%E6%B5%8B%E8%AF%95.jpeg" alt=""><br>再点击提交：<br><img src="http://p83c9zj44.bkt.clouddn.com/%E6%8F%90%E4%BA%A4.jpeg" alt=""><br>保存好合约地址：<br><code>n1wfeKn7GSjo8GbAE64CgUPyxwqLrpWWLnK</code><br>点击交易哈希，查看交易状态，下图为部署成功：<br><img src="http://p83c9zj44.bkt.clouddn.com/%E9%83%A8%E7%BD%B2%E6%88%90%E5%8A%9F.png" alt=""></p><h6 id="5、执行、调用合约，与前端交互："><a href="#5、执行、调用合约，与前端交互：" class="headerlink" title="5、执行、调用合约，与前端交互："></a>5、执行、调用合约，与前端交互：</h6><p>进入super-dictionary-master文件夹，用开发工具打开index.html文件，找到第190行代码，将合约地址粘贴过来：<br><code>var dappAddress = &quot;n1wfeKn7GSjo8GbAE64CgUPyxwqLrpWWLnK&quot;;</code><br>保存后，用浏览器打开index.html文件，随便输入“比特币”一词，可以看到，没有释义，但是底下有一句话：</p><blockquote><p>Failed to find related information. Do you want to add infromation for “比特币”?</p></blockquote><p><img src="http://p83c9zj44.bkt.clouddn.com/%E6%89%A7%E8%A1%8C%E5%90%88%E7%BA%A6.jpeg" alt=""><br>并且add可以点击，点击add后可以添加释义，输入如下释义：<br>“比特币（BitCoin）的概念最初由中本聪在2009年提出，根据中本聪的思路设计发布的开源软件以及建构其上的P2P网络。比特币是一种P2P形式的数字货币。”<br><img src="http://p83c9zj44.bkt.clouddn.com/%E6%B7%BB%E5%8A%A0%E9%87%8A%E4%B9%89.jpeg" alt=""><br>点击submit，之后会弹出WebExtensionWallet钱包页面，选择localhost当地钱包文件，输入密码“passphrase”，<br><img src="http://p83c9zj44.bkt.clouddn.com/%E6%8F%90%E4%BA%A4submit.jpeg" alt=""><br>点击生成交易，<br><img src="http://p83c9zj44.bkt.clouddn.com/%E7%94%9F%E6%88%90%E4%BA%A4%E6%98%93.jpeg" alt=""><br>再点击交易确认，<br><img src="http://p83c9zj44.bkt.clouddn.com/%E4%BA%A4%E6%98%93%E7%A1%AE%E8%AE%A4.jpeg" alt=""><br>正在打包：<br><img src="http://p83c9zj44.bkt.clouddn.com/%E7%A1%AE%E8%AE%A4.jpeg" alt=""><br>交易打包成功：<br><img src="http://p83c9zj44.bkt.clouddn.com/%E9%87%8A%E4%B9%89%E6%88%90%E5%8A%9F.jpeg" alt=""><br>查询，如图所示：<br><img src="http://p83c9zj44.bkt.clouddn.com/local%E6%9F%A5%E8%AF%8D.jpeg" alt=""><br>至此，super-dictionary智能合约部署成功，前端调用合约成功。</p><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="智能合约" scheme="http://yoursite.com/categories/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/"/>
    
    
      <category term="星云链Dapp开发" scheme="http://yoursite.com/tags/%E6%98%9F%E4%BA%91%E9%93%BEDapp%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>在星云链测试网部署super-dictionary智能合约</title>
    <link href="http://yoursite.com/2018/05/02/%E5%9C%A8%E6%98%9F%E4%BA%91%E9%93%BE%E6%B5%8B%E8%AF%95%E7%BD%91%E9%83%A8%E7%BD%B2super-dictionary%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/"/>
    <id>http://yoursite.com/2018/05/02/在星云链测试网部署super-dictionary智能合约/</id>
    <published>2018-05-02T12:02:13.000Z</published>
    <updated>2018-07-28T10:44:51.844Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><h3 id="星云链Dapp开发系列"><a href="#星云链Dapp开发系列" class="headerlink" title="星云链Dapp开发系列"></a><a href="https://charlienike.github.io/tags/星云链Dapp开发/" target="_blank" rel="noopener">星云链Dapp开发系列</a></h3><h4 id="在星云链测试网部署super-dictionary智能合约"><a href="#在星云链测试网部署super-dictionary智能合约" class="headerlink" title="在星云链测试网部署super-dictionary智能合约"></a>在星云链测试网部署super-dictionary智能合约</h4><p>工具：<a href="https://www.jetbrains.com/go/?fromMenu" target="_blank" rel="noopener">Goland</a>，<a href="https://www.google.cn/chrome/" target="_blank" rel="noopener">Chrome</a>，<a href="https://github.com/ChengOrangeJu/WebExtensionWallet" target="_blank" rel="noopener">WebExtensionWallet插件钱包</a><br>super-dictionary智能合约源码下载地址：<a href="https://github.com/15010159959/super-dictionary" target="_blank" rel="noopener">https://github.com/15010159959/super-dictionary</a></p><h6 id="1、下载星云链官方钱包："><a href="#1、下载星云链官方钱包：" class="headerlink" title="1、下载星云链官方钱包："></a>1、下载星云链官方钱包：</h6><p>到GitHub的星云官方库下载web-wallet钱包<a href="https://github.com/nebulasio/web-wallet" target="_blank" rel="noopener">https://github.com/nebulasio/web-wallet</a>，<img src="http://p90jdlzej.bkt.clouddn.com/%E4%B8%8B%E8%BD%BDweb-wallet.png" alt="">用谷歌浏览器打开文件包里的index.html，点击右上角，选择testnet网络，再新建钱包，牢记密码，并下载保存好密码库文件，<img src="http://p90jdlzej.bkt.clouddn.com/%E6%96%B0%E5%BB%BA%E9%92%B1%E5%8C%85.png" alt=""><br>申请测试币<a href="https://testnet.nebulas.io/claim/" target="_blank" rel="noopener">https://testnet.nebulas.io/claim/</a></p><h6 id="2、在谷歌浏览器上安装WebExtensionWallet插件钱包，有详细安装攻略。"><a href="#2、在谷歌浏览器上安装WebExtensionWallet插件钱包，有详细安装攻略。" class="headerlink" title="2、在谷歌浏览器上安装WebExtensionWallet插件钱包，有详细安装攻略。"></a>2、在谷歌浏览器上安装<a href="https://github.com/ChengOrangeJu/WebExtensionWallet" target="_blank" rel="noopener">WebExtensionWallet插件钱包</a>，有详细安装攻略。</h6><h6 id="3、部署合约"><a href="#3、部署合约" class="headerlink" title="3、部署合约"></a>3、部署合约</h6><p>下载super-dictionary智能合约：<a href="https://github.com/15010159959/super-dictionary" target="_blank" rel="noopener">https://github.com/15010159959/super-dictionary</a><br>打开super-dictionary-master/smartcontract文件夹下的super_dictionary.js文件，复制全部代码，打开web-wallet文件夹里的index.html文件，点击右上角选择Testnet测试网络，点击合约——部署，粘贴全部代码到合约部署框内，<img src="http://p90jdlzej.bkt.clouddn.com/%E9%83%A8%E7%BD%B2%E5%90%88%E7%BA%A6.png" alt=""><br>选择钱包文件，输入密码，点击解锁，<img src="http://p90jdlzej.bkt.clouddn.com/%E6%89%93%E5%BC%80%E9%92%B1%E5%8C%85.png" alt=""><br>再点击测试，后点击提交，保存好交易哈希和合约地址。<br>合约地址：<br><code>n1vPTmFsXNGCjZ3Dmf2ngEEyUeut7pqebaJ</code><br>用goland开发工具打开super-dictionary-master文件夹下的index.html，找到第190行，把合约地址粘贴过去并保存：<br><code>var dappAddress = &quot;n1vPTmFsXNGCjZ3Dmf2ngEEyUeut7pqebaJ&quot;;</code></p><h6 id="4、执行合约："><a href="#4、执行合约：" class="headerlink" title="4、执行合约："></a>4、执行合约：</h6><p>用谷歌浏览器打开super-dictionary-master文件夹下的index.html，点击浏览器右上角的插件钱包，选择Testnet测试网络，<img src="http://p90jdlzej.bkt.clouddn.com/%E9%92%B1%E5%8C%85%E7%BD%91%E7%BB%9C%E7%B1%BB%E5%9E%8B.png" alt=""><br>搜索“金庸”，<img src="http://p90jdlzej.bkt.clouddn.com/%E7%82%B9%E5%87%BB%E6%90%9C%E7%B4%A2.png" alt=""><br>可以看到没有释义，而输入框下面出现一句话，<br><code>Failed to find related information. Do you want to add infromation for “金庸”?</code><br>点击add添加释义，<img src="http://p90jdlzej.bkt.clouddn.com/%E6%90%9C%E7%B4%A2%E5%90%8E.png" alt=""><br><img src="http://p90jdlzej.bkt.clouddn.com/%E5%A1%AB%E5%86%99value.png" alt=""><br>点击submit提交后，就会弹出插件钱包，<img src="http://p90jdlzej.bkt.clouddn.com/%E7%82%B9%E5%87%BBsubmit%EF%BC%88text%EF%BC%89.jpeg" alt=""><br>选择钱包，输入密码，<img src="http://p90jdlzej.bkt.clouddn.com/点击解锁（text）.jpeg" alt=""><img src="http://p90jdlzej.bkt.clouddn.com/%E7%82%B9%E5%87%BB%E8%A7%A3%E9%94%81%E4%B8%8B%E5%8D%8A%E6%AE%B5%EF%BC%88text%EF%BC%89.jpeg" alt="">,<br>点击生成交易，<img src="http://p90jdlzej.bkt.clouddn.com/%E7%82%B9%E5%87%BB%E7%94%9F%E6%88%90%E4%BA%A4%E6%98%93%EF%BC%88text%EF%BC%89.jpeg" alt="">点击确认，<img src="http://p90jdlzej.bkt.clouddn.com/%E7%82%B9%E5%87%BB%E7%A1%AE%E8%AE%A4.jpeg" alt=""><br>大概一分钟后，交易成功，<img src="http://p90jdlzej.bkt.clouddn.com/%E4%BA%A4%E6%98%93%E6%88%90%E5%8A%9F%EF%BC%88text%EF%BC%89.jpeg" alt="">最后再次查询“金庸“，已经有了释义，<img src="http://p90jdlzej.bkt.clouddn.com/%E6%9C%80%E5%90%8E%E6%9F%A5%E8%AF%A2.png" alt=""><br>如此，合约部署成功。执行合约成功。</p><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="智能合约" scheme="http://yoursite.com/categories/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/"/>
    
    
      <category term="星云链Dapp开发" scheme="http://yoursite.com/tags/%E6%98%9F%E4%BA%91%E9%93%BEDapp%E5%BC%80%E5%8F%91/"/>
    
      <category term="super-dictionary智能合约" scheme="http://yoursite.com/tags/super-dictionary%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/"/>
    
  </entry>
  
  <entry>
    <title>shell脚本语言</title>
    <link href="http://yoursite.com/2018/04/29/shell%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80/"/>
    <id>http://yoursite.com/2018/04/29/shell脚本语言/</id>
    <published>2018-04-29T08:10:00.000Z</published>
    <updated>2018-09-24T07:45:37.658Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><h5 id="while循环嵌套case语句"><a href="#while循环嵌套case语句" class="headerlink" title="while循环嵌套case语句"></a>while循环嵌套case语句</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"># COUNTER=<span class="number">0</span></span><br><span class="line"># while [ $COUNTER -le <span class="number">5</span> ] ;</span><br><span class="line"># do</span><br><span class="line">#     echo $COUNTER</span><br><span class="line">#     let COUNTER++</span><br><span class="line"># done</span><br><span class="line">#</span><br><span class="line"># ========================我是调皮的分割线==========================</span><br><span class="line">#</span><br><span class="line"># echo -e <span class="string">"\n-le 和 -lt 的却别：-le表示小于等于\n"</span></span><br><span class="line"># less equal     less than</span><br><span class="line">#</span><br><span class="line"># COUNTER=<span class="number">0</span></span><br><span class="line"># while [ $COUNTER -lt <span class="number">5</span> ] ;</span><br><span class="line"># do</span><br><span class="line">#     echo $COUNTER</span><br><span class="line">#     let COUNTER++</span><br><span class="line"># done</span><br><span class="line">#</span><br><span class="line"># ========================我是调皮的分割线==========================</span><br><span class="line">#</span><br><span class="line"># echo <span class="string">'type &lt;CTRL-D&gt; to terminate'</span></span><br><span class="line"># echo -n <span class="string">'enter your most liked film: '</span>    # -n表示取消行末的换行符</span><br><span class="line"># while read FILM</span><br><span class="line"># do</span><br><span class="line">#     echo <span class="string">"Yeah! great film the $FILM"</span></span><br><span class="line"># done</span><br><span class="line">#</span><br><span class="line"># ========================我是调皮的分割线==========================</span><br><span class="line">#</span><br><span class="line">#!/bin/bash</span><br><span class="line"># 执行之后只能用组合键Ctrl+C来终止它。 </span><br><span class="line"># ========================下面是死循环，慎用！慎用！慎用！==========================</span><br><span class="line"># while :</span><br><span class="line"># do</span><br><span class="line">#     echo I love you forever</span><br><span class="line"># done</span><br><span class="line">#</span><br><span class="line"># ========================上面是死循环，慎用！慎用！慎用！==========================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#!/bin/bash</span><br><span class="line"># ========================这也是死循环，慎用！慎用！慎用！==========================</span><br><span class="line"># while <span class="literal">true</span></span><br><span class="line"># do</span><br><span class="line">    # echo I love you forever</span><br><span class="line"># done</span><br><span class="line"># ========================这也是死循环，慎用！慎用！慎用！==========================</span><br><span class="line"></span><br><span class="line">echo <span class="string">"I love you forever"</span></span><br><span class="line"></span><br><span class="line"># ========================我是调皮的分割线==========================</span><br><span class="line">while :</span><br><span class="line">do</span><br><span class="line">  echo</span><br><span class="line">  echo <span class="string">"===================="</span></span><br><span class="line">  echo <span class="string">"  1：学习九阴真经"</span></span><br><span class="line">  echo <span class="string">"  2：学习九阳真经"</span></span><br><span class="line">  echo <span class="string">"  3：学习独孤九剑"</span></span><br><span class="line">  echo <span class="string">"  q或Q：退出江湖"</span></span><br><span class="line">  echo <span class="string">"===================="</span></span><br><span class="line">  read -p <span class="string">"请选择："</span> input</span><br><span class="line">  <span class="keyword">case</span> $input in</span><br><span class="line">    <span class="number">1</span>) echo -e <span class="string">"\n\n    学习九阴真经\n"</span> ;;</span><br><span class="line">    <span class="number">2</span>) echo -e <span class="string">"\n\n    学习九阳真经\n"</span> ;;</span><br><span class="line">    <span class="number">3</span>) echo -e <span class="string">"\n\n    学习独孤九剑\n"</span> ;;</span><br><span class="line">    q | Q) exit ;;</span><br><span class="line">  esac</span><br><span class="line">  #statements</span><br><span class="line">done</span><br><span class="line"># ========================我是调皮的分割线==========================</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:Desktop ElonJelinek$ ./test.sh </span><br><span class="line">I love you forever</span><br><span class="line"></span><br><span class="line">====================</span><br><span class="line">  <span class="number">1</span>：学习九阴真经</span><br><span class="line">  <span class="number">2</span>：学习九阳真经</span><br><span class="line">  <span class="number">3</span>：学习独孤九剑</span><br><span class="line">  q或Q：退出江湖</span><br><span class="line">====================</span><br><span class="line">请选择：<span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    学习独孤九剑</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">====================</span><br><span class="line">  <span class="number">1</span>：学习九阴真经</span><br><span class="line">  <span class="number">2</span>：学习九阳真经</span><br><span class="line">  <span class="number">3</span>：学习独孤九剑</span><br><span class="line">  q或Q：退出江湖</span><br><span class="line">====================</span><br><span class="line">请选择：<span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    学习九阴真经</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">====================</span><br><span class="line">  <span class="number">1</span>：学习九阴真经</span><br><span class="line">  <span class="number">2</span>：学习九阳真经</span><br><span class="line">  <span class="number">3</span>：学习独孤九剑</span><br><span class="line">  q或Q：退出江湖</span><br><span class="line">====================</span><br><span class="line">请选择：<span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    学习九阳真经</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">====================</span><br><span class="line">  <span class="number">1</span>：学习九阴真经</span><br><span class="line">  <span class="number">2</span>：学习九阳真经</span><br><span class="line">  <span class="number">3</span>：学习独孤九剑</span><br><span class="line">  q或Q：退出江湖</span><br><span class="line">====================</span><br><span class="line">请选择：q</span><br><span class="line">ElonJelinek:Desktop ElonJelinek$</span><br></pre></td></tr></table></figure><h5 id="while循环嵌套if语句"><a href="#while循环嵌套if语句" class="headerlink" title="while循环嵌套if语句"></a>while循环嵌套if语句</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># #!/bin/bash</span><br><span class="line"># #从/etc/passwd文件中读取用户名并输出</span><br><span class="line"># oldIFS=$IFS #IFS是文件内部分隔符</span><br><span class="line"># IFS=<span class="string">":"</span>     #设置分隔符为:</span><br><span class="line"># while  read username <span class="keyword">var</span> #<span class="keyword">var</span>变量不可少</span><br><span class="line"># do</span><br><span class="line">#     echo <span class="string">"用户名:$username"</span></span><br><span class="line"># done &lt; /etc/passwd</span><br><span class="line"># IFS=$oldIFS</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#!/bin/bash</span><br><span class="line">#每隔一段时间，ping一下局域网内本机IP，</span><br><span class="line">#并把结果记录到ping.txt文件中</span><br><span class="line">while date</span><br><span class="line">do</span><br><span class="line">    ping -c5 <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> &gt;/dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> [ $? = <span class="number">0</span> ];then</span><br><span class="line">        echo OK</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        echo FAIL</span><br><span class="line">    fi</span><br><span class="line">    sleep <span class="number">6</span> #<span class="number">6</span>秒</span><br><span class="line">done &gt; ping.txt</span><br></pre></td></tr></table></figure><p>打开ping.txt，可以看到，其中记录了ping的时间和结果。</p><h5 id="for循环，求1到100的和"><a href="#for循环，求1到100的和" class="headerlink" title="for循环，求1到100的和"></a>for循环，求1到100的和</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">sum=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i in <span class="string">`seq 1 100`</span></span><br><span class="line">do</span><br><span class="line">    sum=$[$sum+$i]</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">echo $sum</span><br></pre></td></tr></table></figure><p>运行，结果为：5050</p><h5 id="while嵌套if语句"><a href="#while嵌套if语句" class="headerlink" title="while嵌套if语句"></a>while嵌套if语句</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#/bin/bash</span><br><span class="line"></span><br><span class="line">while :</span><br><span class="line">do</span><br><span class="line">read -p <span class="string">"please input a number: "</span> n</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">"$n"</span> ]</span><br><span class="line">    then</span><br><span class="line">       echo <span class="string">"输入不能为空。"</span></span><br><span class="line">       <span class="keyword">continue</span></span><br><span class="line">    fi</span><br><span class="line"></span><br><span class="line">    n1=<span class="string">`echo $n|sed 's/[0-9]//g'`</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> [ ! -z <span class="string">"$n1"</span> ]</span><br><span class="line">    then</span><br><span class="line">       echo <span class="string">"只能输入数字。"</span></span><br><span class="line">       <span class="keyword">continue</span></span><br><span class="line">    fi</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">done</span><br><span class="line">echo <span class="string">"您输入的是：$n"</span></span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:Desktop ElonJelinek$ ./test.sh </span><br><span class="line">please input a number: </span><br><span class="line">输入不能为空。</span><br><span class="line">please input a number: h</span><br><span class="line">只能输入数字。</span><br><span class="line">please input a number: <span class="number">8</span></span><br><span class="line">您输入的是：<span class="number">8</span></span><br><span class="line">ElonJelinek:Desktop ElonJelinek$</span><br></pre></td></tr></table></figure><h5 id="until循环"><a href="#until循环" class="headerlink" title="until循环"></a>until循环</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">a=<span class="number">0</span></span><br><span class="line">until [[ ! $a -lt <span class="number">10</span> ]];</span><br><span class="line">do</span><br><span class="line">    echo -e <span class="string">"$a\t"</span></span><br><span class="line">    a=<span class="string">`expr $a + 1`</span></span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:Desktop ElonJelinek$ ./test.sh </span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="number">9</span></span><br><span class="line">ElonJelinek:Desktop ElonJelinek$</span><br></pre></td></tr></table></figure><h5 id="while循环嵌套case，break跳出循环"><a href="#while循环嵌套case，break跳出循环" class="headerlink" title="while循环嵌套case，break跳出循环"></a>while循环嵌套case，break跳出循环</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">while : ;</span><br><span class="line">do</span><br><span class="line">    read -p <span class="string">"please input a number between 1 to 5: "</span> aNum</span><br><span class="line">    # read aNum</span><br><span class="line">    <span class="keyword">case</span> $aNum in</span><br><span class="line">      <span class="number">1</span>|<span class="number">2</span>|<span class="number">3</span>|<span class="number">4</span>|<span class="number">5</span>) echo <span class="string">"Your number is $aNum"</span> ;;</span><br><span class="line">      *) echo <span class="string">"You do not select a number between 1 to 5,game over."</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">      ;;</span><br><span class="line">    esac</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:Desktop ElonJelinek$ ./test.sh </span><br><span class="line">please input a number between <span class="number">1</span> to <span class="number">5</span>: <span class="number">3</span></span><br><span class="line">Your number is <span class="number">3</span></span><br><span class="line">please input a number between <span class="number">1</span> to <span class="number">5</span>: <span class="number">5</span></span><br><span class="line">Your number is <span class="number">5</span></span><br><span class="line">please input a number between <span class="number">1</span> to <span class="number">5</span>: <span class="number">0</span></span><br><span class="line">You do not <span class="keyword">select</span> a number between <span class="number">1</span> to <span class="number">5</span>,game over.</span><br><span class="line">ElonJelinek:Desktop ElonJelinek$</span><br></pre></td></tr></table></figure><h5 id="break跳出for循环"><a href="#break跳出for循环" class="headerlink" title="break跳出for循环"></a>break跳出for循环</h5><p>break后面可以跟整数，表示跳出第几层循环</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> var1 in <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line">do</span><br><span class="line">   <span class="keyword">for</span> var2 in <span class="number">0</span> <span class="number">5</span></span><br><span class="line">   do</span><br><span class="line">      <span class="keyword">if</span> [ $var1 -eq <span class="number">3</span> -a $var2 -eq <span class="number">0</span> ]</span><br><span class="line">      then</span><br><span class="line">         <span class="keyword">break</span> <span class="number">2</span></span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">         echo <span class="string">"$var1 $var2"</span></span><br><span class="line">      fi</span><br><span class="line">   done</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:Desktop ElonJelinek$ ./test.sh </span><br><span class="line"><span class="number">1</span> <span class="number">0</span></span><br><span class="line"><span class="number">1</span> <span class="number">5</span></span><br><span class="line"><span class="number">2</span> <span class="number">0</span></span><br><span class="line"><span class="number">2</span> <span class="number">5</span></span><br><span class="line">ElonJelinek:Desktop ElonJelinek$</span><br></pre></td></tr></table></figure><h5 id="continue跳过当前循环"><a href="#continue跳过当前循环" class="headerlink" title="continue跳过当前循环"></a>continue跳过当前循环</h5><p>continue后面也可以跟整数，表示跳过第几层循环</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line"></span><br><span class="line">NUMS=<span class="string">"1 2 3 4 5 6 7"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> NUM in $NUMS</span><br><span class="line">do</span><br><span class="line">   Q=<span class="string">`expr $NUM % 2`</span></span><br><span class="line">   <span class="keyword">if</span> [[ $Q -eq <span class="number">0</span> ]];</span><br><span class="line">   then</span><br><span class="line">   echo <span class="string">"$NUM Number is an even number!!"</span></span><br><span class="line">   <span class="keyword">continue</span></span><br><span class="line">   fi</span><br><span class="line">   echo <span class="string">"Found odd number"</span></span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:Desktop ElonJelinek$ ./test.sh </span><br><span class="line">Found odd number</span><br><span class="line"><span class="number">2</span> Number is an even number!!</span><br><span class="line">Found odd number</span><br><span class="line"><span class="number">4</span> Number is an even number!!</span><br><span class="line">Found odd number</span><br><span class="line"><span class="number">6</span> Number is an even number!!</span><br><span class="line">Found odd number</span><br><span class="line">ElonJelinek:Desktop ElonJelinek$</span><br></pre></td></tr></table></figure><h5 id="shell函数"><a href="#shell函数" class="headerlink" title="shell函数"></a>shell函数</h5><p>函数调用不需要括号，函数的返回值只能是数字。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Hello () &#123;</span><br><span class="line">    echo <span class="string">"流水今日，明月前身。"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Hello</span><br><span class="line">Hello</span><br><span class="line"></span><br><span class="line">funWithReturn()&#123;</span><br><span class="line">    echo <span class="string">"The function is to get the sum of two number..."</span></span><br><span class="line">    echo <span class="string">"Input first number: "</span></span><br><span class="line">    read numA</span><br><span class="line">    echo <span class="string">"Input second number: "</span></span><br><span class="line">    read numB</span><br><span class="line">    echo <span class="string">"The two numbers are $numA and $numB !"</span></span><br><span class="line">    <span class="keyword">return</span> $(($numA+$numB))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">funWithReturn</span><br><span class="line"></span><br><span class="line">ret=$?</span><br><span class="line">echo <span class="string">"The sum of two numbers is $ret !"</span></span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:Desktop ElonJelinek$ ./test.sh </span><br><span class="line">流水今日，明月前身。</span><br><span class="line">流水今日，明月前身。</span><br><span class="line">The function is to get the sum of two number...</span><br><span class="line">Input first number: </span><br><span class="line"><span class="number">3</span></span><br><span class="line">Input second number: </span><br><span class="line"><span class="number">5</span></span><br><span class="line">The two numbers are <span class="number">3</span> and <span class="number">5</span> !</span><br><span class="line">The sum of two numbers is <span class="number">8</span> !</span><br><span class="line">ElonJelinek:Desktop ElonJelinek$</span><br></pre></td></tr></table></figure><h5 id="函数嵌套调用"><a href="#函数嵌套调用" class="headerlink" title="函数嵌套调用"></a>函数嵌套调用</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fun1() &#123;</span><br><span class="line">    echo -n <span class="string">"人生几回伤往事，"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun2() &#123;</span><br><span class="line">    fun1</span><br><span class="line">    echo <span class="string">"山形依旧枕寒流。"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun2</span><br></pre></td></tr></table></figure><p>运行结果，-n表示取消行末的换行符</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:Desktop ElonJelinek$ ./test.sh </span><br><span class="line">人生几回伤往事，山形依旧枕寒流。</span><br><span class="line">ElonJelinek:Desktop ElonJelinek$</span><br></pre></td></tr></table></figure><p>取消函数设置：<code>unset 函数名</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">fun1() &#123;</span><br><span class="line">    echo -n <span class="string">"人生几回伤往事，"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun2() &#123;</span><br><span class="line">    fun1</span><br><span class="line">    echo <span class="string">"山形依旧枕寒流。"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun2</span><br><span class="line"></span><br><span class="line">unset fun1</span><br><span class="line">fun2</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:Desktop ElonJelinek$ ./test.sh </span><br><span class="line">人生几回伤往事，山形依旧枕寒流。</span><br><span class="line">./test.sh: line <span class="number">6</span>: fun1: command not found</span><br><span class="line">山形依旧枕寒流。</span><br><span class="line">ElonJelinek:Desktop ElonJelinek$</span><br></pre></td></tr></table></figure><h5 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">funWithParam() &#123;</span><br><span class="line">    echo <span class="string">"The value of the first parameter is $1 !"</span></span><br><span class="line">    echo <span class="string">"The value of the second parameter is $2 !"</span></span><br><span class="line">    echo <span class="string">"The value of the tenth parameter is $10 !"</span></span><br><span class="line">    echo <span class="string">"The value of the tenth parameter is $&#123;10&#125; !"</span></span><br><span class="line">    echo <span class="string">"The value of the eleventh parameter is $&#123;11&#125; !"</span></span><br><span class="line">    echo <span class="string">"The amount of the parameters is $# !"</span></span><br><span class="line">    echo <span class="string">"The string of the parameters is $* !"</span></span><br><span class="line">&#125;</span><br><span class="line">funWithParam <span class="number">19</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span> <span class="number">10</span> <span class="number">16</span></span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:Desktop ElonJelinek$ ./test.sh </span><br><span class="line">The value of the first parameter is <span class="number">19</span> !</span><br><span class="line">The value of the second parameter is <span class="number">2</span> !</span><br><span class="line">The value of the tenth parameter is <span class="number">190</span> !</span><br><span class="line">The value of the tenth parameter is <span class="number">10</span> !</span><br><span class="line">The value of the eleventh parameter is <span class="number">16</span> !</span><br><span class="line">The amount of the parameters is <span class="number">11</span> !</span><br><span class="line">The <span class="keyword">string</span> of the parameters is <span class="number">19</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span> <span class="number">10</span> <span class="number">16</span> !</span><br><span class="line">ElonJelinek:Desktop ElonJelinek$</span><br></pre></td></tr></table></figure><p>注意，10不能获取第十个参数，获取第十个参数需要{10}。当 n&gt;=10 时，需要使用 ${n} 来获取参数。</p><table><thead><tr><th>特殊变量</th><th>说明</th></tr></thead><tbody><tr><td>$#</td><td>传递给函数的参数个数。</td></tr><tr><td>$*</td><td>传给函数的所有参数，被双引号包含时，<code>&quot;$∗&quot;</code>会将所有的参数作为一个整体输出。</td></tr><tr><td>$@</td><td>与 <code>$*</code> 相同，被双引号包含时，<code>&quot;$@&quot;</code>会将参数一个个分开输出。</td></tr><tr><td>$?</td><td>函数的返回值。</td></tr></tbody></table><h5 id="输出重定向"><a href="#输出重定向" class="headerlink" title="输出重定向"></a>输出重定向</h5><p>两个箭头<code>&gt;&gt;</code>表示输出到文件末尾，一个箭头的话，会覆盖原有内容。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">who &gt; users.txt</span><br><span class="line">echo <span class="string">"I love you forever"</span> &gt;&gt; users.txt</span><br><span class="line">fun1() &#123;</span><br><span class="line">    echo <span class="string">"玉勒雕鞍游冶处"</span></span><br><span class="line">&#125;</span><br><span class="line">fun1 &gt;&gt; users.txt</span><br></pre></td></tr></table></figure><p>运行结果，终端看不到任何输出，但是当前目录下自动生成了一个users.txt文本文件，打开该文件，输出结果在文件里。<br>内容如下</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek console  Sep  <span class="number">7</span> <span class="number">09</span>:<span class="number">10</span> </span><br><span class="line">ElonJelinek ttys000  Sep <span class="number">23</span> <span class="number">10</span>:<span class="number">57</span> </span><br><span class="line">I love you forever</span><br><span class="line">玉勒雕鞍游冶处</span><br></pre></td></tr></table></figure><h5 id="shell外部脚本"><a href="#shell外部脚本" class="headerlink" title="shell外部脚本"></a>shell外部脚本</h5><p>创建第一个脚本subscript.sh，内容如下</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url=<span class="string">"http://see.xidian.edu.cn/cpp/view/2738.html"</span></span><br></pre></td></tr></table></figure><p>创建第二个脚本main.sh，内容如下</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">. ./subscript.sh</span><br><span class="line">echo $url</span><br></pre></td></tr></table></figure><p>执行脚本，过程如下</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:Desktop ElonJelinek$ touch subscript.sh</span><br><span class="line">ElonJelinek:Desktop ElonJelinek$ echo url=<span class="string">"http://see.xidian.edu.cn/cpp/view/2738.html"</span> &gt; subscript.sh </span><br><span class="line">ElonJelinek:Desktop ElonJelinek$ touch main.sh</span><br><span class="line">ElonJelinek:Desktop ElonJelinek$ open main.sh </span><br><span class="line">ElonJelinek:Desktop ElonJelinek$ bash -x main.sh </span><br><span class="line">+ . ./subscript.sh</span><br><span class="line">++ url=http:<span class="comment">//see.xidian.edu.cn/cpp/view/2738.html</span></span><br><span class="line">+ echo http:<span class="comment">//see.xidian.edu.cn/cpp/view/2738.html</span></span><br><span class="line">http:<span class="comment">//see.xidian.edu.cn/cpp/view/2738.html</span></span><br><span class="line">ElonJelinek:Desktop ElonJelinek$ sh -x main.sh </span><br><span class="line">+ . ./subscript.sh</span><br><span class="line">++ url=http:<span class="comment">//see.xidian.edu.cn/cpp/view/2738.html</span></span><br><span class="line">+ echo http:<span class="comment">//see.xidian.edu.cn/cpp/view/2738.html</span></span><br><span class="line">http:<span class="comment">//see.xidian.edu.cn/cpp/view/2738.html</span></span><br><span class="line">ElonJelinek:Desktop ElonJelinek$ ./main.sh</span><br><span class="line">-bash: ./main.sh: Permission denied</span><br><span class="line">ElonJelinek:Desktop ElonJelinek$ chmod +x main.sh </span><br><span class="line">ElonJelinek:Desktop ElonJelinek$ ./main.sh </span><br><span class="line">http:<span class="comment">//see.xidian.edu.cn/cpp/view/2738.html</span></span><br><span class="line">ElonJelinek:Desktop ElonJelinek$</span><br></pre></td></tr></table></figure><p>shell脚本语言看似简单，其实还有很多可学的内容。</p><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="脚本语言" scheme="http://yoursite.com/categories/%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="shell脚本语言" scheme="http://yoursite.com/tags/shell%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>go语言结构体对象与json串的互相转换</title>
    <link href="http://yoursite.com/2018/04/12/go%E8%A7%A3%E6%9E%90json%E6%95%B0%E6%8D%AE/"/>
    <id>http://yoursite.com/2018/04/12/go解析json数据/</id>
    <published>2018-04-12T12:55:00.000Z</published>
    <updated>2018-09-26T12:22:26.482Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><h4 id="将结构体对象转为json串"><a href="#将结构体对象转为json串" class="headerlink" title="将结构体对象转为json串"></a>将结构体对象转为json串</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"encoding/json"</span></span><br><span class="line"><span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结构体中的字段首字母必须要大写，否则解析不出来，这里相当于是json包在调用person类中的字段，所以首字母必须大写，否则为私有，外部包不可调用</span></span><br><span class="line"><span class="keyword">type</span> person <span class="keyword">struct</span> &#123;</span><br><span class="line">First       <span class="keyword">string</span></span><br><span class="line">Last        <span class="keyword">string</span></span><br><span class="line">Age         <span class="keyword">int</span></span><br><span class="line">notExported <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">p1 := person&#123;<span class="string">"James"</span>, <span class="string">"Bond"</span>, <span class="number">20</span>, <span class="number">007</span>&#125;</span><br><span class="line"><span class="comment">// os.Stdout表示标准输出，Encode是编码，将结构体对象编码为json串</span></span><br><span class="line">json.NewEncoder(os.Stdout).Encode(p1)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"First"</span>:<span class="string">"James"</span>,<span class="string">"Last"</span>:<span class="string">"Bond"</span>,<span class="string">"Age"</span>:<span class="number">20</span>&#125;</span><br></pre></td></tr></table></figure><p>这里的结果就是json串了，类似于map的key-value，中间有个冒号。</p><h4 id="结构体转json串的另一种写法"><a href="#结构体转json串的另一种写法" class="headerlink" title="结构体转json串的另一种写法"></a>结构体转json串的另一种写法</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"encoding/json"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> person <span class="keyword">struct</span> &#123;</span><br><span class="line">First       <span class="keyword">string</span></span><br><span class="line">Last        <span class="keyword">string</span></span><br><span class="line">Age         <span class="keyword">int</span></span><br><span class="line">notExported <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">p1 := person&#123;<span class="string">"James"</span>, <span class="string">"Bond"</span>, <span class="number">20</span>, <span class="number">007</span>&#125;</span><br><span class="line"><span class="comment">//json.NewEncoder(os.Stdout).Encode(p1)</span></span><br><span class="line"><span class="comment">// 另一种写法，这里Marshal函数的参数是空接口，所以可以将任何类型的数据转为json，比如struct，map，返回值为byte，也就是说可以把任何类型转为byte</span></span><br><span class="line">b, err := json.Marshal(p1)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"%s"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="keyword">string</span>(b))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"First"</span>:<span class="string">"James"</span>,<span class="string">"Last"</span>:<span class="string">"Bond"</span>,<span class="string">"Age"</span>:<span class="number">20</span>&#125;</span><br></pre></td></tr></table></figure><h4 id="将json串转为结构体"><a href="#将json串转为结构体" class="headerlink" title="将json串转为结构体"></a>将json串转为结构体</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"encoding/json"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"strings"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> person <span class="keyword">struct</span> &#123;</span><br><span class="line">First       <span class="keyword">string</span></span><br><span class="line">Last        <span class="keyword">string</span></span><br><span class="line">Age         <span class="keyword">int</span></span><br><span class="line">notExported <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> p1 person</span><br><span class="line">rdr := strings.NewReader(<span class="string">`&#123;"First":"James", "Last":"Bond", "Age":20&#125;`</span>)</span><br><span class="line"><span class="comment">//  将json串rdr解码到结构体对象p1中</span></span><br><span class="line">json.NewDecoder(rdr).Decode(&amp;p1)</span><br><span class="line"></span><br><span class="line">fmt.Println(p1)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;James Bond <span class="number">20</span> <span class="number">0</span>&#125;</span><br></pre></td></tr></table></figure><p>直接打印结构体的话，不显示字段名，而且也没有冒号，与json串明显不同。</p><h4 id="json转结构体的另一种写法"><a href="#json转结构体的另一种写法" class="headerlink" title="json转结构体的另一种写法"></a>json转结构体的另一种写法</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"encoding/json"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> person <span class="keyword">struct</span> &#123;</span><br><span class="line">First <span class="keyword">string</span></span><br><span class="line">Last  <span class="keyword">string</span></span><br><span class="line">Age   <span class="keyword">int</span> <span class="string">`json:"wisdom score"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> p1 person</span><br><span class="line">fmt.Println(p1)</span><br><span class="line"></span><br><span class="line">bs := []<span class="keyword">byte</span>(<span class="string">`&#123;"First":"James", "Last":"Bond", "wisdom score":20&#125;`</span>)</span><br><span class="line"><span class="comment">// 将byte反序列化到结构体对象p1中，这里Unmarshal的第一个参数是byte，第二个参数是空接口，但是必须传指针，包括结构体指针，map指针都可以</span></span><br><span class="line">json.Unmarshal(bs, &amp;p1)</span><br><span class="line"></span><br><span class="line">fmt.Println(<span class="keyword">string</span>(bs))</span><br><span class="line"></span><br><span class="line">fmt.Println(<span class="string">"--------------"</span>)</span><br><span class="line">fmt.Println(p1)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;  <span class="number">0</span>&#125;</span><br><span class="line">&#123;<span class="string">"First"</span>:<span class="string">"James"</span>, <span class="string">"Last"</span>:<span class="string">"Bond"</span>, <span class="string">"wisdom score"</span>:<span class="number">20</span>&#125;</span><br><span class="line">--------------</span><br><span class="line">&#123;James Bond <span class="number">20</span>&#125;</span><br></pre></td></tr></table></figure><h4 id="json标签"><a href="#json标签" class="headerlink" title="json标签"></a>json标签</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"encoding/json"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> person <span class="keyword">struct</span> &#123;</span><br><span class="line">First <span class="keyword">string</span></span><br><span class="line">Last  <span class="keyword">string</span></span><br><span class="line"><span class="comment">//Age int</span></span><br><span class="line">Age <span class="keyword">int</span> <span class="string">`json:"ageNumber"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> p1 person</span><br><span class="line">fmt.Println(p1)</span><br><span class="line"></span><br><span class="line"><span class="comment">//bs := []byte(`&#123;"First":"James", "Last":"Bond", "Age":20&#125;`)</span></span><br><span class="line"><span class="comment">//json.Unmarshal(bs, &amp;p1)</span></span><br><span class="line"></span><br><span class="line">bs := []<span class="keyword">byte</span>(<span class="string">`&#123;"First":"James", "Last":"Bond", "ageNumber":20&#125;`</span>)</span><br><span class="line">json.Unmarshal(bs, &amp;p1)</span><br><span class="line"></span><br><span class="line">fmt.Println(p1)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;  <span class="number">0</span>&#125;</span><br><span class="line">&#123;James Bond <span class="number">20</span>&#125;</span><br></pre></td></tr></table></figure><p>注意这段字母的最外面是一个特殊字符，是esc下面那个键<code>~</code>，要在英文状态下输入，不是单引号。</p><p>这里Age字段后面的<code>json:&quot;ageNumber&quot;</code>，表示json标签，也就是说json数据的冒号前面的key值，既可以是<code>Age</code>，也可以是<code>ageNumber</code>，比如下面这两个json数据类型，都可以反序列化到结构体对象中：<br><code>{&quot;First&quot;:&quot;James&quot;, &quot;Last&quot;:&quot;Bond&quot;, &quot;Age&quot;:20}</code><br><code>{&quot;First&quot;:&quot;James&quot;, &quot;Last&quot;:&quot;Bond&quot;, &quot;ageNumber&quot;:20}</code><br>效果是完全一样的。</p><p>这里只是最简单的json数据类型，实际中的json数据要复杂得多。比如这样<br><img src="http://p83c9zj44.bkt.clouddn.com/%E5%A4%8D%E6%9D%82json%E6%95%B0%E6%8D%AE2.png" alt=""><br>如何解析这样的json数据，请继续关注下一篇文章。</p><p>其次，json也可以转为map，同样的map也可以转为json。</p><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="go语言" scheme="http://yoursite.com/categories/go%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="json解析" scheme="http://yoursite.com/tags/json%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>go语言Context包</title>
    <link href="http://yoursite.com/2018/03/30/go%E8%AF%AD%E8%A8%80Context%E5%8C%85/"/>
    <id>http://yoursite.com/2018/03/30/go语言Context包/</id>
    <published>2018-03-30T06:32:18.000Z</published>
    <updated>2018-09-19T11:26:05.371Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><p>Context包定义了上下文类型，用来简化在多个goroutine传递上下文数据，终止goroutine树等操作，比如官方http包使用Context传递请求的上下文数据，gRpc使用Context来终止某个请求产生的goroutine树。</p><p>Context中的方法是协程安全的，也就是说在父goroutine中创建的Context，可以传递给任意数量的goroutine并让他们同时访问。</p><p>Context是个接口，里面有四个方法：</p><p><code>Deadline() (deadline time.Time, ok bool)</code>返回一个超时时间time.Time，是当前Context应该结束的时间，ok表示是否有deadline。goroutine获得了超时时间后，可以对某些io操作设定超时时间。</p><p><code>Done() &lt;-chan struct{}</code>返回一个struct类型的只读channel，当该Context被取消的时候，该channel会被关闭，同时对应的使用该Context的goroutine也应该结束并返回，即它是一个表示Context是否已关闭的信号。</p><p><code>Err() error</code>返回Context被取消时的错误，当Done通道关闭后，Err方法表名Context被撤销的原因。</p><p><code>Value(key interface{}) interface{}</code>是Context自带的key-value存储功能，可以让goroutine共享一些数据，并且获得数据也是协程安全的。但使用这些数据的时候要注意同步，比如返回了一个map，而这个map的读写则要加锁。</p><p>withcancel和withtimeout函数会返回继承的Context对象，这些对象可以比它们的父Context更早地取消。</p><h5 id="一个网络请求超时控制的例子"><a href="#一个网络请求超时控制的例子" class="headerlink" title="一个网络请求超时控制的例子"></a>一个网络请求超时控制的例子</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"context"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"io/ioutil"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Result <span class="keyword">struct</span> &#123;</span><br><span class="line">r   *http.Response</span><br><span class="line">err error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">process</span><span class="params">()</span></span> &#123;</span><br><span class="line">ctx, cancel := context.WithTimeout(context.Background(), <span class="number">2</span>*time.Second)</span><br><span class="line"><span class="keyword">defer</span> cancel()</span><br><span class="line">tr := &amp;http.Transport&#123;&#125;</span><br><span class="line">client := &amp;http.Client&#123;Transport: tr&#125;</span><br><span class="line">resultChan := <span class="built_in">make</span>(<span class="keyword">chan</span> Result, <span class="number">1</span>)</span><br><span class="line">req, err := http.NewRequest(<span class="string">"GET"</span>, <span class="string">"https://www.baidu.com"</span>, <span class="literal">nil</span>)</span><br><span class="line"><span class="comment">//req, err := http.NewRequest("GET", 、"http://www.google.com", nil)</span></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"http request failed,err:"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">resp, err := client.Do(req)</span><br><span class="line">pack := Result&#123;r: resp, err: err&#125;</span><br><span class="line">resultChan &lt;- pack</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> &lt;-ctx.Done():</span><br><span class="line">tr.CancelRequest(req)</span><br><span class="line">er := &lt;-resultChan</span><br><span class="line">fmt.Println(<span class="string">"Timeout!"</span>, er.err)</span><br><span class="line"><span class="keyword">case</span> res := &lt;-resultChan:</span><br><span class="line"><span class="keyword">defer</span> res.r.Body.Close()</span><br><span class="line">out, _ := ioutil.ReadAll(res.r.Body)</span><br><span class="line">fmt.Printf(<span class="string">"Server Response: %s"</span>, out)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">process()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Server Response: &lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">location.replace(location.href.replace(<span class="string">"https://"</span>,<span class="string">"http://"</span>));</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;noscript&gt;&lt;meta http-equiv="refresh" content="0;url=http://www.baidu.com/"&gt;&lt;/noscript&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>如果把请求的网址换成Google，由于不能翻墙，2秒后网络请求会被取消，并返回错误的原因：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Timeout! Get http:<span class="comment">//www.google.com: net/http: request canceled while waiting for connection</span></span><br></pre></td></tr></table></figure><h5 id="WithValue传递元数据"><a href="#WithValue传递元数据" class="headerlink" title="WithValue传递元数据"></a>WithValue传递元数据</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"context"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">process</span><span class="params">(ctx context.Context)</span></span> &#123;</span><br><span class="line">ret, ok := ctx.Value(<span class="string">"empno"</span>).(<span class="keyword">int</span>)</span><br><span class="line"><span class="keyword">if</span> !ok &#123;</span><br><span class="line">ret = <span class="number">83156789</span></span><br><span class="line">&#125;</span><br><span class="line">fmt.Printf(<span class="string">"empno:%d\n"</span>, ret)</span><br><span class="line">s, _ := ctx.Value(<span class="string">"ename"</span>).(<span class="keyword">string</span>)</span><br><span class="line">fmt.Printf(<span class="string">"ename:%s\n"</span>, s)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">ctx := context.WithValue(context.Background(), <span class="string">"empno"</span>, <span class="number">12315</span>)</span><br><span class="line">ctx = context.WithValue(ctx, <span class="string">"ename"</span>, <span class="string">"duguqiubai"</span>)</span><br><span class="line">process(ctx)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">empno:<span class="number">12315</span></span><br><span class="line">ename:duguqiubai</span><br></pre></td></tr></table></figure><h5 id="通过Context传递元数据"><a href="#通过Context传递元数据" class="headerlink" title="通过Context传递元数据"></a>通过Context传递元数据</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"context"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> key = <span class="string">"name"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">purchase</span><span class="params">(ctx context.Context)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> &lt;-ctx.Done():</span><br><span class="line">fmt.Println(ctx.Value(key), <span class="string">"抢购结束，卖完了…"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">fmt.Println(ctx.Value(key), <span class="string">"goroutine抢购中…"</span>)</span><br><span class="line">time.Sleep(<span class="number">2</span> * time.Second)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">ctx, cancel := context.WithCancel(context.Background())</span><br><span class="line">valueCtx := context.WithValue(ctx, key, <span class="string">"【黄牛1】"</span>)</span><br><span class="line"><span class="keyword">go</span> purchase(valueCtx)</span><br><span class="line">time.Sleep(<span class="number">10</span> * time.Second)</span><br><span class="line">fmt.Println(<span class="string">"卖完了，通知抢购结束"</span>)</span><br><span class="line">cancel()</span><br><span class="line"><span class="comment">// 检测抢购是否停止，如果没有输出，就表示停止了</span></span><br><span class="line">time.Sleep(<span class="number">3</span> * time.Second)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">【黄牛<span class="number">1</span>】 goroutine抢购中…</span><br><span class="line">【黄牛<span class="number">1</span>】 goroutine抢购中…</span><br><span class="line">【黄牛<span class="number">1</span>】 goroutine抢购中…</span><br><span class="line">【黄牛<span class="number">1</span>】 goroutine抢购中…</span><br><span class="line">【黄牛<span class="number">1</span>】 goroutine抢购中…</span><br><span class="line">卖完了，通知抢购结束</span><br><span class="line">【黄牛<span class="number">1</span>】 抢购结束，卖完了…</span><br></pre></td></tr></table></figure><h5 id="超时控制WithDeadline"><a href="#超时控制WithDeadline" class="headerlink" title="超时控制WithDeadline"></a>超时控制WithDeadline</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"context"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">d := time.Now().Add(<span class="number">4</span> * time.Second)</span><br><span class="line"><span class="comment">// d := time.Now().Add(2 * time.Second)</span></span><br><span class="line">ctx, cancel := context.WithDeadline(context.Background(), d)</span><br><span class="line"><span class="keyword">defer</span> cancel()</span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> &lt;-time.After(<span class="number">3</span> * time.Second):</span><br><span class="line">fmt.Println(<span class="string">"差点睡过头了"</span>)</span><br><span class="line"><span class="keyword">case</span> &lt;-ctx.Done():</span><br><span class="line">fmt.Println(ctx.Err())</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">差点睡过头了</span><br></pre></td></tr></table></figure><p>如果把第一行的时间改成2秒，就会出现超时，上下文被取消</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context deadline exceeded</span><br></pre></td></tr></table></figure><h5 id="利用Context结束goroutine"><a href="#利用Context结束goroutine" class="headerlink" title="利用Context结束goroutine"></a>利用Context结束goroutine</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"context"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个通道，启动goroutine，for循环存数据，</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">gen</span><span class="params">(ctx context.Context)</span> &lt;-<span class="title">chan</span> <span class="title">int</span></span> &#123;</span><br><span class="line">dst := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span><br><span class="line">n := <span class="number">1</span></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> &lt;-ctx.Done():</span><br><span class="line"><span class="comment">// 执行defer cancel 操作后，就会执行该select</span></span><br><span class="line">fmt.Println(<span class="string">"i exited"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line"><span class="keyword">case</span> dst &lt;- n:</span><br><span class="line">n++</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line"><span class="keyword">return</span> dst</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> &#123;</span><br><span class="line">ctx, cancel := context.WithCancel(context.Background())</span><br><span class="line"><span class="comment">// 当n==5的时候，执行defer cancel操作</span></span><br><span class="line"><span class="keyword">defer</span> cancel()</span><br><span class="line">intChan := gen(ctx)</span><br><span class="line"><span class="keyword">for</span> n := <span class="keyword">range</span> intChan &#123;</span><br><span class="line">fmt.Println(n)</span><br><span class="line"><span class="keyword">if</span> n == <span class="number">6</span> &#123;</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">test()</span><br><span class="line">time.Sleep(<span class="number">5</span> * time.Second)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line">i exited</span><br></pre></td></tr></table></figure><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="go语言" scheme="http://yoursite.com/categories/go%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="Context包" scheme="http://yoursite.com/tags/Context%E5%8C%85/"/>
    
  </entry>
  
  <entry>
    <title>求字符串最长公共子序列</title>
    <link href="http://yoursite.com/2018/03/23/%E6%B1%82%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%AD%90%E5%BA%8F%E5%88%97/"/>
    <id>http://yoursite.com/2018/03/23/求字符串最长公共子序列/</id>
    <published>2018-03-23T12:36:00.000Z</published>
    <updated>2018-09-14T12:40:02.523Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><h1 id="go语言：递归与动态规划算法求：字符串最长公共子序列"><a href="#go语言：递归与动态规划算法求：字符串最长公共子序列" class="headerlink" title="go语言：递归与动态规划算法求：字符串最长公共子序列"></a>go语言：递归与动态规划算法求：字符串最长公共子序列</h1><h2 id="动态规划算法"><a href="#动态规划算法" class="headerlink" title="动态规划算法"></a>动态规划算法</h2><p>在动态规划算法中，子问题可能是重叠的，通过使用备忘录来保存已解决的子问题的答案。对于大部分问题，动态规划能够将待求解的问题的时间复杂度由指数级降低为多项式级，如O(n^2 )、O(n^3 )等。</p><p>动态规划主要包含两个部分：</p><ol><li>递归：递归求解子问题</li><li>备忘录：将已经计算的值存储在表中</li></ol><blockquote><p>动态规划=递归+备忘录</p></blockquote><h4 id="动态规划的适用范围"><a href="#动态规划的适用范围" class="headerlink" title="动态规划的适用范围"></a>动态规划的适用范围</h4><p>动态规划不能求解所有问题，从以下两点可以判断是否适用于给定问题</p><ol><li>最优子结构：问题的最优解包含其子问题的最优解</li><li>子问题重叠：递归求解过程中包含少量不同子问题的多次重复计算</li></ol><p>动态规划与直接递归的区别在于对递归调用的备忘。如果子问题是相互独立的，不存在重叠，那么备忘录功能就没有任何作用，因此动态规划并不适用于所有问题。</p><h4 id="动态规划求最长公共子序列"><a href="#动态规划求最长公共子序列" class="headerlink" title="动态规划求最长公共子序列"></a>动态规划求最长公共子序列</h4><p>已知两个字符串，长度为m的字符串和长度为n的字符串，找出最长公共子序列：在两个字符串中从左至右均出现的最长字符序列（不一定是连续的），例如：X=”ABCBDAB”，Y=”BDCABA”，最长公共子序列LCS[X,Y]={“BCBA”，“BDAB”，“BCAB”}，所以，可能存在多个最优解。</p><p>蛮力法：一个简单的思路是检查X[1-m]中的每个子序列是否也是Y[1-n]的一个子序列。一次检查花费O(n)的时间，而X也有2^n 个子序列，那么花费的总时间为指数级O(n*2^m )。对于非常长的序列，这种方法是极为低效的。</p><h6 id="递归求解"><a href="#递归求解" class="headerlink" title="递归求解"></a>递归求解</h6><p>该问题求解过程中涉及X和Y中的两个子序列，假设X的子序列开始下标为i，Y子序列的开始下标为j，X[1…m]是一个X的从i开始到末尾的子串，Y[1…n]是一个Y从j开始到末尾的子串。由此，可能存在以下情况：</p><ol><li>如果X[i]==Y[j]，则1+LCS(i+1,j+1)。</li><li>如果X[i]!=Y[j]，则LCS(i,j+1)。跳过Y的第j个字符。</li><li>如果X[i]!=Y[j]，则LCS(i+1,j)。跳过x的第i个字符。</li></ol><p>对于第一种情况，如果X[i]等于Y[j]，则找到一个匹配对，并将其计入LCS的总长度中，否则需要跳过X的第i个字符或者Y的第j个字符，继续搜寻最长公共子序列。</p><p>递归求解法，完整代码</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> LCS [<span class="number">1024</span>][<span class="number">1024</span>]<span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">LCSlength</span><span class="params">(x <span class="keyword">string</span>, i, m <span class="keyword">int</span>, y <span class="keyword">string</span>, j, n <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> i == m || j == n &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> x[i] == y[j] &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span> + LCSlength(x, i+<span class="number">1</span>, m, y, j+<span class="number">1</span>, n)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> max(LCSlength(x, i+<span class="number">1</span>, m, y, j, n), LCSlength(x, i, m, y, j+<span class="number">1</span>, n))</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">max</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> a &gt; b &#123;</span><br><span class="line"><span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">str1 := <span class="string">"ABCBDAB"</span></span><br><span class="line">str2 := <span class="string">"BDCABA"</span></span><br><span class="line">length := LCSlength(str1, <span class="number">0</span>, <span class="built_in">len</span>(str1), str2, <span class="number">0</span>, <span class="built_in">len</span>(str2))</span><br><span class="line">fmt.Println(length)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>递归算法存在重复计算，非常耗时。如果两个字符串没有匹配的字符，那么算法总是执行最后一行代码，当m等于n时，时间复杂度接近于O(2^n )。</p><h6 id="动态规划求解法：增加备忘录"><a href="#动态规划求解法：增加备忘录" class="headerlink" title="动态规划求解法：增加备忘录"></a>动态规划求解法：增加备忘录</h6><p>递归求解的子问题被调用了多次，其中子问题对应于LCSLength函数的一次调用，共有(i+1)(j+1)个可能的子问题（一个相对较小的数）。但如果有2^n 个递归调用，那么这些子问题中的某一些必然被反复求解。</p><p>在需要求解某个子问题时，动态规划算法首先检测该子问题是否已经被解决，因此有些计算是查询而不是再次求解。</p><p>动态规划算法具体步骤</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> LCS [<span class="number">1024</span>][<span class="number">1024</span>]<span class="keyword">int</span></span><br><span class="line"><span class="comment">// 这里将每一步的执行结果都打出来，以便理解</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">LCSlength</span><span class="params">(x <span class="keyword">string</span>, m <span class="keyword">int</span>, y <span class="keyword">string</span>, n <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := m - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i-- &#123;</span><br><span class="line"><span class="keyword">for</span> j := n - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j-- &#123;</span><br><span class="line">fmt.Println(<span class="string">"LCS["</span>, i, <span class="string">"]["</span>, j, <span class="string">"]:"</span>, LCS[i][j])</span><br><span class="line">LCS[i][j] = LCS[i+<span class="number">1</span>][j+<span class="number">1</span>]</span><br><span class="line">fmt.Print(<span class="string">"LCS["</span>, i, <span class="string">"]["</span>, j, <span class="string">"] = LCS["</span>, i+<span class="number">1</span>, <span class="string">"]["</span>, j+<span class="number">1</span>, <span class="string">"]\t="</span>,LCS[i][j])</span><br><span class="line">fmt.Println()</span><br><span class="line"><span class="keyword">if</span> x[i] == y[j] &#123;</span><br><span class="line">fmt.Println(<span class="string">"x["</span>, i, <span class="string">"] == y["</span>, j, <span class="string">"]"</span>)</span><br><span class="line">fmt.Print(i, j, <span class="string">"\t"</span>, LCS[i][j], <span class="string">"\t"</span>)</span><br><span class="line">LCS[i][j]++</span><br><span class="line">fmt.Print(i, j, <span class="string">"\t"</span>, LCS[i][j], <span class="string">"\t"</span>)</span><br><span class="line">fmt.Println()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> LCS[i][j+<span class="number">1</span>] &gt; LCS[i][j] &#123;</span><br><span class="line">fmt.Println(<span class="string">"LCS["</span>, i, <span class="string">"]["</span>, j+<span class="number">1</span>, <span class="string">"] &gt; LCS["</span>, i, <span class="string">"]["</span>, j, <span class="string">"]"</span>)</span><br><span class="line">LCS[i][j] = LCS[i][j+<span class="number">1</span>]</span><br><span class="line">fmt.Print(<span class="string">"LCS["</span>, i, <span class="string">"]["</span>, j, <span class="string">"] = LCS["</span>, i, <span class="string">"]["</span>, j+<span class="number">1</span>, <span class="string">"]\t="</span>,LCS[i][j])</span><br><span class="line">fmt.Println()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> LCS[i+<span class="number">1</span>][j] &gt; LCS[i][j] &#123;</span><br><span class="line">fmt.Println(<span class="string">"LCS["</span>, i+<span class="number">1</span>, <span class="string">"]["</span>, j, <span class="string">"] &gt; LCS["</span>, i, <span class="string">"]["</span>, j, <span class="string">"]"</span>)</span><br><span class="line">LCS[i][j] = LCS[i+<span class="number">1</span>][j]</span><br><span class="line">fmt.Print(<span class="string">"LCS["</span>, i, <span class="string">"]["</span>, j, <span class="string">"] = LCS["</span>, i+<span class="number">1</span>, <span class="string">"]["</span>, j, <span class="string">"]\t="</span>,LCS[i][j])</span><br><span class="line">fmt.Println()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> LCS[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">str1 := <span class="string">"ABCBDAB"</span></span><br><span class="line">str2 := <span class="string">"BDCABA"</span></span><br><span class="line"></span><br><span class="line">n := LCSlength(str1, <span class="built_in">len</span>(str1), str2, <span class="built_in">len</span>(str2))</span><br><span class="line">fmt.Println(n)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line">LCS[ <span class="number">6</span> ][ <span class="number">5</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">6</span>][<span class="number">5</span>] = LCS[<span class="number">7</span>][<span class="number">6</span>]=<span class="number">0</span></span><br><span class="line">LCS[ <span class="number">6</span> ][ <span class="number">4</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">6</span>][<span class="number">4</span>] = LCS[<span class="number">7</span>][<span class="number">5</span>]=<span class="number">0</span></span><br><span class="line">x[ <span class="number">6</span> ] == y[ <span class="number">4</span> ]</span><br><span class="line"><span class="number">6</span> <span class="number">4</span><span class="number">0</span><span class="number">6</span> <span class="number">4</span><span class="number">1</span></span><br><span class="line">LCS[ <span class="number">6</span> ][ <span class="number">3</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">6</span>][<span class="number">3</span>] = LCS[<span class="number">7</span>][<span class="number">4</span>]=<span class="number">0</span></span><br><span class="line">LCS[ <span class="number">6</span> ][ <span class="number">4</span> ] &gt; LCS[ <span class="number">6</span> ][ <span class="number">3</span> ]</span><br><span class="line">LCS[<span class="number">6</span>][<span class="number">3</span>] = LCS[<span class="number">6</span>][<span class="number">4</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">6</span> ][ <span class="number">2</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">6</span>][<span class="number">2</span>] = LCS[<span class="number">7</span>][<span class="number">3</span>]=<span class="number">0</span></span><br><span class="line">LCS[ <span class="number">6</span> ][ <span class="number">3</span> ] &gt; LCS[ <span class="number">6</span> ][ <span class="number">2</span> ]</span><br><span class="line">LCS[<span class="number">6</span>][<span class="number">2</span>] = LCS[<span class="number">6</span>][<span class="number">3</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">6</span> ][ <span class="number">1</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">6</span>][<span class="number">1</span>] = LCS[<span class="number">7</span>][<span class="number">2</span>]=<span class="number">0</span></span><br><span class="line">LCS[ <span class="number">6</span> ][ <span class="number">2</span> ] &gt; LCS[ <span class="number">6</span> ][ <span class="number">1</span> ]</span><br><span class="line">LCS[<span class="number">6</span>][<span class="number">1</span>] = LCS[<span class="number">6</span>][<span class="number">2</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">6</span> ][ <span class="number">0</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">6</span>][<span class="number">0</span>] = LCS[<span class="number">7</span>][<span class="number">1</span>]=<span class="number">0</span></span><br><span class="line">x[ <span class="number">6</span> ] == y[ <span class="number">0</span> ]</span><br><span class="line"><span class="number">6</span> <span class="number">0</span><span class="number">0</span><span class="number">6</span> <span class="number">0</span><span class="number">1</span></span><br><span class="line">LCS[ <span class="number">5</span> ][ <span class="number">5</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">5</span>][<span class="number">5</span>] = LCS[<span class="number">6</span>][<span class="number">6</span>]=<span class="number">0</span></span><br><span class="line">x[ <span class="number">5</span> ] == y[ <span class="number">5</span> ]</span><br><span class="line"><span class="number">5</span> <span class="number">5</span><span class="number">0</span><span class="number">5</span> <span class="number">5</span><span class="number">1</span></span><br><span class="line">LCS[ <span class="number">5</span> ][ <span class="number">4</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">5</span>][<span class="number">4</span>] = LCS[<span class="number">6</span>][<span class="number">5</span>]=<span class="number">0</span></span><br><span class="line">LCS[ <span class="number">5</span> ][ <span class="number">5</span> ] &gt; LCS[ <span class="number">5</span> ][ <span class="number">4</span> ]</span><br><span class="line">LCS[<span class="number">5</span>][<span class="number">4</span>] = LCS[<span class="number">5</span>][<span class="number">5</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">5</span> ][ <span class="number">3</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">5</span>][<span class="number">3</span>] = LCS[<span class="number">6</span>][<span class="number">4</span>]=<span class="number">1</span></span><br><span class="line">x[ <span class="number">5</span> ] == y[ <span class="number">3</span> ]</span><br><span class="line"><span class="number">5</span> <span class="number">3</span><span class="number">1</span><span class="number">5</span> <span class="number">3</span><span class="number">2</span></span><br><span class="line">LCS[ <span class="number">5</span> ][ <span class="number">2</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">5</span>][<span class="number">2</span>] = LCS[<span class="number">6</span>][<span class="number">3</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">5</span> ][ <span class="number">3</span> ] &gt; LCS[ <span class="number">5</span> ][ <span class="number">2</span> ]</span><br><span class="line">LCS[<span class="number">5</span>][<span class="number">2</span>] = LCS[<span class="number">5</span>][<span class="number">3</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">5</span> ][ <span class="number">1</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">5</span>][<span class="number">1</span>] = LCS[<span class="number">6</span>][<span class="number">2</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">5</span> ][ <span class="number">2</span> ] &gt; LCS[ <span class="number">5</span> ][ <span class="number">1</span> ]</span><br><span class="line">LCS[<span class="number">5</span>][<span class="number">1</span>] = LCS[<span class="number">5</span>][<span class="number">2</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">5</span> ][ <span class="number">0</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">5</span>][<span class="number">0</span>] = LCS[<span class="number">6</span>][<span class="number">1</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">5</span> ][ <span class="number">1</span> ] &gt; LCS[ <span class="number">5</span> ][ <span class="number">0</span> ]</span><br><span class="line">LCS[<span class="number">5</span>][<span class="number">0</span>] = LCS[<span class="number">5</span>][<span class="number">1</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">4</span> ][ <span class="number">5</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">4</span>][<span class="number">5</span>] = LCS[<span class="number">5</span>][<span class="number">6</span>]=<span class="number">0</span></span><br><span class="line">LCS[ <span class="number">5</span> ][ <span class="number">5</span> ] &gt; LCS[ <span class="number">4</span> ][ <span class="number">5</span> ]</span><br><span class="line">LCS[<span class="number">4</span>][<span class="number">5</span>] = LCS[<span class="number">5</span>][<span class="number">5</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">4</span> ][ <span class="number">4</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">4</span>][<span class="number">4</span>] = LCS[<span class="number">5</span>][<span class="number">5</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">4</span> ][ <span class="number">3</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">4</span>][<span class="number">3</span>] = LCS[<span class="number">5</span>][<span class="number">4</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">5</span> ][ <span class="number">3</span> ] &gt; LCS[ <span class="number">4</span> ][ <span class="number">3</span> ]</span><br><span class="line">LCS[<span class="number">4</span>][<span class="number">3</span>] = LCS[<span class="number">5</span>][<span class="number">3</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">4</span> ][ <span class="number">2</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">4</span>][<span class="number">2</span>] = LCS[<span class="number">5</span>][<span class="number">3</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">4</span> ][ <span class="number">1</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">4</span>][<span class="number">1</span>] = LCS[<span class="number">5</span>][<span class="number">2</span>]=<span class="number">2</span></span><br><span class="line">x[ <span class="number">4</span> ] == y[ <span class="number">1</span> ]</span><br><span class="line"><span class="number">4</span> <span class="number">1</span><span class="number">2</span><span class="number">4</span> <span class="number">1</span><span class="number">3</span></span><br><span class="line">LCS[ <span class="number">4</span> ][ <span class="number">0</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">4</span>][<span class="number">0</span>] = LCS[<span class="number">5</span>][<span class="number">1</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">4</span> ][ <span class="number">1</span> ] &gt; LCS[ <span class="number">4</span> ][ <span class="number">0</span> ]</span><br><span class="line">LCS[<span class="number">4</span>][<span class="number">0</span>] = LCS[<span class="number">4</span>][<span class="number">1</span>]=<span class="number">3</span></span><br><span class="line">LCS[ <span class="number">3</span> ][ <span class="number">5</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">3</span>][<span class="number">5</span>] = LCS[<span class="number">4</span>][<span class="number">6</span>]=<span class="number">0</span></span><br><span class="line">LCS[ <span class="number">4</span> ][ <span class="number">5</span> ] &gt; LCS[ <span class="number">3</span> ][ <span class="number">5</span> ]</span><br><span class="line">LCS[<span class="number">3</span>][<span class="number">5</span>] = LCS[<span class="number">4</span>][<span class="number">5</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">3</span> ][ <span class="number">4</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">3</span>][<span class="number">4</span>] = LCS[<span class="number">4</span>][<span class="number">5</span>]=<span class="number">1</span></span><br><span class="line">x[ <span class="number">3</span> ] == y[ <span class="number">4</span> ]</span><br><span class="line"><span class="number">3</span> <span class="number">4</span><span class="number">1</span><span class="number">3</span> <span class="number">4</span><span class="number">2</span></span><br><span class="line">LCS[ <span class="number">3</span> ][ <span class="number">3</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">3</span>][<span class="number">3</span>] = LCS[<span class="number">4</span>][<span class="number">4</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">3</span> ][ <span class="number">4</span> ] &gt; LCS[ <span class="number">3</span> ][ <span class="number">3</span> ]</span><br><span class="line">LCS[<span class="number">3</span>][<span class="number">3</span>] = LCS[<span class="number">3</span>][<span class="number">4</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">3</span> ][ <span class="number">2</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">3</span>][<span class="number">2</span>] = LCS[<span class="number">4</span>][<span class="number">3</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">3</span> ][ <span class="number">1</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">3</span>][<span class="number">1</span>] = LCS[<span class="number">4</span>][<span class="number">2</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">4</span> ][ <span class="number">1</span> ] &gt; LCS[ <span class="number">3</span> ][ <span class="number">1</span> ]</span><br><span class="line">LCS[<span class="number">3</span>][<span class="number">1</span>] = LCS[<span class="number">4</span>][<span class="number">1</span>]=<span class="number">3</span></span><br><span class="line">LCS[ <span class="number">3</span> ][ <span class="number">0</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">3</span>][<span class="number">0</span>] = LCS[<span class="number">4</span>][<span class="number">1</span>]=<span class="number">3</span></span><br><span class="line">x[ <span class="number">3</span> ] == y[ <span class="number">0</span> ]</span><br><span class="line"><span class="number">3</span> <span class="number">0</span><span class="number">3</span><span class="number">3</span> <span class="number">0</span><span class="number">4</span></span><br><span class="line">LCS[ <span class="number">2</span> ][ <span class="number">5</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">2</span>][<span class="number">5</span>] = LCS[<span class="number">3</span>][<span class="number">6</span>]=<span class="number">0</span></span><br><span class="line">LCS[ <span class="number">3</span> ][ <span class="number">5</span> ] &gt; LCS[ <span class="number">2</span> ][ <span class="number">5</span> ]</span><br><span class="line">LCS[<span class="number">2</span>][<span class="number">5</span>] = LCS[<span class="number">3</span>][<span class="number">5</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">2</span> ][ <span class="number">4</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">2</span>][<span class="number">4</span>] = LCS[<span class="number">3</span>][<span class="number">5</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">3</span> ][ <span class="number">4</span> ] &gt; LCS[ <span class="number">2</span> ][ <span class="number">4</span> ]</span><br><span class="line">LCS[<span class="number">2</span>][<span class="number">4</span>] = LCS[<span class="number">3</span>][<span class="number">4</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">2</span> ][ <span class="number">3</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">2</span>][<span class="number">3</span>] = LCS[<span class="number">3</span>][<span class="number">4</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">2</span> ][ <span class="number">2</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">2</span>][<span class="number">2</span>] = LCS[<span class="number">3</span>][<span class="number">3</span>]=<span class="number">2</span></span><br><span class="line">x[ <span class="number">2</span> ] == y[ <span class="number">2</span> ]</span><br><span class="line"><span class="number">2</span> <span class="number">2</span><span class="number">2</span><span class="number">2</span> <span class="number">2</span><span class="number">3</span></span><br><span class="line">LCS[ <span class="number">2</span> ][ <span class="number">1</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">2</span>][<span class="number">1</span>] = LCS[<span class="number">3</span>][<span class="number">2</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">2</span> ][ <span class="number">2</span> ] &gt; LCS[ <span class="number">2</span> ][ <span class="number">1</span> ]</span><br><span class="line">LCS[<span class="number">2</span>][<span class="number">1</span>] = LCS[<span class="number">2</span>][<span class="number">2</span>]=<span class="number">3</span></span><br><span class="line">LCS[ <span class="number">2</span> ][ <span class="number">0</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">2</span>][<span class="number">0</span>] = LCS[<span class="number">3</span>][<span class="number">1</span>]=<span class="number">3</span></span><br><span class="line">LCS[ <span class="number">3</span> ][ <span class="number">0</span> ] &gt; LCS[ <span class="number">2</span> ][ <span class="number">0</span> ]</span><br><span class="line">LCS[<span class="number">2</span>][<span class="number">0</span>] = LCS[<span class="number">3</span>][<span class="number">0</span>]=<span class="number">4</span></span><br><span class="line">LCS[ <span class="number">1</span> ][ <span class="number">5</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">1</span>][<span class="number">5</span>] = LCS[<span class="number">2</span>][<span class="number">6</span>]=<span class="number">0</span></span><br><span class="line">LCS[ <span class="number">2</span> ][ <span class="number">5</span> ] &gt; LCS[ <span class="number">1</span> ][ <span class="number">5</span> ]</span><br><span class="line">LCS[<span class="number">1</span>][<span class="number">5</span>] = LCS[<span class="number">2</span>][<span class="number">5</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">1</span> ][ <span class="number">4</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">1</span>][<span class="number">4</span>] = LCS[<span class="number">2</span>][<span class="number">5</span>]=<span class="number">1</span></span><br><span class="line">x[ <span class="number">1</span> ] == y[ <span class="number">4</span> ]</span><br><span class="line"><span class="number">1</span> <span class="number">4</span><span class="number">1</span><span class="number">1</span> <span class="number">4</span><span class="number">2</span></span><br><span class="line">LCS[ <span class="number">1</span> ][ <span class="number">3</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">1</span>][<span class="number">3</span>] = LCS[<span class="number">2</span>][<span class="number">4</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">1</span> ][ <span class="number">2</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">1</span>][<span class="number">2</span>] = LCS[<span class="number">2</span>][<span class="number">3</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">2</span> ][ <span class="number">2</span> ] &gt; LCS[ <span class="number">1</span> ][ <span class="number">2</span> ]</span><br><span class="line">LCS[<span class="number">1</span>][<span class="number">2</span>] = LCS[<span class="number">2</span>][<span class="number">2</span>]=<span class="number">3</span></span><br><span class="line">LCS[ <span class="number">1</span> ][ <span class="number">1</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">1</span>][<span class="number">1</span>] = LCS[<span class="number">2</span>][<span class="number">2</span>]=<span class="number">3</span></span><br><span class="line">LCS[ <span class="number">1</span> ][ <span class="number">0</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">1</span>][<span class="number">0</span>] = LCS[<span class="number">2</span>][<span class="number">1</span>]=<span class="number">3</span></span><br><span class="line">x[ <span class="number">1</span> ] == y[ <span class="number">0</span> ]</span><br><span class="line"><span class="number">1</span> <span class="number">0</span><span class="number">3</span><span class="number">1</span> <span class="number">0</span><span class="number">4</span></span><br><span class="line">LCS[ <span class="number">0</span> ][ <span class="number">5</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">0</span>][<span class="number">5</span>] = LCS[<span class="number">1</span>][<span class="number">6</span>]=<span class="number">0</span></span><br><span class="line">x[ <span class="number">0</span> ] == y[ <span class="number">5</span> ]</span><br><span class="line"><span class="number">0</span> <span class="number">5</span><span class="number">0</span><span class="number">0</span> <span class="number">5</span><span class="number">1</span></span><br><span class="line">LCS[ <span class="number">0</span> ][ <span class="number">4</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">0</span>][<span class="number">4</span>] = LCS[<span class="number">1</span>][<span class="number">5</span>]=<span class="number">1</span></span><br><span class="line">LCS[ <span class="number">1</span> ][ <span class="number">4</span> ] &gt; LCS[ <span class="number">0</span> ][ <span class="number">4</span> ]</span><br><span class="line">LCS[<span class="number">0</span>][<span class="number">4</span>] = LCS[<span class="number">1</span>][<span class="number">4</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">0</span> ][ <span class="number">3</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">0</span>][<span class="number">3</span>] = LCS[<span class="number">1</span>][<span class="number">4</span>]=<span class="number">2</span></span><br><span class="line">x[ <span class="number">0</span> ] == y[ <span class="number">3</span> ]</span><br><span class="line"><span class="number">0</span> <span class="number">3</span><span class="number">2</span><span class="number">0</span> <span class="number">3</span><span class="number">3</span></span><br><span class="line">LCS[ <span class="number">0</span> ][ <span class="number">2</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">0</span>][<span class="number">2</span>] = LCS[<span class="number">1</span>][<span class="number">3</span>]=<span class="number">2</span></span><br><span class="line">LCS[ <span class="number">0</span> ][ <span class="number">3</span> ] &gt; LCS[ <span class="number">0</span> ][ <span class="number">2</span> ]</span><br><span class="line">LCS[<span class="number">0</span>][<span class="number">2</span>] = LCS[<span class="number">0</span>][<span class="number">3</span>]=<span class="number">3</span></span><br><span class="line">LCS[ <span class="number">0</span> ][ <span class="number">1</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">0</span>][<span class="number">1</span>] = LCS[<span class="number">1</span>][<span class="number">2</span>]=<span class="number">3</span></span><br><span class="line">LCS[ <span class="number">0</span> ][ <span class="number">0</span> ]: <span class="number">0</span></span><br><span class="line">LCS[<span class="number">0</span>][<span class="number">0</span>] = LCS[<span class="number">1</span>][<span class="number">1</span>]=<span class="number">3</span></span><br><span class="line">LCS[ <span class="number">1</span> ][ <span class="number">0</span> ] &gt; LCS[ <span class="number">0</span> ][ <span class="number">0</span> ]</span><br><span class="line">LCS[<span class="number">0</span>][<span class="number">0</span>] = LCS[<span class="number">1</span>][<span class="number">0</span>]=<span class="number">4</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure><p>动态规划完整代码</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> LCS [<span class="number">1024</span>][<span class="number">1024</span>]<span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">LCSlength</span><span class="params">(x <span class="keyword">string</span>, m <span class="keyword">int</span>, y <span class="keyword">string</span>, n <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := m - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i-- &#123;</span><br><span class="line"><span class="keyword">for</span> j := n - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j-- &#123;</span><br><span class="line">LCS[i][j] = LCS[i+<span class="number">1</span>][j+<span class="number">1</span>]</span><br><span class="line"><span class="keyword">if</span> x[i] == y[j] &#123;</span><br><span class="line">LCS[i][j]++</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> LCS[i][j+<span class="number">1</span>] &gt; LCS[i][j] &#123;</span><br><span class="line">LCS[i][j] = LCS[i][j+<span class="number">1</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> LCS[i+<span class="number">1</span>][j] &gt; LCS[i][j] &#123;</span><br><span class="line">LCS[i][j] = LCS[i+<span class="number">1</span>][j]</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> LCS[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">str1 := <span class="string">"ABCBDAB"</span></span><br><span class="line">str2 := <span class="string">"BDCABA"</span></span><br><span class="line"></span><br><span class="line">n := LCSlength(str1, <span class="built_in">len</span>(str1), str2, <span class="built_in">len</span>(str2))</span><br><span class="line">fmt.Println(n)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>动态规划算法，其时间复杂度为O(mn)，因为i从1~m依次取值，j从1~n依次取值。</p><p>下面把字符串加长，对比一下两种算法所消耗的时间</p><p>动态规划算法</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">str1 := <span class="string">"ABCBDABGNAIGIAENIGEGWM"</span></span><br><span class="line">str2 := <span class="string">"BDCABAFANIGINIEINGINWM"</span></span><br><span class="line">start := time.Now()</span><br><span class="line">n := LCS1length1(str1, <span class="built_in">len</span>(str1), str2, <span class="built_in">len</span>(str2))</span><br><span class="line">end := time.Since(start)</span><br><span class="line">fmt.Println(<span class="string">"耗时："</span>, end)</span><br><span class="line">fmt.Println(<span class="string">"最长公共子序列的长度为："</span>, n)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">耗时： <span class="number">43.729</span>µs</span><br><span class="line">最长公共子序列的长度为： <span class="number">14</span></span><br></pre></td></tr></table></figure><p>递归算法</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">str1 := <span class="string">"ABCBDABGNAIGIAENIGEGWM"</span></span><br><span class="line">str2 := <span class="string">"BDCABAFANIGINIEINGINWM"</span></span><br><span class="line">start := time.Now()</span><br><span class="line">length := LCSlength(str1, <span class="number">0</span>, <span class="built_in">len</span>(str1), str2, <span class="number">0</span>, <span class="built_in">len</span>(str2))</span><br><span class="line">end := time.Since(start)</span><br><span class="line">fmt.Println(<span class="string">"耗时："</span>, end)</span><br><span class="line">fmt.Println(<span class="string">"最长公共子序列的长度为："</span>, length)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">耗时： <span class="number">8.484912422s</span></span><br><span class="line">最长公共子序列的长度为： <span class="number">14</span></span><br></pre></td></tr></table></figure><p>对比可见，同样的问题，动态规划算法只需要不到100微秒，而递归算法需要8秒，是动态规划算法的8万多倍。</p><p>前面这种动态规划解法是将字符串从尾到头开始比较，该问题也可以从头到尾进行比较，下面看一下这种方法</p><p>完整代码</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">comSubstring</span><span class="params">(str1, str2 <span class="keyword">string</span>, m, n <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> arr12 [<span class="number">1024</span>][<span class="number">1024</span>]<span class="keyword">int</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= m; i++ &#123;</span><br><span class="line"><span class="keyword">for</span> j := <span class="number">1</span>; j &lt;= n; j++ &#123;</span><br><span class="line"><span class="keyword">if</span> str1[i<span class="number">-1</span>] == str2[j<span class="number">-1</span>] &#123;</span><br><span class="line">arr12[i][j] = arr12[i<span class="number">-1</span>][j<span class="number">-1</span>] + <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> str1[i<span class="number">-1</span>] != str2[j<span class="number">-1</span>] &#123;</span><br><span class="line">arr12[i][j] = max1(arr12[i][j<span class="number">-1</span>], arr12[i<span class="number">-1</span>][j])</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> arr12[m][n]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">max1</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> a &gt; b &#123;</span><br><span class="line"><span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">str1 := <span class="string">"ABCBDABGNAIGIAENIGEGWM"</span></span><br><span class="line">str2 := <span class="string">"BDCABAFANIGINIEINGINWM"</span></span><br><span class="line">start := time.Now()</span><br><span class="line">n := comSubstring(str1, str2, <span class="built_in">len</span>(str1), <span class="built_in">len</span>(str2))</span><br><span class="line">end := time.Since(start)</span><br><span class="line">fmt.Println(<span class="string">"耗时："</span>, end)</span><br><span class="line">fmt.Println(<span class="string">"最长公共子序列的长度为："</span>, n)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">耗时： <span class="number">4.674424</span>ms</span><br><span class="line">最长公共子序列的长度为： <span class="number">14</span></span><br></pre></td></tr></table></figure><p>这种方法也比较耗时，不过仍然比递归耗时要小得多。</p><p>接下来用这种方法，将最长公共子序列输出</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">comSubStrLen</span><span class="params">(s1, s2 <span class="keyword">string</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> arr [<span class="number">1024</span>][<span class="number">1024</span>]<span class="keyword">int</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt; <span class="built_in">len</span>(s1)+<span class="number">1</span>; i++ &#123;</span><br><span class="line"><span class="keyword">for</span> j := <span class="number">1</span>; j &lt; <span class="built_in">len</span>(s2)+<span class="number">1</span>; j++ &#123;</span><br><span class="line"><span class="keyword">if</span> s1[i<span class="number">-1</span>] == s2[j<span class="number">-1</span>] &#123;</span><br><span class="line">arr[i][j] = <span class="number">1</span> + arr[i<span class="number">-1</span>][j<span class="number">-1</span>]</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">arr[i][j] = maxNum(arr[i<span class="number">-1</span>][j], arr[i][j<span class="number">-1</span>])</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> arr[<span class="built_in">len</span>(s1)][<span class="built_in">len</span>(s2)]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">comSubStr</span><span class="params">(s1, s2 <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> arr [<span class="number">1024</span>][<span class="number">1024</span>]<span class="keyword">int</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt; <span class="built_in">len</span>(s1)+<span class="number">1</span>; i++ &#123;</span><br><span class="line"><span class="keyword">for</span> j := <span class="number">1</span>; j &lt; <span class="built_in">len</span>(s2)+<span class="number">1</span>; j++ &#123;</span><br><span class="line"><span class="keyword">if</span> s1[i<span class="number">-1</span>] == s2[j<span class="number">-1</span>] &#123;</span><br><span class="line">arr[i][j] = <span class="number">1</span> + arr[i<span class="number">-1</span>][j<span class="number">-1</span>]</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">arr[i][j] = maxNum(arr[i<span class="number">-1</span>][j], arr[i][j<span class="number">-1</span>])</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">m := <span class="built_in">len</span>(s1)</span><br><span class="line">n := <span class="built_in">len</span>(s2)</span><br><span class="line"><span class="keyword">var</span> result []<span class="keyword">byte</span></span><br><span class="line"><span class="keyword">for</span> m &gt; <span class="number">0</span> &amp;&amp; n &gt; <span class="number">0</span> &#123;</span><br><span class="line"><span class="keyword">if</span> s1[m<span class="number">-1</span>] == s2[n<span class="number">-1</span>] &#123;</span><br><span class="line">result = <span class="built_in">append</span>(result, s1[m<span class="number">-1</span>])</span><br><span class="line">m--</span><br><span class="line">n--</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> arr[m][n<span class="number">-1</span>] &gt;= arr[m<span class="number">-1</span>][n] &#123;</span><br><span class="line">n--</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">m--</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> reverseString(<span class="keyword">string</span>(result))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">reverseString</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">runes := []<span class="keyword">rune</span>(s)</span><br><span class="line"><span class="keyword">for</span> from, to := <span class="number">0</span>, <span class="built_in">len</span>(runes)<span class="number">-1</span>; from &lt; to; from, to = from+<span class="number">1</span>, to<span class="number">-1</span> &#123;</span><br><span class="line">runes[from], runes[to] = runes[to], runes[from]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">string</span>(runes)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">maxNum</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> a &gt; b &#123;</span><br><span class="line"><span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">str1 := <span class="string">"ABCBDABGNAIGIAENIGEGWM"</span></span><br><span class="line">str2 := <span class="string">"BDCABAFANIGINIEINGINWM"</span></span><br><span class="line">start := time.Now()</span><br><span class="line">n := comSubStrLen(str1, str2)</span><br><span class="line">end := time.Since(start)</span><br><span class="line">fmt.Println(<span class="string">"耗时："</span>, end)</span><br><span class="line">fmt.Println(<span class="string">"最长公共子序列的长度为："</span>, n)</span><br><span class="line">csr := comSubStr(str1, str2)</span><br><span class="line">fmt.Println(<span class="string">"最长公共子序列为："</span>, csr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">耗时： <span class="number">5.396031</span>ms</span><br><span class="line">最长公共子序列的长度为： <span class="number">14</span></span><br><span class="line">最长公共子序列为： BDABAIGINIEGWM</span><br></pre></td></tr></table></figure><p>公共子序列还有其他好几个相关问题，同样动态规划算法的应用场景也很多，这里只是最简单的用法，网上还能搜索到很多，这里就不再展开。</p><p>最后，推荐一本书《数据结构与算法经典问题解析》，印度：纳拉辛哈·卡鲁曼希著，封面如下<br><img src="http://p83c9zj44.bkt.clouddn.com/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E7%BB%8F%E5%85%B8%E9%97%AE%E9%A2%98%E8%A7%A3%E6%9E%90.jpg" alt=""><br>豆瓣链接：<a href="https://book.douban.com/subject/26834485/" target="_blank" rel="noopener">https://book.douban.com/subject/26834485/</a></p><p>本文中大部分内容参考自这本书，内容详实，非常经典，非常实用。</p><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="数据结构与算法" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="递归" scheme="http://yoursite.com/tags/%E9%80%92%E5%BD%92/"/>
    
      <category term="动态规划" scheme="http://yoursite.com/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="最长公共子序列" scheme="http://yoursite.com/tags/%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%AD%90%E5%BA%8F%E5%88%97/"/>
    
  </entry>
  
  <entry>
    <title>搭建etcd多台服务器集群</title>
    <link href="http://yoursite.com/2018/02/11/%E6%90%AD%E5%BB%BAetcd%E5%A4%9A%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%9B%86%E7%BE%A4/"/>
    <id>http://yoursite.com/2018/02/11/搭建etcd多台服务器集群/</id>
    <published>2018-02-11T13:08:05.000Z</published>
    <updated>2018-07-28T10:47:08.717Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><ul><li><strong>1、清空缓存：在etcd目录下执行</strong><br>make clean<br><img src="http://p83c9zj44.bkt.clouddn.com/etcd%E6%B8%85%E7%A9%BA%E7%BC%93%E5%AD%98.png" alt=""></li><li><p><strong>2、导入API：在etcd/bin目录下执行</strong><br>export ETCDCTL_API=3</p></li><li><p><strong>3、设置服务器IP：在etcd/bin目录下执行</strong><br>三台机器按主机IP顺序执行以下同一段代码</p></li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">TOKEN=token<span class="number">-01</span></span><br><span class="line">CLUSTER_STATE=<span class="built_in">new</span></span><br><span class="line">NAME_1=machine<span class="number">-1</span></span><br><span class="line">NAME_2=machine<span class="number">-2</span></span><br><span class="line">NAME_3=machine<span class="number">-3</span></span><br><span class="line">HOST_1=<span class="number">10.0</span><span class="number">.154</span><span class="number">.189</span></span><br><span class="line">HOST_2=<span class="number">10.0</span><span class="number">.154</span><span class="number">.210</span></span><br><span class="line">HOST_3=<span class="number">10.0</span><span class="number">.154</span><span class="number">.244</span></span><br><span class="line">CLUSTER=$&#123;NAME_1&#125;=http:<span class="comment">//$&#123;HOST_1&#125;:2380,$&#123;NAME_2&#125;=http://$&#123;HOST_2&#125;:2380,$&#123;NAME_3&#125;=http://$&#123;HOST_3&#125;:2380</span></span><br></pre></td></tr></table></figure><ul><li><strong>4、启动服务：在etcd/bin目录下执行</strong></li></ul><p>三台机器按顺序执行各自命令：<br>machine1执行如下命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">THIS_NAME=$&#123;NAME_1&#125;</span><br><span class="line">THIS_IP=$&#123;HOST_1&#125;</span><br><span class="line">./etcd --data-dir=data.etcd --name $&#123;THIS_NAME&#125; --initial-advertise-peer-urls http://$&#123;THIS_IP&#125;:2380 --listen-peer-urls http://$&#123;THIS_IP&#125;:2380 --advertise-client-urls http://$&#123;THIS_IP&#125;:2379 --listen-client-urls http://$&#123;THIS_IP&#125;:2379 --initial-cluster $&#123;CLUSTER&#125; --initial-cluster-state $&#123;CLUSTER_STATE&#125; --initial-cluster-token $&#123;TOKEN&#125;</span><br></pre></td></tr></table></figure><p>machine2执行以下命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">THIS_NAME=$&#123;NAME_2&#125;</span><br><span class="line">THIS_IP=$&#123;HOST_2&#125;</span><br><span class="line">./etcd --data-dir=data.etcd --name $&#123;THIS_NAME&#125; --initial-advertise-peer-urls http://$&#123;THIS_IP&#125;:2380 --listen-peer-urls http://$&#123;THIS_IP&#125;:2380 --advertise-client-urls http://$&#123;THIS_IP&#125;:2379 --listen-client-urls http://$&#123;THIS_IP&#125;:2379 --initial-cluster $&#123;CLUSTER&#125; --initial-cluster-state $&#123;CLUSTER_STATE&#125; --initial-cluster-token $&#123;TOKEN&#125;</span><br></pre></td></tr></table></figure><p>machine3执行以下命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">THIS_NAME=$&#123;NAME_3&#125;</span><br><span class="line">THIS_IP=$&#123;HOST_3&#125;</span><br><span class="line">./etcd --data-dir=data.etcd --name $&#123;THIS_NAME&#125; --initial-advertise-peer-urls http://$&#123;THIS_IP&#125;:2380 --listen-peer-urls http://$&#123;THIS_IP&#125;:2380 --advertise-client-urls http://$&#123;THIS_IP&#125;:2379 --listen-client-urls http://$&#123;THIS_IP&#125;:2379 --initial-cluster $&#123;CLUSTER&#125; --initial-cluster-state $&#123;CLUSTER_STATE&#125; --initial-cluster-token $&#123;TOKEN&#125;</span><br></pre></td></tr></table></figure><p>machine3接入成功<br><img src="http://p83c9zj44.bkt.clouddn.com/%E4%B8%BB%E6%9C%BA3%E8%BF%9E%E6%8E%A5%E6%88%90%E5%8A%9F.png" alt=""></p><ul><li><strong>5、检测几台机器接入集群：</strong></li></ul><p>新开一个终端：进入etcd/bin目录<br>导入IP：<br>export ETCDCTL_API=3<br>执行以下命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">HOST_1=10.0.154.189</span><br><span class="line">HOST_2=10.0.154.210</span><br><span class="line">HOST_3=10.0.154.244</span><br><span class="line">ENDPOINTS=$HOST_1:2379,$HOST_2:2379,$HOST_3:2379</span><br><span class="line"></span><br><span class="line">./etcdctl --endpoints=$ENDPOINTS member list</span><br></pre></td></tr></table></figure><p>连接成功如图：<br><img src="http://p83c9zj44.bkt.clouddn.com/%E8%BF%9E%E6%8E%A5%E6%88%90%E5%8A%9F.png" alt=""></p><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="分布式系统" scheme="http://yoursite.com/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"/>
    
    
      <category term="etcd多台服务器集群" scheme="http://yoursite.com/tags/etcd%E5%A4%9A%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%9B%86%E7%BE%A4/"/>
    
  </entry>
  
  <entry>
    <title>gin框架：用POST进行文件上传</title>
    <link href="http://yoursite.com/2018/02/04/gin%E6%A1%86%E6%9E%B6%EF%BC%9A%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    <id>http://yoursite.com/2018/02/04/gin框架：文件上传/</id>
    <published>2018-02-04T11:52:10.000Z</published>
    <updated>2018-08-26T07:49:32.885Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><h2 id="上传单个文件："><a href="#上传单个文件：" class="headerlink" title="上传单个文件："></a>上传单个文件：</h2><p>上传文件用POST方法，之前提到过的multipart/form-data编码格式，就是用于上传文件的，gin把go原生的request封装到了c.Request中</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"github.com/gin-gonic/gin"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line"><span class="string">"os"</span></span><br><span class="line"><span class="string">"log"</span></span><br><span class="line"><span class="string">"io"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">uploadFile</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line"><span class="comment">// FormFile方法会读取参数“upload”后面的文件名，返回值是一个File指针，和一个FileHeader指针，和一个err错误。</span></span><br><span class="line">file, header, err := c.Request.FormFile(<span class="string">"upload"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.String(http.StatusBadRequest, <span class="string">"Bad request"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// header调用Filename方法，就可以得到文件名</span></span><br><span class="line">filename := header.Filename</span><br><span class="line">fmt.Println(file, err, filename)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个文件，文件名为filename，这里的返回值out也是一个File指针</span></span><br><span class="line">out, err := os.Create(filename)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">defer</span> out.Close()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将file的内容拷贝到out</span></span><br><span class="line">_, err = io.Copy(out, file)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">c.String(http.StatusCreated, <span class="string">"upload successful \n"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">router := gin.Default()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用POST方法，传入路由参数和路由函数</span></span><br><span class="line">router.POST(<span class="string">"/upload"</span>, uploadFile)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听端口8000，注意冒号。</span></span><br><span class="line">router.Run(<span class="string">":8000"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[GIN-debug] [WARNING] Now Gin requires Go <span class="number">1.6</span> or later and Go <span class="number">1.7</span> will be required soon.</span><br><span class="line"></span><br><span class="line">[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.</span><br><span class="line"></span><br><span class="line">[GIN-debug] [WARNING] Running in <span class="string">"debug"</span> mode. Switch to <span class="string">"release"</span> mode in production.</span><br><span class="line"> - using env:export GIN_MODE=release</span><br><span class="line"> - using code:gin.SetMode(gin.ReleaseMode)</span><br><span class="line"></span><br><span class="line">[GIN-debug] POST   /upload                   --&gt; main.uploadFile (<span class="number">3</span> handlers)</span><br><span class="line">[GIN-debug] Listening and serving HTTP on :<span class="number">8000</span></span><br></pre></td></tr></table></figure><p>在终端输入：</p><p><code>curl -X POST http://127.0.0.1:8000/upload -F &quot;upload=@/Users/ElonJelinek/Pictures/avatar.jpg&quot; -H &quot;Content-Type: multipart/form-data&quot;</code></p><p>运行结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ curl -X POST http:<span class="comment">//127.0.0.1:8000/upload -F "upload=@/Users/ElonJelinek/Pictures/avatar.jpg" -H "Content-Type: multipart/form-data"</span></span><br><span class="line">upload successful </span><br><span class="line">ElonJelinek:~ ElonJelinek$</span><br></pre></td></tr></table></figure><p>控制台输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="number">0xc4201d</span>0e70&#125; &lt;<span class="literal">nil</span>&gt; avatar.jpg</span><br><span class="line">[GIN] <span class="number">2018</span>/<span class="number">02</span>/<span class="number">04</span> - <span class="number">13</span>:<span class="number">52</span>:<span class="number">16</span> | <span class="number">201</span> |    <span class="number">1.186844</span>ms |       <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> | POST     /upload</span><br></pre></td></tr></table></figure><p>输出<code>upload successful</code>则表示上传成功，这里上传的是一张名为<strong>avatar.jpg</strong>的图片，这里上传完成后的文件在工程的根目录下，也就是工程名目录下。</p><h2 id="上传多个文件："><a href="#上传多个文件：" class="headerlink" title="上传多个文件："></a>上传多个文件：</h2><p>模拟上传多个文件，与上传单个文件区别不大，只是用<code>MultipartForm</code>方法替代了<code>FormFile</code>方法，而<code>MultipartForm</code>方法的返回值是一个数组，数组元素为<code>file</code>，所以只需要遍历一下这个数组，并取出文件名，再进行拷贝即可。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"github.com/gin-gonic/gin"</span></span><br><span class="line"><span class="string">"log"</span></span><br><span class="line"><span class="string">"os"</span></span><br><span class="line"><span class="string">"io"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">upldFiles</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">err := c.Request.ParseMultipartForm(<span class="number">200000</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 获取表单</span></span><br><span class="line">form := c.Request.MultipartForm</span><br><span class="line"><span class="comment">// 获取参数upload后面的多个文件名，存放到数组files里面，</span></span><br><span class="line">files := form.File[<span class="string">"upload"</span>]</span><br><span class="line"><span class="comment">// 遍历数组，每取出一个file就拷贝一次</span></span><br><span class="line"><span class="keyword">for</span> i, _ := <span class="keyword">range</span> files &#123;</span><br><span class="line">file, err := files[i].Open()</span><br><span class="line"><span class="keyword">defer</span> file.Close()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fileName := files[i].Filename</span><br><span class="line">fmt.Println(fileName)</span><br><span class="line"></span><br><span class="line">out, err := os.Create(fileName)</span><br><span class="line"><span class="keyword">defer</span> out.Close()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">_, err = io.Copy(out, file)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">c.String(http.StatusCreated, <span class="string">"uploadFiles success! \n"</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">router := gin.Default()</span><br><span class="line"></span><br><span class="line">router.POST(<span class="string">"/upload"</span>, upldFiles)</span><br><span class="line"></span><br><span class="line">router.Run(<span class="string">":8088"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在goland运行：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[GIN-debug] [WARNING] Now Gin requires Go <span class="number">1.6</span> or later and Go <span class="number">1.7</span> will be required soon.</span><br><span class="line"></span><br><span class="line">[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.</span><br><span class="line"></span><br><span class="line">[GIN-debug] [WARNING] Running in <span class="string">"debug"</span> mode. Switch to <span class="string">"release"</span> mode in production.</span><br><span class="line"> - using env:export GIN_MODE=release</span><br><span class="line"> - using code:gin.SetMode(gin.ReleaseMode)</span><br><span class="line"></span><br><span class="line">[GIN-debug] POST   /upload                   --&gt; main.upldFiles (<span class="number">3</span> handlers)</span><br><span class="line">[GIN-debug] Listening and serving HTTP on :<span class="number">8088</span></span><br></pre></td></tr></table></figure><p>在终端输入：<br><code>curl -X POST http://127.0.0.1:8088/upload -F &quot;upload=@/Users/ElonJelinek/Pictures/avatar.jpg&quot; -F &quot;upload=@/Users/ElonJelinek/Pictures/爬虫.jpg&quot; -H &quot;Content-Type: multipart/form-data&quot;</code></p><p>结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ curl -X POST http:<span class="comment">//127.0.0.1:8088/upload -F "upload=@/Users/ElonJelinek/Pictures/avatar.jpg" -F "upload=@/Users/ElonJelinek/Pictures/爬虫.jpg" -H "Content-Type: multipart/form-data"</span></span><br><span class="line">uploadFiles success! </span><br><span class="line">uploadFiles success! </span><br><span class="line">ElonJelinek:~ ElonJelinek$</span><br></pre></td></tr></table></figure><p>控制台输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">avatar.jpg</span><br><span class="line">爬虫.jpg</span><br><span class="line">[GIN] <span class="number">2018</span>/<span class="number">02</span>/<span class="number">04</span> - <span class="number">15</span>:<span class="number">22</span>:<span class="number">14</span> | <span class="number">201</span> |    <span class="number">3.835634</span>ms |       <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> | POST     /upload</span><br></pre></td></tr></table></figure><p>gin框架的封装做的很好，用起来很方便，以上例子是一些简单的运用，实际开发中要复杂的多，例如文件上传，在实际工作中，用户上传图片都是通过表单，在浏览器页面上传。<br>实际上gin框架很强大，性能优秀，方便灵活。</p>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="go语言" scheme="http://yoursite.com/categories/go%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="web框架" scheme="http://yoursite.com/tags/web%E6%A1%86%E6%9E%B6/"/>
    
  </entry>
  
  <entry>
    <title>gin框架</title>
    <link href="http://yoursite.com/2018/02/03/gin%E6%A1%86%E6%9E%B6/"/>
    <id>http://yoursite.com/2018/02/03/gin框架/</id>
    <published>2018-02-03T14:52:10.000Z</published>
    <updated>2018-08-26T04:15:18.869Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><p>gin是一个用go写的web框架</p><h2 id="1、安装gin"><a href="#1、安装gin" class="headerlink" title="1、安装gin"></a>1、安装gin</h2><p>在命令行输入：<code>go get github.com/gin-gonic/gin</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ <span class="keyword">go</span> get github.com/gin-gonic/gin</span><br><span class="line">ElonJelinek:~ ElonJelinek$</span><br></pre></td></tr></table></figure><h2 id="2、基本用法"><a href="#2、基本用法" class="headerlink" title="2、基本用法"></a>2、基本用法</h2><h2 id="1、Hello-World"><a href="#1、Hello-World" class="headerlink" title="1、Hello World"></a>1、Hello World</h2><p>使用gin实现hello world 很简单，首先调用其default方法创建一个router，然后调用其Run方法</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"github.com/gin-gonic/gin"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 调用default方法创建路由</span></span><br><span class="line">router := gin.Default()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过GET方法绑定路由规则和路由函数</span></span><br><span class="line">router.GET(<span class="string">"/"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">c.String(http.StatusOK, <span class="string">"Hello world gin! \n"</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用Run方法监听端口：8088</span></span><br><span class="line">router.Run(<span class="string">":8088"</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行，控制台输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[GIN-debug] [WARNING] Now Gin requires Go <span class="number">1.6</span> or later and Go <span class="number">1.7</span> will be required soon.</span><br><span class="line"></span><br><span class="line">[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.</span><br><span class="line"></span><br><span class="line">[GIN-debug] [WARNING] Running in <span class="string">"debug"</span> mode. Switch to <span class="string">"release"</span> mode in production.</span><br><span class="line"> - using env:export GIN_MODE=release</span><br><span class="line"> - using code:gin.SetMode(gin.ReleaseMode)</span><br><span class="line"></span><br><span class="line">[GIN-debug] GET    /                         --&gt; main.main.func1 (<span class="number">3</span> handlers)</span><br><span class="line">[GIN-debug] Listening and serving HTTP on :<span class="number">8088</span></span><br></pre></td></tr></table></figure><p>打开终端，输入：<code>curl http://localhost:8088</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ curl http:<span class="comment">//localhost:8088</span></span><br><span class="line">Hello world gin! </span><br><span class="line">ElonJelinek:~ ElonJelinek$</span><br></pre></td></tr></table></figure><p>gin的路由来自httprouter库，具有httprouter的功能，但是不支持路由正则表达式：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"github.com/gin-gonic/gin"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">router := gin.Default()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 冒号 ：加上一个参数名，组成路由参数，使用Param方法读取其值，</span></span><br><span class="line">router.GET(<span class="string">"/user/:name"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">name := c.Param(<span class="string">"name"</span>)</span><br><span class="line">c.String(http.StatusOK, <span class="string">"Hello %s! \n"</span>, name)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.Run(<span class="string">":8088"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[GIN-debug] [WARNING] Now Gin requires Go <span class="number">1.6</span> or later and Go <span class="number">1.7</span> will be required soon.</span><br><span class="line"></span><br><span class="line">[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.</span><br><span class="line"></span><br><span class="line">[GIN-debug] [WARNING] Running in <span class="string">"debug"</span> mode. Switch to <span class="string">"release"</span> mode in production.</span><br><span class="line"> - using env:export GIN_MODE=release</span><br><span class="line"> - using code:gin.SetMode(gin.ReleaseMode)</span><br><span class="line"></span><br><span class="line">[GIN-debug] GET    /user/:name               --&gt; main.main.func1 (<span class="number">3</span> handlers)</span><br><span class="line">[GIN-debug] Listening and serving HTTP on :<span class="number">8088</span></span><br></pre></td></tr></table></figure><p>显示监听http：8088端口<br>打开终端，输入：<br><code>curl http://localhost:8088/user/Tom</code><br>匹配正确</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ curl http:<span class="comment">//localhost:8088/user/Tom</span></span><br><span class="line">Hello Tom!</span><br></pre></td></tr></table></figure><p>输入：<br><code>http://localhost:8088/user/Tom/</code><br>（最后多了个斜杠“ / ”）<br>显示不匹配</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ curl http:<span class="comment">//localhost:8088/user/Tom/</span></span><br><span class="line">&lt;a href="/user/Tom"&gt;Moved Permanently&lt;/a&gt;.</span><br></pre></td></tr></table></figure><p>输入：<br><code>curl http://localhost:8088/user/</code><br>（user/后面为空）<br>也不匹配</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ curl http:<span class="comment">//localhost:8088/user/</span></span><br><span class="line"><span class="number">404</span> page not foundElonJelinek:~ ElonJelinek$</span><br></pre></td></tr></table></figure><p>可见，<code>/user/Tom</code>是匹配的，但<code>/user/</code>和<code>/user/Tom/</code>是不匹配的，前者<code>name</code>字段为空，后者<code>name</code>字段后有个斜杠<code>/</code></p><p>控制台的输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[GIN] <span class="number">2018</span>/<span class="number">02</span>/<span class="number">03</span> - <span class="number">16</span>:<span class="number">54</span>:<span class="number">55</span> | <span class="number">200</span> |       <span class="number">24.52</span>µs |             ::<span class="number">1</span> | GET      /user/Tom</span><br><span class="line">[GIN-debug] redirecting request <span class="number">301</span>: /user/Tom/ --&gt; /user/Tom</span><br><span class="line">[GIN] <span class="number">2018</span>/<span class="number">02</span>/<span class="number">03</span> - <span class="number">16</span>:<span class="number">55</span>:<span class="number">21</span> | <span class="number">404</span> |       <span class="number">1.143</span>µs |             ::<span class="number">1</span> | GET      /user/</span><br></pre></td></tr></table></figure><p>除了冒号之外，还有<code>*</code>参数，<code>*</code>能匹配的规则就很多：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"github.com/gin-gonic/gin"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">router := gin.Default()</span><br><span class="line"><span class="comment">// 冒号 : 加name字段，星号 * 加action字段</span></span><br><span class="line">router.GET(<span class="string">"/user/:name/*action"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">name := c.Param(<span class="string">"name"</span>)</span><br><span class="line">action := c.Param(<span class="string">"action"</span>)</span><br><span class="line">msg := name + <span class="string">" is "</span> + action + <span class="string">"\n"</span></span><br><span class="line">c.String(http.StatusOK, msg)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.Run(<span class="string">":8088"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在终端依次输入：<br><code>curl http://localhost:8088/user/Tom/美国人</code><br><code>curl http://localhost:8088/user/Tom/美国人/</code><br><code>curl http://localhost:8088/user/Tom/</code><br><code>curl http://localhost:8088/user/Tom/American</code></p><p>结果均匹配正确：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ curl http:<span class="comment">//localhost:8088/user/Tom/美国人</span></span><br><span class="line">Tom is /美国人</span><br><span class="line">ElonJelinek:~ ElonJelinek$ curl http:<span class="comment">//localhost:8088/user/Tom/美国人/</span></span><br><span class="line">Tom is /美国人/</span><br><span class="line">ElonJelinek:~ ElonJelinek$ curl http:<span class="comment">//localhost:8088/user/Tom/</span></span><br><span class="line">Tom is /</span><br><span class="line">ElonJelinek:~ ElonJelinek$ curl http:<span class="comment">//localhost:8088/user/Tom/American</span></span><br><span class="line">Tom is /American</span><br><span class="line">ElonJelinek:~ ElonJelinek$</span><br></pre></td></tr></table></figure><p>控制台结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[GIN] <span class="number">2018</span>/<span class="number">02</span>/<span class="number">03</span> - <span class="number">17</span>:<span class="number">23</span>:<span class="number">07</span> | <span class="number">200</span> |      <span class="number">12.679</span>µs |             ::<span class="number">1</span> | GET      /user/Tom/美国人</span><br><span class="line">[GIN] <span class="number">2018</span>/<span class="number">02</span>/<span class="number">03</span> - <span class="number">17</span>:<span class="number">23</span>:<span class="number">11</span> | <span class="number">200</span> |      <span class="number">16.977</span>µs |             ::<span class="number">1</span> | GET      /user/Tom/美国人/</span><br><span class="line">[GIN] <span class="number">2018</span>/<span class="number">02</span>/<span class="number">03</span> - <span class="number">17</span>:<span class="number">23</span>:<span class="number">18</span> | <span class="number">200</span> |       <span class="number">19.03</span>µs |             ::<span class="number">1</span> | GET      /user/Tom/</span><br><span class="line">[GIN] <span class="number">2018</span>/<span class="number">02</span>/<span class="number">03</span> - <span class="number">17</span>:<span class="number">23</span>:<span class="number">50</span> | <span class="number">200</span> |        <span class="number">13.1</span>µs |             ::<span class="number">1</span> | GET      /user/Tom/American</span><br></pre></td></tr></table></figure><h3 id="2、GET"><a href="#2、GET" class="headerlink" title="2、GET"></a>2、GET</h3><h5 id="gin-Context中的Query方法："><a href="#gin-Context中的Query方法：" class="headerlink" title="gin.Context中的Query方法："></a>gin.Context中的Query方法：</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"github.com/gin-gonic/gin"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getQuery</span><span class="params">(context *gin.Context)</span></span> &#123;</span><br><span class="line"><span class="comment">// 调用query方法获取userid和username</span></span><br><span class="line">userid := context.Query(<span class="string">"userid"</span>)</span><br><span class="line">username := context.Query(<span class="string">"username"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 转换为string，并在浏览器输出</span></span><br><span class="line">context.String(http.StatusOK, userid+<span class="string">" "</span>+username)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 使用gin的default方法创建一个路由handler</span></span><br><span class="line">router := gin.Default()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 路由参数/user    调用getquery方法获取/user之后的值</span></span><br><span class="line">router.GET(<span class="string">"/user"</span>, getQuery)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动路由的run方法监听端口：8088</span></span><br><span class="line">router.Run(<span class="string">":8088"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行这段代码，goland控制台（即服务端）会有如下输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[GIN-debug] [WARNING] Now Gin requires Go <span class="number">1.6</span> or later and Go <span class="number">1.7</span> will be required soon.</span><br><span class="line"></span><br><span class="line">[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.</span><br><span class="line"></span><br><span class="line">[GIN-debug] [WARNING] Running in <span class="string">"debug"</span> mode. Switch to <span class="string">"release"</span> mode in production.</span><br><span class="line"> - using env:export GIN_MODE=release</span><br><span class="line"> - using code:gin.SetMode(gin.ReleaseMode)</span><br><span class="line"></span><br><span class="line">[GIN-debug] GET    /user                     --&gt; main.getQuery (<span class="number">3</span> handlers)</span><br><span class="line">[GIN-debug] Listening and serving HTTP on :<span class="number">8088</span></span><br></pre></td></tr></table></figure><p>然后，打开浏览器，输入网址：<br><a href="http://localhost:8088/user?userid=1&amp;username=tyming" target="_blank" rel="noopener">http://localhost:8088/user?userid=1&amp;username=tyming</a></p><p>控制台会输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[GIN] <span class="number">2018</span>/<span class="number">02</span>/<span class="number">03</span> - <span class="number">18</span>:<span class="number">00</span>:<span class="number">31</span> | <span class="number">200</span> |     <span class="number">105.848</span>µs |             ::<span class="number">1</span> | GET      /user?userid=<span class="number">1</span>&amp;username=tyming</span><br><span class="line">[GIN] <span class="number">2018</span>/<span class="number">02</span>/<span class="number">03</span> - <span class="number">18</span>:<span class="number">05</span>:<span class="number">32</span> | <span class="number">404</span> |         <span class="number">613</span>ns |             ::<span class="number">1</span> | GET      /favicon.ico</span><br></pre></td></tr></table></figure><p>浏览器（即客户端）输出：<code>1 tyming</code></p><h4 id="2、gin-Context中的Param方法："><a href="#2、gin-Context中的Param方法：" class="headerlink" title="2、gin.Context中的Param方法："></a>2、gin.Context中的Param方法：</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"github.com/gin-gonic/gin"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getParam</span><span class="params">(context *gin.Context)</span></span> &#123;</span><br><span class="line"><span class="comment">// 调用param方法读取userid和username的值</span></span><br><span class="line">userid := context.Param(<span class="string">"userid"</span>)</span><br><span class="line">username := context.Param(<span class="string">"username"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 转换为string并在浏览器输出，输出格式为：userid 空格 username</span></span><br><span class="line">context.String(http.StatusOK, userid+<span class="string">" "</span>+username)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 用default注册路由</span></span><br><span class="line">router := gin.Default()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 路由参数 /user/:加上由参数名组成的路由参数</span></span><br><span class="line">router.GET(<span class="string">"/user/:userid/:username"</span>, getParam)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用路由的run方法</span></span><br><span class="line">router.Run(<span class="string">":8088"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行，goland控制台输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[GIN-debug] [WARNING] Now Gin requires Go <span class="number">1.6</span> or later and Go <span class="number">1.7</span> will be required soon.</span><br><span class="line"></span><br><span class="line">[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.</span><br><span class="line"></span><br><span class="line">[GIN-debug] [WARNING] Running in <span class="string">"debug"</span> mode. Switch to <span class="string">"release"</span> mode in production.</span><br><span class="line"> - using env:export GIN_MODE=release</span><br><span class="line"> - using code:gin.SetMode(gin.ReleaseMode)</span><br><span class="line"></span><br><span class="line">[GIN-debug] GET    /user/:userid/:username   --&gt; main.getParam (<span class="number">3</span> handlers)</span><br><span class="line">[GIN-debug] Listening and serving HTTP on :<span class="number">8088</span></span><br></pre></td></tr></table></figure><p>打开网址：<a href="http://localhost:8088/user/1/tyming" target="_blank" rel="noopener">http://localhost:8088/user/1/tyming</a></p><p>浏览器输出：<code>1 tyming</code></p><p>goland控制台输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[GIN] <span class="number">2018</span>/<span class="number">02</span>/<span class="number">03</span> - <span class="number">18</span>:<span class="number">26</span>:<span class="number">35</span> | <span class="number">200</span> |      <span class="number">32.083</span>µs |             ::<span class="number">1</span> | GET      /user/<span class="number">1</span>/tyming</span><br></pre></td></tr></table></figure><h3 id="3、POST"><a href="#3、POST" class="headerlink" title="3、POST"></a>3、POST</h3><h5 id="gin-Context中的PostForm方法："><a href="#gin-Context中的PostForm方法：" class="headerlink" title="gin.Context中的PostForm方法："></a>gin.Context中的PostForm方法：</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"github.com/gin-gonic/gin"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">post</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">username := c.PostForm(<span class="string">"username"</span>)</span><br><span class="line"><span class="comment">// DefaultPostForm方法的第二个参数为默认值</span></span><br><span class="line"><span class="comment">// 如果提交post请求的时候，没有password字段，则默认值123456会被自动提交</span></span><br><span class="line">password := c.DefaultPostForm(<span class="string">"password"</span>, <span class="string">"123456"</span>)</span><br><span class="line"></span><br><span class="line">c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line"><span class="string">"status"</span>:   <span class="string">"ok"</span>,</span><br><span class="line"><span class="string">"username"</span>: username,</span><br><span class="line"><span class="string">"password"</span>: password,</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">router := gin.Default()</span><br><span class="line"></span><br><span class="line">router.POST(<span class="string">"/user"</span>, post)</span><br><span class="line"></span><br><span class="line">router.Run(<span class="string">":8088"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行此代码（在goland运行），控制台（即服务端）输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[GIN-debug] [WARNING] Now Gin requires Go <span class="number">1.6</span> or later and Go <span class="number">1.7</span> will be required soon.</span><br><span class="line"></span><br><span class="line">[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.</span><br><span class="line"></span><br><span class="line">[GIN-debug] [WARNING] Running in <span class="string">"debug"</span> mode. Switch to <span class="string">"release"</span> mode in production.</span><br><span class="line"> - using env:export GIN_MODE=release</span><br><span class="line"> - using code:gin.SetMode(gin.ReleaseMode)</span><br><span class="line"></span><br><span class="line">[GIN-debug] POST   /user                     --&gt; main.post (<span class="number">3</span> handlers)</span><br><span class="line">[GIN-debug] Listening and serving HTTP on :<span class="number">8088</span></span><br></pre></td></tr></table></figure><p>在终端用curl模拟提交post请求：<br>输入：<br><code>curl -X POST http://localhost:8088/user -H &quot;Content-Type:application/multipart/form-data&quot; -d &quot;username=hello&amp;password=123456&quot;</code></p><p>或输入：<br><code>curl -X POST http://localhost:8088/user -H &quot;Content-Type:application/x-www-form-urlencoded&quot; -d &quot;username=hello&amp;password=123456&quot;</code></p><p>这一段命令的<code>localhost</code>也可用<code>127.0.0.1</code>代替，<br><code>x-www-form-urlencoded</code>和<code>multipart/form-data</code>是post请求的编码格式，<code>urlencoded</code>表示对url进行encode加密，<br><code>username=hello&amp;password=123456</code>是要提交的数据，</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ curl -X POST http:<span class="comment">//localhost:8088/user -H "Content-Type:application/multipart/form-data" -d "username=hello&amp;password=123456"</span></span><br><span class="line">&#123;<span class="string">"password"</span>:<span class="string">"123456"</span>,<span class="string">"status"</span>:<span class="string">"ok"</span>,<span class="string">"username"</span>:<span class="string">""</span>&#125;</span><br><span class="line">ElonJelinek:~ ElonJelinek$</span><br></pre></td></tr></table></figure><p>控制台输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[GIN] <span class="number">2018</span>/<span class="number">02</span>/<span class="number">03</span> - <span class="number">19</span>:<span class="number">05</span>:<span class="number">24</span> | <span class="number">200</span> |     <span class="number">188.599</span>µs |             ::<span class="number">1</span> | POST     /user</span><br></pre></td></tr></table></figure><p>也可用postman工具进行模拟post提交，使用很方便，不需要在终端打一长串命令，postman工具官网：<a href="https://www.getpostman.com/" target="_blank" rel="noopener">https://www.getpostman.com/</a><br><img src="http://p83c9zj44.bkt.clouddn.com/postpostman%E5%B7%A5%E5%85%B7%E6%A8%A1%E6%8B%9Fpost%E8%AF%B7%E6%B1%82.jpeg" alt="模拟post请求"></p><p>控制台输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[GIN] <span class="number">2018</span>/<span class="number">02</span>/<span class="number">03</span> - <span class="number">19</span>:<span class="number">36</span>:<span class="number">57</span> | <span class="number">200</span> |      <span class="number">1.1565</span>ms |       <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> | POST     /user</span><br></pre></td></tr></table></figure><p>参数绑定：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"github.com/gin-gonic/gin"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">Username <span class="keyword">string</span> <span class="string">`form:"username"`</span></span><br><span class="line">Password <span class="keyword">string</span> <span class="string">`form:"password"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">bind</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> user User</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> c.Bind(&amp;user) == <span class="literal">nil</span> &#123;</span><br><span class="line">c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line"><span class="string">"username"</span>: user.Username,</span><br><span class="line"><span class="string">"password"</span>: user.Password,</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">router := gin.Default()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意bind前面有个斜杠 /</span></span><br><span class="line">router.POST(<span class="string">"/bind"</span>, bind)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意8088前面有个冒号 :</span></span><br><span class="line">router.Run(<span class="string">":8088"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在goland运行，然后用postman工具模拟提交post请求：<br><img src="http://p83c9zj44.bkt.clouddn.com/postpostman%E6%8F%90%E4%BA%A4post%E8%AF%B7%E6%B1%82.jpeg" alt="模拟post请求"><br>控制台输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[GIN] <span class="number">2018</span>/<span class="number">02</span>/<span class="number">03</span> - <span class="number">20</span>:<span class="number">20</span>:<span class="number">15</span> | <span class="number">200</span> |    <span class="number">1.266963</span>ms |       <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> | POST     /bind</span><br></pre></td></tr></table></figure><p>除了GET和POST方法外，gin还提供了PUT，DELETE，OPTION等常用的restful方法。</p><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="go语言" scheme="http://yoursite.com/categories/go%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="web框架" scheme="http://yoursite.com/tags/web%E6%A1%86%E6%9E%B6/"/>
    
  </entry>
  
  <entry>
    <title>go语言常见面试题（数学篇）</title>
    <link href="http://yoursite.com/2018/01/03/go%E8%AF%AD%E8%A8%80%E9%9D%A2%E8%AF%95%E9%A2%98%EF%BC%88%E6%95%B0%E5%AD%A6%E7%AF%87%EF%BC%89/"/>
    <id>http://yoursite.com/2018/01/03/go语言面试题（数学篇）/</id>
    <published>2018-01-03T12:55:20.000Z</published>
    <updated>2018-07-31T10:35:44.626Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><h5 id="一、分解质因数：比如90，分解出：90-2-3-3-5"><a href="#一、分解质因数：比如90，分解出：90-2-3-3-5" class="headerlink" title="一、分解质因数：比如90，分解出：90=2*3*3*5"></a>一、分解质因数：比如90，分解出：<code>90=2*3*3*5</code></h5><p>分析：质数为大于1的自然数，除了1和它本身没有其他因数。相反，除了1和它本身还有其他因数的数，称为合数，所以，分解法为：先用这个合数最小的那个因数（是质数的因数）去除，商如果是合数，就继续除：商如果是质数，就停止，最后的这个商是它的最大的质因数。因此，最后可以写成所有的除数乘以最后的商。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> n = <span class="number">90</span></span><br><span class="line">fun(n)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fun</span><span class="params">(n <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">fmt.Print(n, <span class="string">"="</span>, )</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">2</span>; i &lt; n; i++ &#123;</span><br><span class="line"><span class="keyword">if</span> n%i == <span class="number">0</span> &#123;</span><br><span class="line">n = n / i</span><br><span class="line">fmt.Print(i, <span class="string">"*"</span>)</span><br><span class="line">i--</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(n)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">90</span>=<span class="number">2</span>*<span class="number">3</span>*<span class="number">3</span>*<span class="number">5</span></span><br></pre></td></tr></table></figure><h5 id="二、计算-sum-n-1-3-2-5-3-7-…-n-2n-1-的前n项和"><a href="#二、计算-sum-n-1-3-2-5-3-7-…-n-2n-1-的前n项和" class="headerlink" title="二、计算 sum(n) = 1/3 + 2/5 + 3/7 + … + n/2n+1 的前n项和"></a>二、计算 sum(n) = 1/3 + 2/5 + 3/7 + … + n/2n+1 的前n项和</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> n <span class="keyword">float32</span> = <span class="number">8</span></span><br><span class="line">fmt.Print(<span class="string">"sum("</span>, n, <span class="string">")=\t"</span>)</span><br><span class="line">sum := <span class="keyword">float32</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> i := <span class="keyword">float32</span>(<span class="number">1</span>); i &lt;= n; i++ &#123;</span><br><span class="line"><span class="keyword">if</span> i != n &#123;</span><br><span class="line">fmt.Print(i, <span class="string">"/"</span>, <span class="number">2</span>*i+<span class="number">1</span>, <span class="string">"\t+\t"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Print(i, <span class="string">"/"</span>, <span class="number">2</span>*i+<span class="number">1</span>, <span class="string">"\t"</span>)</span><br><span class="line">&#125;</span><br><span class="line">sum += i / (<span class="number">2</span>*i + <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="string">"="</span>, sum)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum(<span class="number">8</span>)=<span class="number">1</span>/<span class="number">3</span>+<span class="number">2</span>/<span class="number">5</span>+<span class="number">3</span>/<span class="number">7</span>+<span class="number">4</span>/<span class="number">9</span>+<span class="number">5</span>/<span class="number">11</span>+<span class="number">6</span>/<span class="number">13</span>+<span class="number">7</span>/<span class="number">15</span>+<span class="number">8</span>/<span class="number">17</span>= <span class="number">3.4596882</span></span><br></pre></td></tr></table></figure><h5 id="三、一球从100米高度自由落下，每次落地后又返跳回原高度的一半，再下落，求它第10次落地时，共经过多少米？"><a href="#三、一球从100米高度自由落下，每次落地后又返跳回原高度的一半，再下落，求它第10次落地时，共经过多少米？" class="headerlink" title="三、一球从100米高度自由落下，每次落地后又返跳回原高度的一半，再下落，求它第10次落地时，共经过多少米？"></a>三、一球从100米高度自由落下，每次落地后又返跳回原高度的一半，再下落，求它第10次落地时，共经过多少米？</h5><p>分析：从第2次开始，每次经过的距离为下落点的2倍，所以第10次落地共经过的距离为后9次的下落点的高度和乘以2加上第一次的100米。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hight <span class="keyword">float32</span> = <span class="number">100</span></span><br><span class="line"><span class="keyword">var</span> jump = hight</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">2</span>; i &lt;= <span class="number">10</span>; i++ &#123;</span><br><span class="line">jump = jump / <span class="number">2</span></span><br><span class="line">hight += jump * <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="string">"第十次落地共经过："</span>, hight, <span class="string">"米。"</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">第十次落地共经过： <span class="number">299.60938</span> 米。</span><br></pre></td></tr></table></figure><h5 id="四、要求输入一个整数n，请你输出斐波那契数列的第n项-斐波那契数列0-1-1-2-3-5-8-13-21……"><a href="#四、要求输入一个整数n，请你输出斐波那契数列的第n项-斐波那契数列0-1-1-2-3-5-8-13-21……" class="headerlink" title="四、要求输入一个整数n，请你输出斐波那契数列的第n项[斐波那契数列0 1 1 2 3 5 8 13 21……]"></a>四、要求输入一个整数n，请你输出斐波那契数列的第n项[斐波那契数列0 1 1 2 3 5 8 13 21……]</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(fibonacci(<span class="number">8</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fibonacci</span><span class="params">(n <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> n &lt;= <span class="number">1</span> &#123;</span><br><span class="line"><span class="keyword">return</span> n</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> fibonacci(n<span class="number">-2</span>) + fibonacci(n<span class="number">-1</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>运行结果：21</code></p><h5 id="五、求1-2-3-…-20-的和"><a href="#五、求1-2-3-…-20-的和" class="headerlink" title="五、求1+2!+3!+…+20!的和"></a>五、求1+2!+3!+…+20!的和</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">sum := <span class="number">0</span></span><br><span class="line"><span class="comment">// 把1到20的阶乘的和累加</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">20</span>; i++ &#123;</span><br><span class="line">sum += fact(i)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(sum)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//  用递归求阶乘</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fact</span><span class="params">(n <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> n &lt;= <span class="number">1</span> &#123;</span><br><span class="line"><span class="keyword">return</span> n</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> n * fact(n<span class="number">-1</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2561327494111820313</span></span><br></pre></td></tr></table></figure><h5 id="六、求101-200之内的素数"><a href="#六、求101-200之内的素数" class="headerlink" title="六、求101-200之内的素数"></a>六、求101-200之内的素数</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">n := <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">100</span>; i &lt;= <span class="number">200</span>; i++ &#123;</span><br><span class="line">count := <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> j := <span class="number">2</span>; j &lt; i; j++ &#123;</span><br><span class="line"><span class="keyword">if</span> i%j == <span class="number">0</span> &#123;</span><br><span class="line">count++</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> count == <span class="number">0</span> &#123;</span><br><span class="line">n++</span><br><span class="line">fmt.Print(i, <span class="string">"\t"</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(n)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：<br><code>101    103    107    109    113    127    131    137    139    149    151    157    163    167    173    179    181    191    193    197    199    21</code><br>共有21个。</p><h5 id="七、打印出所有的-“水仙花数-“，所谓-“水仙花数-“是指一个三位数，其各位数字立方和等于该数本身。例如：153是一个-“水仙花数-“，因为153-1的三次方＋5的三次方＋3的三次方"><a href="#七、打印出所有的-“水仙花数-“，所谓-“水仙花数-“是指一个三位数，其各位数字立方和等于该数本身。例如：153是一个-“水仙花数-“，因为153-1的三次方＋5的三次方＋3的三次方" class="headerlink" title="七、打印出所有的 “水仙花数 “，所谓 “水仙花数 “是指一个三位数，其各位数字立方和等于该数本身。例如：153是一个 “水仙花数 “，因为153=1的三次方＋5的三次方＋3的三次方"></a>七、打印出所有的 “水仙花数 “，所谓 “水仙花数 “是指一个三位数，其各位数字立方和等于该数本身。例如：153是一个 “水仙花数 “，因为153=1的三次方＋5的三次方＋3的三次方</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">100</span>; i &lt;= <span class="number">999</span>; i++ &#123;</span><br><span class="line">l := i / <span class="number">100</span></span><br><span class="line">m := i / <span class="number">10</span> % <span class="number">10</span></span><br><span class="line">n := i % <span class="number">10</span></span><br><span class="line"><span class="keyword">if</span> l*l*l+m*m*m+n*n*n == i &#123;</span><br><span class="line">fmt.Println(i)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">153</span></span><br><span class="line"><span class="number">370</span></span><br><span class="line"><span class="number">371</span></span><br><span class="line"><span class="number">407</span></span><br></pre></td></tr></table></figure><h5 id="八、利用递归方法求5"><a href="#八、利用递归方法求5" class="headerlink" title="八、利用递归方法求5!"></a>八、利用递归方法求5!</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">a := fact(<span class="number">5</span>)</span><br><span class="line">fmt.Println(a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fact</span><span class="params">(n <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> n &lt;= <span class="number">1</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> n * fact(n<span class="number">-1</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果<br><code>120</code></p><h5 id="九、有1、2、3、4四个数字，能组成多少个互不相同且无重复的三位数"><a href="#九、有1、2、3、4四个数字，能组成多少个互不相同且无重复的三位数" class="headerlink" title="九、有1、2、3、4四个数字，能组成多少个互不相同且无重复的三位数"></a>九、有1、2、3、4四个数字，能组成多少个互不相同且无重复的三位数</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">123</span>; i &lt;= <span class="number">432</span>; i++ &#123;</span><br><span class="line">g := i % <span class="number">10</span></span><br><span class="line">s := i % <span class="number">100</span> / <span class="number">10</span></span><br><span class="line">b := i / <span class="number">100</span></span><br><span class="line"><span class="keyword">if</span> g != s &amp;&amp; g != b &amp;&amp; s != b &amp;&amp; g &lt;= <span class="number">4</span> &amp;&amp; s &lt;= <span class="number">4</span> &amp;&amp; b &lt;= <span class="number">4</span> &amp;&amp; g != <span class="number">0</span> &amp;&amp; s != <span class="number">0</span> &amp;&amp; b != <span class="number">0</span> &#123;</span><br><span class="line">fmt.Print(i, <span class="string">"\t"</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：<br><code>123    124    132    134    142    143    213    214    231    234    241    243    312    314    321    324    341    342    412    413    421    423    431    432</code></p><h5 id="十、输入三个整数x-y-z，请把这三个数由小到大输出"><a href="#十、输入三个整数x-y-z，请把这三个数由小到大输出" class="headerlink" title="十、输入三个整数x,y,z，请把这三个数由小到大输出"></a>十、输入三个整数x,y,z，请把这三个数由小到大输出</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> x <span class="keyword">int</span></span><br><span class="line"><span class="keyword">var</span> y <span class="keyword">int</span></span><br><span class="line"><span class="keyword">var</span> z <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line">fmt.Scanln(&amp;x, &amp;y, &amp;z)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> x &gt; y &#123;</span><br><span class="line">x, y = y, x</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> x &gt; z &#123;</span><br><span class="line">x, z = z, x</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> y &gt; z &#123;</span><br><span class="line">y, z = z, y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fmt.Println(x, y, z)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输入：<code>15 20 2</code><br>运行结果：<br><code>2 15 20</code></p><h5 id="十一、求S-a-aa-aaa-aaaa-aa…a的值，其中a是一个数字。例如2-22-222-2222-22222（此时共有5个数相加），几个数相加由键盘控制。"><a href="#十一、求S-a-aa-aaa-aaaa-aa…a的值，其中a是一个数字。例如2-22-222-2222-22222（此时共有5个数相加），几个数相加由键盘控制。" class="headerlink" title="十一、求S=a+aa+aaa+aaaa+aa…a的值，其中a是一个数字。例如2+22+222+2222+22222（此时共有5个数相加），几个数相加由键盘控制。"></a>十一、求S=a+aa+aaa+aaaa+aa…a的值，其中a是一个数字。例如2+22+222+2222+22222（此时共有5个数相加），几个数相加由键盘控制。</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">test(<span class="number">5</span>, <span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(n <span class="keyword">int</span>, m <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">a := <span class="number">0</span></span><br><span class="line">sum := <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">a = (a * <span class="number">10</span>) + m</span><br><span class="line">sum += a</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="string">"sum="</span>, sum)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：<br><code>sum= 24690</code></p><h5 id="十二、古典问题：有一对兔子，从出生后第3个月起每个月都生一对兔子，小兔子长到第三个月后每个月又生一对兔子，假如兔子都不死，问每个月的兔子总数为多少？共12个月"><a href="#十二、古典问题：有一对兔子，从出生后第3个月起每个月都生一对兔子，小兔子长到第三个月后每个月又生一对兔子，假如兔子都不死，问每个月的兔子总数为多少？共12个月" class="headerlink" title="十二、古典问题：有一对兔子，从出生后第3个月起每个月都生一对兔子，小兔子长到第三个月后每个月又生一对兔子，假如兔子都不死，问每个月的兔子总数为多少？共12个月"></a>十二、古典问题：有一对兔子，从出生后第3个月起每个月都生一对兔子，小兔子长到第三个月后每个月又生一对兔子，假如兔子都不死，问每个月的兔子总数为多少？共12个月</h5><p>分析：从第三个月开始每个月的兔子总数为前两个月的兔子数量的和，因为上一个月的兔子到这个月都不生兔子，而上上一个月的兔子到这个月都会再生一对儿兔子，所以这个月新出生的兔子数量与上上个月的兔子总数相同。例如：</p><blockquote><p>6月的兔子总数   <strong>=</strong>   5月的兔子总数 <strong>+</strong>   6月新出生的兔子的数量<br>6月的兔子总数   <strong>=</strong>   5月的兔子总数 <strong>+</strong>   4月的兔子总数</p></blockquote><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">a := <span class="number">1</span></span><br><span class="line">b := <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> c <span class="keyword">int</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">12</span>; i++ &#123;</span><br><span class="line">a = b</span><br><span class="line">b = c</span><br><span class="line">c = a + b</span><br><span class="line">fmt.Print(c,<span class="string">"\t"</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：<br><code>1    1    2    3    5    8    13    21    34    55    89    144</code><br>这里还可以用递归方法做，12个月的兔子数量正好是一个斐波那契数列。</p><h5 id="十三、猴子分桃：海滩上有一堆桃子，五只猴子来分。第一只猴子把这堆桃子平均分为五份，多了一个，这只猴子把多的一个扔入海中，拿走了一份。第二只猴子把剩下的桃子又平均分成五份，又多了一个，它同样把多的一个扔入海中，拿走了一份，第三、第四、第五只猴子都是这样做的，问海滩上原来最少有多少个桃子？"><a href="#十三、猴子分桃：海滩上有一堆桃子，五只猴子来分。第一只猴子把这堆桃子平均分为五份，多了一个，这只猴子把多的一个扔入海中，拿走了一份。第二只猴子把剩下的桃子又平均分成五份，又多了一个，它同样把多的一个扔入海中，拿走了一份，第三、第四、第五只猴子都是这样做的，问海滩上原来最少有多少个桃子？" class="headerlink" title="十三、猴子分桃：海滩上有一堆桃子，五只猴子来分。第一只猴子把这堆桃子平均分为五份，多了一个，这只猴子把多的一个扔入海中，拿走了一份。第二只猴子把剩下的桃子又平均分成五份，又多了一个，它同样把多的一个扔入海中，拿走了一份，第三、第四、第五只猴子都是这样做的，问海滩上原来最少有多少个桃子？"></a>十三、猴子分桃：海滩上有一堆桃子，五只猴子来分。第一只猴子把这堆桃子平均分为五份，多了一个，这只猴子把多的一个扔入海中，拿走了一份。第二只猴子把剩下的桃子又平均分成五份，又多了一个，它同样把多的一个扔入海中，拿走了一份，第三、第四、第五只猴子都是这样做的，问海滩上原来最少有多少个桃子？</h5><p>分析：假如第五只猴子拿走的一份正好是一颗桃子，则最后一堆桃子数是：5+1=6（颗）。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">num := <span class="number">6</span></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">num = num + <span class="number">5</span></span><br><span class="line">count := num</span><br><span class="line">monkey := <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt;= <span class="number">5</span>; i++ &#123;</span><br><span class="line"><span class="keyword">if</span> (count<span class="number">-1</span>)%<span class="number">5</span> == <span class="number">0</span> &#123;</span><br><span class="line">count = (count - <span class="number">1</span>) / <span class="number">5</span> * <span class="number">4</span></span><br><span class="line">monkey++</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="comment">//如果不满足扔一个还能均分5份，就跳出内层循环，再给num加5</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> monkey == <span class="number">5</span> &#123;</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="comment">//如果不满足monkey等于5，就一直循环</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(num)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：<code>3121</code></p><p>这里的很多题都有不止一种解法，就好像同样一种算法，可能每个人写的代码都不完全相同，有的可能逻辑更清晰，有的可能代码量更少，有的可能时间复杂度更低，实际开发中很多问题都需要针对不同的具体情况去优化。</p><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="go语言" scheme="http://yoursite.com/categories/go%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="面试题" scheme="http://yoursite.com/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>Redis开源库redigo的使用</title>
    <link href="http://yoursite.com/2018/01/03/Redis%E5%BC%80%E6%BA%90%E5%BA%93redigo%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <id>http://yoursite.com/2018/01/03/Redis开源库redigo的使用/</id>
    <published>2018-01-03T10:10:00.000Z</published>
    <updated>2018-08-23T09:17:59.491Z</updated>
    
    <content type="html"><![CDATA[<h5 id="整理：房玉辉"><a href="#整理：房玉辉" class="headerlink" title="整理：房玉辉"></a>整理：房玉辉</h5><a id="more"></a><h5 id="博客：https-ElonJelinek-github-io"><a href="#博客：https-ElonJelinek-github-io" class="headerlink" title="博客：https://ElonJelinek.github.io"></a>博客：<a href="https://ElonJelinek.github.io" target="_blank" rel="noopener">https://ElonJelinek.github.io</a></h5><h2 id="打开终端，获取开源库redigo，完成后启动Redis服务"><a href="#打开终端，获取开源库redigo，完成后启动Redis服务" class="headerlink" title="打开终端，获取开源库redigo，完成后启动Redis服务"></a>打开终端，获取开源库redigo，完成后启动Redis服务</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">ElonJelinek:~ ElonJelinek$ <span class="keyword">go</span> get github.com/garyburd/redigo/redis</span><br><span class="line">ElonJelinek:~ ElonJelinek$ redis-server /usr/local/etc/redis.conf</span><br><span class="line"><span class="number">2273</span>:C <span class="number">23</span> Aug <span class="number">15</span>:<span class="number">22</span>:<span class="number">52.471</span> # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span><br><span class="line"><span class="number">2273</span>:C <span class="number">23</span> Aug <span class="number">15</span>:<span class="number">22</span>:<span class="number">52.471</span> # Redis version=<span class="number">4.0</span><span class="number">.11</span>, bits=<span class="number">64</span>, commit=<span class="number">00000000</span>, modified=<span class="number">0</span>, pid=<span class="number">2273</span>, just started</span><br><span class="line"><span class="number">2273</span>:C <span class="number">23</span> Aug <span class="number">15</span>:<span class="number">22</span>:<span class="number">52.471</span> # Configuration loaded</span><br><span class="line"><span class="number">2273</span>:M <span class="number">23</span> Aug <span class="number">15</span>:<span class="number">22</span>:<span class="number">52.473</span> * Increased maximum number of open files to <span class="number">10032</span> (it was originally set to <span class="number">256</span>).</span><br><span class="line">                _._                                                  </span><br><span class="line">           _.-<span class="string">``</span>__ <span class="string">''-._                                             </span></span><br><span class="line"><span class="string">      _.-``    `.  `_.  '</span><span class="string">'-._           Redis 4.0.11 (00000000/0) 64 bit</span></span><br><span class="line"><span class="string">  .-`` .-```.  ```\/    _.,_ '</span><span class="string">'-._                                   </span></span><br><span class="line"><span class="string"> (    '</span>      ,       .-<span class="string">`  | `</span>,    )     Running in standalone mode</span><br><span class="line"> |<span class="string">`-._`</span>-...-<span class="string">` __...-.`</span><span class="string">`-._|'`</span> _.-<span class="string">'|     Port: 6379</span></span><br><span class="line"><span class="string"> |    `-._   `._    /     _.-'</span>    |     PID: <span class="number">2273</span></span><br><span class="line">  <span class="string">`-._    `</span>-._  <span class="string">`-./  _.-'    _.-'                                   </span></span><br><span class="line"><span class="string"> |`</span>-._<span class="string">`-._    `</span>-.__.-<span class="string">'    _.-'</span>_.-<span class="string">'|                                  </span></span><br><span class="line"><span class="string"> |    `-._`-._        _.-'</span>_.-<span class="string">'    |           http://redis.io        </span></span><br><span class="line"><span class="string">  `-._    `-._`-.__.-'</span>_.-<span class="string">'    _.-'</span>                                   </span><br><span class="line"> |<span class="string">`-._`</span>-._    <span class="string">`-.__.-'    _.-'_.-'|                                  </span></span><br><span class="line"><span class="string"> |    `</span>-._<span class="string">`-._        _.-'_.-'    |                                  </span></span><br><span class="line"><span class="string">  `</span>-._    <span class="string">`-._`</span>-.__.-<span class="string">'_.-'</span>    _.-<span class="string">'                                   </span></span><br><span class="line"><span class="string">      `-._    `-.__.-'</span>    _.-<span class="string">'                                       </span></span><br><span class="line"><span class="string">          `-._        _.-'</span>                                           </span><br><span class="line">              <span class="string">`-.__.-'                                               </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2273:M 23 Aug 15:22:52.474 # Server initialized</span></span><br><span class="line"><span class="string">2273:M 23 Aug 15:22:52.474 * DB loaded from disk: 0.000 seconds</span></span><br><span class="line"><span class="string">2273:M 23 Aug 15:22:52.474 * Ready to accept connections</span></span><br></pre></td></tr></table></figure><h3 id="Goland编译器："><a href="#Goland编译器：" class="headerlink" title="Goland编译器："></a>Goland编译器：</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"github.com/garyburd/redigo/redis"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">//连接Redis</span></span><br><span class="line">c, err := redis.Dial(<span class="string">"tcp"</span>, <span class="string">"127.0.0.1:6379"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"Connect to redis error"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> c.Close()</span><br><span class="line"></span><br><span class="line"><span class="comment">//存入数据</span></span><br><span class="line">_, err = c.Do(<span class="string">"SET"</span>, <span class="string">"myname"</span>, <span class="string">"lixunhuan"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"redis set failed:"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//读取数据</span></span><br><span class="line">username, err := redis.String(c.Do(<span class="string">"GET"</span>, <span class="string">"myname"</span>))</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"redis get failed:"</span>, err)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"Get myname: %v \n"</span>, username)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get myname: lixunhuan</span><br></pre></td></tr></table></figure><h3 id="查询值是否存在："><a href="#查询值是否存在：" class="headerlink" title="查询值是否存在："></a>查询值是否存在：</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"github.com/garyburd/redigo/redis"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">c, err := redis.Dial(<span class="string">"tcp"</span>, <span class="string">"127.0.0.1:6379"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"Connect to redis error"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> c.Close()</span><br><span class="line"></span><br><span class="line">is_key_exit, err := redis.Bool(c.Do(<span class="string">"EXISTS"</span>, <span class="string">"myname"</span>))</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"error:"</span>, err)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"exists or not: %v \n"</span>, is_key_exit)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exists or not: <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="删除值："><a href="#删除值：" class="headerlink" title="删除值："></a>删除值：</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"github.com/garyburd/redigo/redis"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">c, err := redis.Dial(<span class="string">"tcp"</span>, <span class="string">"127.0.0.1:6379"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"Connect to redis error"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> c.Close()</span><br><span class="line"></span><br><span class="line">_, err = c.Do(<span class="string">"DEL"</span>, <span class="string">"myname"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"redis delete failed:"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">username, err := redis.String(c.Do(<span class="string">"GET"</span>, <span class="string">"myname"</span>))</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"reids get failed:"</span>, err)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"Get myname: %v \n"</span>, username)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reids get failed: redigo: <span class="literal">nil</span> returned</span><br></pre></td></tr></table></figure><h3 id="json串的存取"><a href="#json串的存取" class="headerlink" title="json串的存取"></a>json串的存取</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"github.com/garyburd/redigo/redis"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"encoding/json"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">c, err := redis.Dial(<span class="string">"tcp"</span>, <span class="string">"127.0.0.1:6379"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"Connect to redis error"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> c.Close()</span><br><span class="line"></span><br><span class="line">key := <span class="string">"varurr"</span></span><br><span class="line">map1 := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;<span class="string">"name"</span>: <span class="string">"berry"</span>, <span class="string">"age"</span>: <span class="string">"22"</span>&#125;</span><br><span class="line">value, _ := json.Marshal(map1)</span><br><span class="line"></span><br><span class="line">n, err := c.Do(<span class="string">"SETNX"</span>, key, value)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> n == <span class="keyword">int64</span>(<span class="number">1</span>) &#123;</span><br><span class="line">fmt.Println(<span class="string">"success"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> map2 <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span></span><br><span class="line"></span><br><span class="line">getVlue, err := redis.Bytes(c.Do(<span class="string">"GET"</span>, key))</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">err = json.Unmarshal(getVlue, &amp;map2)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(map2[<span class="string">"name"</span>])</span><br><span class="line">fmt.Println(map2[<span class="string">"age"</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">success</span><br><span class="line">berry</span><br><span class="line"><span class="number">22</span></span><br></pre></td></tr></table></figure><font color="#FF0000" size="5">版权声明：博客中的文章版权归博主所有，未经授权，禁止转载，转载请注明出处，合作请点击“关于我”，扫码添加微信</font>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;整理：房玉辉&quot;&gt;&lt;a href=&quot;#整理：房玉辉&quot; class=&quot;headerlink&quot; title=&quot;整理：房玉辉&quot;&gt;&lt;/a&gt;整理：房玉辉&lt;/h5&gt;
    
    </summary>
    
      <category term="数据库" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="Redis数据库" scheme="http://yoursite.com/tags/Redis%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
</feed>
